/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t={67279:(e,t,i)=>{i.r(t)},69221:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const s=i(58687),r=i(76385),o=i(76566),n=i(36645),a=i(53555),h=i(54539),d=i(9498),l=i(22273),c=i(33244),u=i(84631),m=i(42097),p=i(79420),g=i(63452),w=i(35191),f=i(95978),b=i(44782),y=i(75171),x=i(9127),T=i(9678),v=i(97037),C=i(54536),S=i(46667),M=i(41759),k=i(30332),A=i(60231),E=i(65400),I=i(42930),Y=i(16445),P=i(22591);class B extends s.Graphics{}class G extends s.Container{constructor(e){super(),this.gameEnded=!1,this.time=0,this.cash={[a.Team.blue]:0,[a.Team.green]:0},this.speedAdjustmentFactor=1/512,this.turnSpeedAdjustmentFactor=1/64,this.speedAdjustmentWhileTurningFactor=.4,this.reloadAdjustmentFactor=1/8,this.selectedItems=[],this.dragSelectThreshold=5,this.dragSelect=new B,this.pointerMainDownId=-1,this.pointerMainDownX=-1,this.pointerMainDownY=-1,this.pointerSecondDownId=-1,this.pointerSecondDownX=-1,this.pointerSecondDownY=-1,this.pointerZoomed=!1,this.handlePointerTap=e=>{if((0,n.logPointerEvent)("Game pointertap"),this.gameEnded)return;const t=this.tileMap.toLocal(e),i=this.tileMap.itemUnderPointer(t);if(this.handlePointerDoubleTap({e,underPointerItem:i}))return;const s=this.sideBar.commandsBar.getSelectedCommandName();null!=i?this.handleItemPointerTap({selectedCommandName:s,underPointerItem:i}):this.handleTerrainPointerTap({selectedCommandName:s,point:t}),this.sideBar.handleSelectedItems(this.selectedItems),this.previousPointerTapEvent={type:e.type,pointerId:e.pointerId,pointerType:e.pointerType,timeStamp:e.timeStamp,globalX:e.globalX,globalY:e.globalY}},this.handlePointerDown=e=>{if(this.gameEnded)return;this.pointerZoomed=!1;const t=this.toLocal(e);this.pointerMainDownId>-1?(this.pointerSecondDownId=e.pointerId,this.pointerSecondDownX=t.x,this.pointerSecondDownY=t.y):(this.pointerMainDownId=e.pointerId,this.pointerMainDownX=t.x,this.pointerMainDownY=t.y),(0,n.logPointerEvent)(`Game pdX=${t.x} pdX=${t.y} down`)},this.handlePointerUp=e=>{if(!this.gameEnded){if(this.pointerSecondDownId=this.pointerSecondDownX=this.pointerSecondDownY=-1,this.pointerMainDownId=this.pointerMainDownX=this.pointerSecondDownY=-1,(0,n.logPointerEvent)("Game pointer up"),this.dragSelect.width>0){this.clearSelection();const e=this.dragSelect.getBounds(),t=this.tileMap.toLocal({x:e.left,y:e.top}),i=this.tileMap.toLocal({x:e.right,y:e.bottom}),s=t.x,r=i.x,o=t.y,n=i.y,{moveableItems:a}=this.tileMap;a.forEach((e=>{if(!e.selectable||e.isDead())return;const t=e.getCollisionPosition({center:!0});t.x>=s&&t.x<=r&&t.y>=o&&t.y<=n&&this.selectItem(e)})),this.sideBar.handleSelectedItems(this.selectedItems)}else this.pointerZoomed||this.handlePointerTap(e);this.dragSelect.clear()}},this.handlePointerLeave=e=>{this.gameEnded||(e.pointerId===this.pointerSecondDownId?(this.pointerSecondDownId=this.pointerSecondDownX=this.pointerSecondDownY=-1,(0,n.logPointerEvent)("Game pointer second leave")):(this.pointerMainDownId=this.pointerMainDownX=this.pointerSecondDownY=-1,(0,n.logPointerEvent)("Game pointer main leave")),this.dragSelect.clear())},this.handlePointerMove=e=>{if(this.gameEnded)return;const t=this.toLocal(e);if((0,n.logPointerEvent)("Game pointer move"),-1!==this.pointerMainDownId&&-1===this.pointerSecondDownId)this.pointerMainDownX>-1&&this.pointerMainDownY>-1&&Math.abs(t.x-this.pointerMainDownX)>this.dragSelectThreshold&&Math.abs(t.y-this.pointerMainDownY)>this.dragSelectThreshold&&this.drawDragSelect(t);else if(-1!==this.pointerMainDownId&&-1!==this.pointerSecondDownId){this.dragSelect.width>0&&this.dragSelect.clear();const i=e.pointerId===this.pointerMainDownId,s=i?this.pointerSecondDownX:this.pointerMainDownX,r=i?this.pointerSecondDownY:this.pointerMainDownY,o=i?this.pointerMainDownX:this.pointerSecondDownX,n=i?this.pointerMainDownY:this.pointerSecondDownY,a=t.x,h=t.y,d=Math.hypot(r-n,s-o),l=Math.hypot(r-h,s-a)/d*G.options.pinchScaleFactor,c=Math.min(s,a)+.5*(s-a),u=Math.min(r,h)+.5*(r-h),m=this.toGlobal({x:c,y:u}),p=this.tileMap.toLocal(m);this.tileMap.zoom({scaleFactor:l<1?1/l*-1:l,sX:p.x,sY:p.y}),this.handleResize({viewWidth:T.SceneManager.width,viewHeight:T.SceneManager.height}),i?(this.pointerMainDownX=t.x,this.pointerMainDownY=t.y):(this.pointerSecondDownX=t.x,this.pointerSecondDownY=t.y),this.pointerZoomed=!0}},this.handleWheel=e=>{if(this.gameEnded)return;const t=this.tileMap.toLocal(e),i=-1*Math.sign(e.deltaY)*G.options.wheelScaleFactor;this.tileMap.zoom({scaleFactor:i,sX:t.x,sY:t.y}),this.handleResize({viewWidth:T.SceneManager.width,viewHeight:T.SceneManager.height})},this.startGame=({mapImageSrc:e,mapSettingsSrc:t,startGridX:i=0,startGridY:r=0})=>{this.ai=void 0,this.gameEnded=!1,this.time=0,this.clearSelection(!0),this.dragSelect.clear(),this.runLevel({mapImageSrc:e,mapSettingsSrc:t});const{gridSize:o}=this.tileMap;this.topBar.miniMap.assignBackgroundTexture({texture:s.Assets.get(e)}),this.handleResize({viewWidth:T.SceneManager.width,viewHeight:T.SceneManager.height}),this.tileMap.goTo({x:i*o,y:r*o})},this.viewWidth=e.viewWidth,this.viewHeight=e.viewHeight,this.type=e.type,this.team=e.team,this.audio=e.audio,this.setup(e),this.prepareTextures(),this.addEventLesteners()}setup({viewWidth:e,viewHeight:t}){const i=t-v.TopBar.options.initHeight;this.camera=new o.Camera({game:this,viewWidth:e,viewHeight:i,initY:v.TopBar.options.initHeight}),this.addChild(this.camera),this.tileMap=new r.TileMap({game:this,initY:v.TopBar.options.initHeight}),this.addChild(this.tileMap),this.tileMap.mask=this.camera,this.addChild(this.dragSelect),this.topBar=new v.TopBar({game:this}),this.addChild(this.topBar),this.sideBar=new E.SideBar({game:this,viewWidth:e,initY:v.TopBar.options.initHeight}),this.addChild(this.sideBar),this.startModal=new y.StartModal({viewWidth:e,viewHeight:t}),this.startModal.hideModal(),this.addChild(this.startModal)}addEventLesteners(){this.tileMap.eventMode="static",this.tileMap.on("pointerdown",this.handlePointerDown),this.tileMap.on("pointerup",this.handlePointerUp),this.tileMap.on("pointermove",this.handlePointerMove),this.tileMap.on("pointerleave",this.handlePointerLeave),this.tileMap.on("wheel",this.handleWheel)}handlePointerDoubleTap({e,underPointerItem:t}){const{previousPointerTapEvent:i}=this;if((0,n.logDoubleTapEvent)(`ppte ${null==i?void 0:i.pointerId}<>${e.pointerId} ${null==i?void 0:i.pointerType}<>${e.pointerType}`),null!=i&&null!=t){const s="mouse"===i.pointerType&&"mouse"===e.pointerType&&i.pointerId===e.pointerId,r="touch"===i.pointerType&&"touch"===e.pointerType&&(i.pointerId===e.pointerId||i.pointerId+1===e.pointerId),o=e.timeStamp-i.timeStamp,{doubleTapMaxTime:a,doubleTapThreasholdX:h,doubleTapThreasholdY:d}=G.options;if((0,n.logDoubleTapEvent)(`isPreviousMouse=${s} isPreviousTouch=${r} timeDiff=${o} doubleTapMaxTime=${a}`),(s||r)&&o<a){const s=Math.abs(e.globalX-i.globalX),r=Math.abs(e.globalY-i.globalY),o=s<h&&r<d;if((0,n.logDoubleTapEvent)(`absDiffX=${s} absDiffY=${r} isInThreshold=${o}`),o){this.clearSelection();const{activeItems:e}=this.tileMap,i=this.camera.getCameraBounds();for(let s=0;s<e.children.length;s++){const r=e.children[s],o=r.getCollisionBounds(),n=o.right<i.left||o.left>i.right||o.bottom<i.top||o.top>i.bottom;t.itemName!==r.itemName||r.team!==t.team||n||this.selectItem(r)}return this.sideBar.handleSelectedItems(this.selectedItems),!0}}}return!1}handleItemPointerTap({selectedCommandName:e,underPointerItem:t}){const i=[];let s;switch(e){case Y.ECommandName.moveFollow:s={type:"follow",to:t};break;case Y.ECommandName.attack:s={type:"attack",to:t};break;case Y.ECommandName.attackGuard:s=t.team===this.team?{type:"guard",to:t}:{type:"attack",to:t}}const r=this.selectedItems.filter((e=>e.team===this.team&&e!==t)).length;if(t.team===this.team)if(null!=e&&r>0&&null!=s){for(let s=this.selectedItems.length-1;s>=0;s--){const r=this.selectedItems[s];r.team===this.team&&t!==r&&r.commands.includes(e)&&i.push(r.uid)}i.length>0&&this.processOrder({uids:i,order:s})}else this.clearSelection(),this.selectItem(t);else if(r>0){null==e&&(e=Y.ECommandName.attackGuard,s={type:"attack",to:t});for(let s=this.selectedItems.length-1;s>=0;s--){const r=this.selectedItems[s];r.team===this.team&&t!==r&&r.commands.includes(e)&&i.push(r.uid)}i.length>0&&this.processOrder({uids:i,order:s})}else this.clearSelection(),this.selectItem(t)}handleTerrainPointerTap({selectedCommandName:e,point:t}){const i=[];let s;null==e&&(e=Y.ECommandName.moveFollow);const{gridSize:r,initialMapDeployableGrid:o}=this.tileMap,n=t.x/r,a=t.y/r;switch(e){case Y.ECommandName.moveFollow:s={type:"move",toPoint:{gridX:n,gridY:a}};break;case Y.ECommandName.attackGuard:s={type:"move-and-attack",toPoint:{gridX:n,gridY:a}};break;case Y.ECommandName.buildTurret:s={type:"build",name:m.EItemName.GroundTurret,toPoint:{gridX:n,gridY:a}},this.sideBar.commandsBar.deselectTiles();break;case Y.ECommandName.buildStarport:s={type:"build",name:m.EItemName.Starport,toPoint:{gridX:n,gridY:a}},this.sideBar.commandsBar.deselectTiles();break;case Y.ECommandName.deploy:s={type:"deploy",toPoint:{gridX:0===o[Math.floor(a)][Math.floor(n)-1]?Math.floor(n)-1+.5:n,gridY:a}},this.sideBar.commandsBar.deselectTiles()}for(let t=this.selectedItems.length-1;t>=0;t--){const s=this.selectedItems[t];if(s.team===this.team&&(s.type===m.EItemType.vehicles||s.type===m.EItemType.airVehicles)&&s.commands.includes(e))if(e===Y.ECommandName.patrol){const e=s.getGridXY({center:!0});this.processOrder({uids:[s.uid],order:{type:"patrol",fromPoint:e,toPoint:{gridX:n,gridY:a}}})}else i.push(s.uid)}i.length>0&&this.processOrder({uids:i,order:s})}drawDragSelect(e){this.dragSelect.clear();const t=Math.abs(e.x-this.pointerMainDownX),i=Math.abs(e.y-this.pointerMainDownY);if(t>0&&i>0){this.dragSelect.lineStyle({width:1,color:16776960});const s=Math.min(e.x,this.pointerMainDownX),r=Math.min(e.y,this.pointerMainDownY);this.dragSelect.position.set(s,r),this.dragSelect.drawRect(0,0,t,i),this.dragSelect.endFill()}}isItemSelected(e){return this.selectedItems.includes(e)}selectItem(e){e.selected||e.selectable&&!e.selected&&(e.setSelected(!0),this.selectedItems.push(e))}deselectItem(e){const t=this.selectedItems.indexOf(e);if(t>-1){const e=this.selectedItems.splice(t,1)[0],i=this.tileMap.orders.children.find((t=>t.item===e));null!=i&&i.removeFromParent()}e.setSelected(!1)}endGame(e){this.gameEnded=!0,this.startModal.showModal(e)}handleResize({viewWidth:e,viewHeight:t}){const{width:i,height:s}=this.tileMap.background,r=e>i?i:e,o=t-this.topBar.height;this.camera.handleResize({viewWidth:e,viewHeight:o}),this.tileMap.handleResize({viewWidth:r,viewHeight:o}),this.topBar.handleResize({viewWidth:r,viewHeight:o}),this.sideBar.handleResize({viewWidth:r,initY:this.topBar.height});const a=e,h=t,d=i,l=this.topBar.height+s,c=a>d?(a-d)/2:0,u=h>l?(h-l)/2:0;(0,n.logLayout)(`aw=${a} (ow=${d}) x=${c} ah=${h} (oh=${l}) y=${u}`),this.x=c,this.y=u,(0,n.logLayout)(`x=${c} y=${u}`);const m=a>d?d:a,p=h>l?l:h;this.startModal.position.set(m/2-this.startModal.width/2,p/2-this.startModal.height/2)}handleUpdate(e){this.gameEnded?this.startModal.visible&&this.startModal.handleUpdate(e):(this.time+=e,this.topBar.handleUpdate(e),this.sideBar.handleUpdate(e),this.tileMap.handleUpdate(e),this.camera.handleUpdate(e),this.drawOrders(),null!=this.ai&&this.ai.handleUpdate(e))}drawOrders(){this.selectedItems.forEach((e=>{let t=this.tileMap.orders.children.find((t=>t.item===e));null==t&&(t=new b.Order({item:e}),this.tileMap.orders.addChild(t)),t.drawOrder({selectedItem:e,tileMap:this.tileMap})}))}runLevel({mapImageSrc:e,mapSettingsSrc:t}){this.tileMap.cleanFromAll(),this.topBar.statusBar.cleanFromAll(),this.startModal.cleanFromAll(),this.tileMap.initLevel({mapImageSrc:e,mapSettingsSrc:t,viewWidth:this.camera.width,viewHeight:this.camera.height})}clearSelection(e=!1){e&&this.sideBar.handleSelectedItems([]);for(let e=0;e<this.selectedItems.length;e++){const t=this.selectedItems[e];this.deselectItem(t),e--}}prepareTextures(){const e=s.Assets.get("spritesheet"),{animations:t,textures:i}=e;h.Base.prepareTextures({blueTextures:{healthyTextures:t["base-blue-healthy"],damagedTextures:[i["base-blue-damaged.png"]],constructingTextures:t["base-blue-contructing"]},greenTextures:{healthyTextures:t["base-green-healthy"],damagedTextures:[i["base-green-damaged.png"]],constructingTextures:t["base-green-contructing"]}}),C.GroundTurret.prepareTextures({blueTextures:{healthyTextures:[i["ground-turret-blue-healthy-up.png"]],upTextures:[i["ground-turret-blue-healthy-up.png"]],upRightTextures:[i["ground-turret-blue-healthy-up-right.png"]],rightTextures:[i["ground-turret-blue-healthy-right.png"]],downRightTextures:[i["ground-turret-blue-healthy-down-right.png"]],downTextures:[i["ground-turret-blue-healthy-down.png"]],downLeftTextures:[i["ground-turret-blue-healthy-down-left.png"]],leftTextures:[i["ground-turret-blue-healthy-left.png"]],upLeftTextures:[i["ground-turret-blue-healthy-up-left.png"]],damagedTextures:[i["ground-turret-blue-damaged.png"]],teleportTextures:t["ground-turret-blue-teleport"]},greenTextures:{healthyTextures:[i["ground-turret-green-healthy-up.png"]],upTextures:[i["ground-turret-green-healthy-up.png"]],upRightTextures:[i["ground-turret-green-healthy-up-right.png"]],rightTextures:[i["ground-turret-green-healthy-right.png"]],downRightTextures:[i["ground-turret-green-healthy-down-right.png"]],downTextures:[i["ground-turret-green-healthy-down.png"]],downLeftTextures:[i["ground-turret-green-healthy-down-left.png"]],leftTextures:[i["ground-turret-green-healthy-left.png"]],upLeftTextures:[i["ground-turret-green-healthy-up-left.png"]],damagedTextures:[i["ground-turret-green-damaged.png"]],teleportTextures:t["ground-turret-green-teleport"]}}),S.OilDerrick.prepareTextures({blueTextures:{healthyTextures:t["oil-derrick-blue-healthy"],damagedTextures:[i["oil-derrick-blue-damaged.png"]],deployTextures:t["oil-derrick-blue-deploy"]},greenTextures:{healthyTextures:t["oil-derrick-green-healthy"],damagedTextures:[i["oil-derrick-green-damaged.png"]],deployTextures:t["oil-derrick-green-deploy"]}}),M.Starport.prepareTextures({blueTextures:{healthyTextures:t["starport-blue-healthy"],damagedTextures:[i["starport-blue-damaged.png"]],teleportTextures:t["starport-blue-teleport"],closingTextures:t["starport-blue-closing"],openingTextures:t["starport-blue-opening"]},greenTextures:{healthyTextures:t["starport-green-healthy"],damagedTextures:[i["starport-green-damaged.png"]],teleportTextures:t["starport-green-teleport"],closingTextures:t["starport-green-closing"],openingTextures:t["starport-green-opening"]}}),d.Harvester.prepareTextures({blueTextures:{upTextures:[i["harvester-blue-up.png"]],upRightTextures:[i["harvester-blue-up-right.png"]],rightTextures:[i["harvester-blue-right.png"]],downRightTextures:[i["harvester-blue-down-right.png"]],downTextures:[i["harvester-blue-down.png"]],downLeftTextures:[i["harvester-blue-down-left.png"]],leftTextures:[i["harvester-blue-left.png"]],upLeftTextures:[i["harvester-blue-up-left.png"]]},greenTextures:{upTextures:[i["harvester-green-up.png"]],upRightTextures:[i["harvester-green-up-right.png"]],rightTextures:[i["harvester-green-right.png"]],downRightTextures:[i["harvester-green-down-right.png"]],downTextures:[i["harvester-green-down.png"]],downLeftTextures:[i["harvester-green-down-left.png"]],leftTextures:[i["harvester-green-left.png"]],upLeftTextures:[i["harvester-green-up-left.png"]]}}),l.HeavyTank.prepareTextures({blueTextures:{upTextures:[i["heavy-tank-blue-up.png"]],upRightTextures:[i["heavy-tank-blue-up-right.png"]],rightTextures:[i["heavy-tank-blue-right.png"]],downRightTextures:[i["heavy-tank-blue-down-right.png"]],downTextures:[i["heavy-tank-blue-down.png"]],downLeftTextures:[i["heavy-tank-blue-down-left.png"]],leftTextures:[i["heavy-tank-blue-left.png"]],upLeftTextures:[i["heavy-tank-blue-up-left.png"]]},greenTextures:{upTextures:[i["heavy-tank-green-up.png"]],upRightTextures:[i["heavy-tank-green-up-right.png"]],rightTextures:[i["heavy-tank-green-right.png"]],downRightTextures:[i["heavy-tank-green-down-right.png"]],downTextures:[i["heavy-tank-green-down.png"]],downLeftTextures:[i["heavy-tank-green-down-left.png"]],leftTextures:[i["heavy-tank-green-left.png"]],upLeftTextures:[i["heavy-tank-green-up-left.png"]]}}),c.ScoutTank.prepareTextures({blueTextures:{upTextures:[i["scout-tank-blue-up.png"]],upRightTextures:[i["scout-tank-blue-up-right.png"]],rightTextures:[i["scout-tank-blue-right.png"]],downRightTextures:[i["scout-tank-blue-down-right.png"]],downTextures:[i["scout-tank-blue-down.png"]],downLeftTextures:[i["scout-tank-blue-down-left.png"]],leftTextures:[i["scout-tank-blue-left.png"]],upLeftTextures:[i["scout-tank-blue-up-left.png"]]},greenTextures:{upTextures:[i["scout-tank-green-up.png"]],upRightTextures:[i["scout-tank-green-up-right.png"]],rightTextures:[i["scout-tank-green-right.png"]],downRightTextures:[i["scout-tank-green-down-right.png"]],downTextures:[i["scout-tank-green-down.png"]],downLeftTextures:[i["scout-tank-green-down-left.png"]],leftTextures:[i["scout-tank-green-left.png"]],upLeftTextures:[i["scout-tank-green-up-left.png"]]}}),u.Transport.prepareTextures({blueTextures:{upTextures:[i["transport-blue-up.png"]],upRightTextures:[i["transport-blue-up-right.png"]],rightTextures:[i["transport-blue-right.png"]],downRightTextures:[i["transport-blue-down-right.png"]],downTextures:[i["transport-blue-down.png"]],downLeftTextures:[i["transport-blue-down-left.png"]],leftTextures:[i["transport-blue-left.png"]],upLeftTextures:[i["transport-blue-up-left.png"]]},greenTextures:{upTextures:[i["transport-green-up.png"]],upRightTextures:[i["transport-green-up-right.png"]],rightTextures:[i["transport-green-right.png"]],downRightTextures:[i["transport-green-down-right.png"]],downTextures:[i["transport-green-down.png"]],downLeftTextures:[i["transport-green-down-left.png"]],leftTextures:[i["transport-green-left.png"]],upLeftTextures:[i["transport-green-up-left.png"]]}}),P.SCV.prepareTextures({blueTextures:{upTextures:[i["scv-blue-up.png"]],upRightTextures:[i["scv-blue-up-right.png"]],rightTextures:[i["scv-blue-right.png"]],downRightTextures:[i["scv-blue-down-right.png"]],downTextures:[i["scv-blue-down.png"]],downLeftTextures:[i["scv-blue-down-left.png"]],leftTextures:[i["scv-blue-left.png"]],upLeftTextures:[i["scv-blue-up-left.png"]]},greenTextures:{upTextures:[i["scv-green-up.png"]],upRightTextures:[i["scv-green-up-right.png"]],rightTextures:[i["scv-green-right.png"]],downRightTextures:[i["scv-green-down-right.png"]],downTextures:[i["scv-green-down.png"]],downLeftTextures:[i["scv-green-down-left.png"]],leftTextures:[i["scv-green-left.png"]],upLeftTextures:[i["scv-green-up-left.png"]]}}),p.Bullet.prepareTextures({textures:{upTextures:[i["bullet-up.png"]],upRightTextures:[i["bullet-up-right.png"]],rightTextures:[i["bullet-right.png"]],downRightTextures:[i["bullet-down-right.png"]],downTextures:[i["bullet-down.png"]],downLeftTextures:[i["bullet-down-left.png"]],leftTextures:[i["bullet-left.png"]],upLeftTextures:[i["bullet-up-left.png"]],explodeTextures:t["bullet-explode"]}}),g.CannonBall.prepareTextures({textures:{upTextures:[i["cannon-ball-up.png"]],upRightTextures:[i["cannon-ball-up-right.png"]],rightTextures:[i["cannon-ball-right.png"]],downRightTextures:[i["cannon-ball-down-right.png"]],downTextures:[i["cannon-ball-down.png"]],downLeftTextures:[i["cannon-ball-down-left.png"]],leftTextures:[i["cannon-ball-left.png"]],upLeftTextures:[i["cannon-ball-up-left.png"]],explodeTextures:t["cannon-ball-explode"]}}),w.Laser.prepareTextures({textures:{upTextures:[i["fireball-up.png"]],upRightTextures:[i["fireball-up-right.png"]],rightTextures:[i["fireball-right.png"]],downRightTextures:[i["fireball-down-right.png"]],downTextures:[i["fireball-down.png"]],downLeftTextures:[i["fireball-down-left.png"]],leftTextures:[i["fireball-left.png"]],upLeftTextures:[i["fireball-up-left.png"]],explodeTextures:t["fireball-explode"]}}),f.Rocket.prepareTextures({textures:{upTextures:[i["heatseeker-up.png"]],upRightTextures:[i["heatseeker-up-right.png"]],rightTextures:[i["heatseeker-right.png"]],downRightTextures:[i["heatseeker-down-right.png"]],downTextures:[i["heatseeker-down.png"]],downLeftTextures:[i["heatseeker-down-left.png"]],leftTextures:[i["heatseeker-left.png"]],upLeftTextures:[i["heatseeker-up-left.png"]],explodeTextures:t["heatseeker-explode"]}}),y.StartModal.prepareTextures({textures:{iconHomeTexture:i["icon-home.png"],iconRepeatTexture:i["icon-repeat.png"],iconNextTexture:i["icon-next.png"]}}),x.Firework.prepareTextures({textures:{texture:T.SceneManager.app.renderer.generateTexture(x.Firework.prepareGraphics())}}),k.Chopper.prepareTextures({blueTextures:{upTextures:t["chopper-blue-up"],upRightTextures:t["chopper-blue-up-right"],rightTextures:t["chopper-blue-right"],downRightTextures:t["chopper-blue-down-right"],downTextures:t["chopper-blue-down"],downLeftTextures:t["chopper-blue-down-left"],leftTextures:t["chopper-blue-left"],upLeftTextures:t["chopper-blue-up-left"]},greenTextures:{upTextures:t["chopper-green-up"],upRightTextures:t["chopper-green-up-right"],rightTextures:t["chopper-green-right"],downRightTextures:t["chopper-green-down-right"],downTextures:t["chopper-green-down"],downLeftTextures:t["chopper-green-down-left"],leftTextures:t["chopper-green-left"],upLeftTextures:t["chopper-green-up-left"]},shadowTextures:{upTextures:t["chopper-shadow-up"],upRightTextures:t["chopper-shadow-up-right"],rightTextures:t["chopper-shadow-right"],downRightTextures:t["chopper-shadow-down-right"],downTextures:t["chopper-shadow-down"],downLeftTextures:t["chopper-shadow-down-left"],leftTextures:t["chopper-shadow-left"],upLeftTextures:t["chopper-shadow-up-left"]}}),A.Wraith.prepareTextures({blueTextures:{upTextures:[i["wraith-blue-up.png"]],upRightTextures:[i["wraith-blue-up-right.png"]],rightTextures:[i["wraith-blue-right.png"]],downRightTextures:[i["wraith-blue-down-right.png"]],downTextures:[i["wraith-blue-down.png"]],downLeftTextures:[i["wraith-blue-down-left.png"]],leftTextures:[i["wraith-blue-left.png"]],upLeftTextures:[i["wraith-blue-up-left.png"]]},greenTextures:{upTextures:[i["wraith-green-up.png"]],upRightTextures:[i["wraith-green-up-right.png"]],rightTextures:[i["wraith-green-right.png"]],downRightTextures:[i["wraith-green-down-right.png"]],downTextures:[i["wraith-green-down.png"]],downLeftTextures:[i["wraith-green-down-left.png"]],leftTextures:[i["wraith-green-left.png"]],upLeftTextures:[i["wraith-green-up-left.png"]]},shadowTextures:{upTextures:[i["wraith-shadow-up.png"]],upRightTextures:[i["wraith-shadow-up-right.png"]],rightTextures:[i["wraith-shadow-right.png"]],downRightTextures:[i["wraith-shadow-down-right.png"]],downTextures:[i["wraith-shadow-down.png"]],downLeftTextures:[i["wraith-shadow-down-left.png"]],leftTextures:[i["wraith-shadow-left.png"]],upLeftTextures:[i["wraith-shadow-up-left.png"]]}}),I.CommandsBar.prepareTextures({textures:{iconAttackTexture:i["icon-command-attack.png"],iconMoveFollowTexture:i["icon-command-move-follow.png"],iconAttackGuardTexture:i["icon-command-attack-guard.png"],iconPatrolTexture:i["icon-command-patrol.png"],iconDeselectTexture:i["icon-deselect.png"],iconBuildTurretTexture:i["ground-turret-blue-healthy-down-right.png"],iconBuildStarportTexture:i["starport-blue-healthy-0.png"],iconDeployTexture:i["oil-derrick-blue-healthy-0.png"],iconConstructSCVTexture:i["scv-blue-down-right.png"],iconConstructHarvesterTexture:i["harvester-blue-down-right.png"],iconConstructScoutTankTexture:i["scout-tank-blue-down-right.png"],iconConstructHeavyTankTexture:i["heavy-tank-blue-down-right.png"],iconConstructChopperTexture:i["chopper-blue-down-right-0.png"],iconConstructWraithTexture:i["wraith-blue-down-right.png"]}})}processOrder({uids:e,items:t,order:i,toUid:s,orderType:r}){let o,n;if(("attack"===r||"guard"===r||"follow"===r)&&"number"==typeof s){if(o=this.tileMap.getItemByUid(s),null==o||o.isDead())return!1;n={type:r,to:o}}t=(Array.isArray(e)?e:[]).map((e=>this.tileMap.getItemByUid(e))).filter((e=>Boolean(e))).concat(Array.isArray(t)?t:[]).filter((e=>Boolean(e)));for(const e of t)null==i&&null==n||(e.order=null!=i?i:n,e.team===this.team&&(["move","follow","guard","patrol"].includes(e.order.type)?this.audio.playYes(e.itemName):["attack","move-and-attack"].includes(e.order.type)?this.audio.playAttack(e.itemName):("build"===e.order.type||"deploy"===e.order.type)&&this.audio.playYes(e.itemName)),null==o||"attack"!==e.order.type&&"guard"!==e.order.type||(e.order.to=o));return!0}showMessage({character:e,message:t,playSound:i=!0,selfRemove:s=!1}){i&&(s?this.audio.playError():this.audio.playMessage()),this.topBar.statusBar.appendMessage({character:e,message:t,time:this.time,selfRemove:s,height:v.TopBar.options.initHeight})}getItemCost(e){switch(e){case m.EItemName.Starport:return M.Starport.cost;case m.EItemName.GroundTurret:return C.GroundTurret.cost;case m.EItemName.SCV:return P.SCV.cost;case m.EItemName.Transport:return u.Transport.cost;case m.EItemName.Harvester:return d.Harvester.cost;case m.EItemName.HeavyTank:return l.HeavyTank.cost;case m.EItemName.ScoutTank:return c.ScoutTank.cost;case m.EItemName.Chopper:return k.Chopper.cost;case m.EItemName.Wraith:return A.Wraith.cost}}getReloadTime(e){switch(e){case m.EItemName.Bullet:return p.Bullet.reloadTime;case m.EItemName.CannonBall:return g.CannonBall.reloadTime;case m.EItemName.Rocket:return f.Rocket.reloadTime;case m.EItemName.Laser:return w.Laser.reloadTime}}getBuildableGrid(e){switch(e){case m.EItemName.GroundTurret:return C.GroundTurret.buildableGrid;case m.EItemName.Starport:return M.Starport.buildableGrid}}createItem(e){let{initX:t=0,initY:i=0}=e;const{name:s,initGridX:r,initGridY:o}=e,{gridSize:n}=this.tileMap;switch(t=null!=r?n*r:t,i=null!=o?n*o:i,s){case m.EItemName.Base:return new h.Base({...e,game:this,initX:t,initY:i});case m.EItemName.OilDerrick:return new S.OilDerrick({...e,game:this,initX:t,initY:i});case m.EItemName.Starport:return new M.Starport({...e,game:this,initX:t,initY:i});case m.EItemName.GroundTurret:return new C.GroundTurret({...e,game:this,initX:t,initY:i});case m.EItemName.SCV:return new P.SCV({...e,game:this,initX:t,initY:i});case m.EItemName.Transport:return new u.Transport({...e,game:this,initX:t,initY:i});case m.EItemName.Harvester:return new d.Harvester({...e,game:this,initX:t,initY:i});case m.EItemName.HeavyTank:return new l.HeavyTank({...e,game:this,initX:t,initY:i});case m.EItemName.ScoutTank:return new c.ScoutTank({...e,game:this,initX:t,initY:i});case m.EItemName.Chopper:return new k.Chopper({...e,game:this,initX:t,initY:i});case m.EItemName.Wraith:return new A.Wraith({...e,game:this,initX:t,initY:i})}}createProjectile(e){let{initX:t=0,initY:i=0}=e;const{name:s,initGridX:r,initGridY:o}=e,{gridSize:n}=this.tileMap;switch(t=null!=r?n*r:t,i=null!=o?n*o:i,s){case m.EItemName.Bullet:return new p.Bullet({...e,game:this,initX:t,initY:i});case m.EItemName.CannonBall:return new g.CannonBall({...e,game:this,initX:t,initY:i});case m.EItemName.Rocket:return new f.Rocket({...e,game:this,initX:t,initY:i});case m.EItemName.Laser:return new w.Laser({...e,game:this,initX:t,initY:i})}}}G.options={doubleTapMaxTime:300,doubleTapThreasholdX:10,doubleTapThreasholdY:10,wheelScaleFactor:1.5,pinchScaleFactor:1},t.Game=G},93947:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AirVehicle=void 0;const s=i(58687),r=i(7091),o=i(53555),n=i(42097),a=i(94973),h=i(16445),d=i(17837);var l;!function(e){e.soft="soft",e.hard="hard",e.attraction="attraction"}(l||(l={}));class c extends d.TeleportableSelectableLifeableRoundItem{constructor(e){var t;super(e),this.commands=[h.ECommandName.moveFollow,h.ECommandName.patrol],this.type=n.EItemType.airVehicles,this.drawShadowOptions={offset:{x:0,y:0}},this.bodySpritesContainer=new s.Container,this.shadowSpritesContainer=new s.Container,this.vector=new r.Vector({direction:r.EVectorDirection.down}),this.speed=0,this.moveTurning=!1,this.turnSpeed=0,this.turnFactor=0,this.hardCollision=!1,this.collisionCount=0,this.colliding=!1,this.followRadius=4,this.elapsedSwitchFrames=0,this.switchFrames=30,this.order=null!==(t=e.order)&&void 0!==t?t:{type:"stand"},null!=e.direction&&this.vector.setDirection({direction:e.direction}),this.setup(e)}setup(e){this.addChild(this.selectedGraphics),this.addChild(this.bodySpritesContainer),this.addChild(this.shadowSpritesContainer),this.addChild(this.collisionGraphics);const{textures:{body:t,shadow:i},teleport:r}=e;!0===r&&(this.teleportGraphics=new s.Graphics,this.addChild(this.teleportGraphics));const o=new s.AnimatedSprite(t.upTextures);this.bodySpritesContainer.addChild(o);const n=new s.AnimatedSprite(t.upRightTextures);this.bodySpritesContainer.addChild(n);const h=new s.AnimatedSprite(t.rightTextures);this.bodySpritesContainer.addChild(h);const d=new s.AnimatedSprite(t.downRightTextures);this.bodySpritesContainer.addChild(d);const l=new s.AnimatedSprite(t.downTextures);this.bodySpritesContainer.addChild(l);const c=new s.AnimatedSprite(t.downLeftTextures);this.bodySpritesContainer.addChild(c);const u=new s.AnimatedSprite(t.leftTextures);this.bodySpritesContainer.addChild(u);const m=new s.AnimatedSprite(t.upLeftTextures);this.bodySpritesContainer.addChild(m),this.bodyAnimation={upAnimation:o,upRightAnimation:n,rightAnimation:h,downRightAnimation:d,downAnimation:l,downLeftAnimation:c,leftAnimation:u,upLeftAnimation:m};const p=new s.AnimatedSprite(i.upTextures);this.shadowSpritesContainer.addChild(p);const g=new s.AnimatedSprite(i.upRightTextures);this.shadowSpritesContainer.addChild(g);const w=new s.AnimatedSprite(i.rightTextures);this.shadowSpritesContainer.addChild(w);const f=new s.AnimatedSprite(i.downRightTextures);this.shadowSpritesContainer.addChild(f);const b=new s.AnimatedSprite(i.downTextures);this.shadowSpritesContainer.addChild(b);const y=new s.AnimatedSprite(i.downLeftTextures);this.shadowSpritesContainer.addChild(y);const x=new s.AnimatedSprite(i.leftTextures);this.shadowSpritesContainer.addChild(x);const T=new s.AnimatedSprite(i.upLeftTextures);this.shadowSpritesContainer.addChild(T),this.shadowAnimation={upAnimation:p,upRightAnimation:g,rightAnimation:w,downRightAnimation:f,downAnimation:b,downLeftAnimation:y,leftAnimation:x,upLeftAnimation:T},this.lifeBar=new a.LifeBar(this.drawLifeBarOptions),this.addChild(this.lifeBar)}hideAllBodyAnimations(){this.bodySpritesContainer.children.forEach((e=>{e.visible=!1}))}hideAllShadowAnimations(){this.shadowSpritesContainer.children.forEach((e=>{e.visible=!1}))}updateAnimation(e=!1){this.switchAnimation(this.vector.direction,e)}switchAnimation(e,t){let i,s;const o=.5;e>=r.EVectorDirection.upLeft+o&&e<=r.EVectorDirection.upLeft+1||e>=r.EVectorDirection.up&&e<=r.EVectorDirection.upRight-o?(i=this.bodyAnimation.upAnimation,s=this.shadowAnimation.upAnimation):e>=r.EVectorDirection.upRight+o&&e<=r.EVectorDirection.downRight-o?(i=this.bodyAnimation.rightAnimation,s=this.shadowAnimation.rightAnimation):e>=r.EVectorDirection.downRight+o&&e<=r.EVectorDirection.downLeft-o?(i=this.bodyAnimation.downAnimation,s=this.shadowAnimation.downAnimation):e>=r.EVectorDirection.downLeft+o&&e<=r.EVectorDirection.upLeft-o?(i=this.bodyAnimation.leftAnimation,s=this.shadowAnimation.leftAnimation):e>r.EVectorDirection.up&&e<r.EVectorDirection.right?(i=this.bodyAnimation.upRightAnimation,s=this.shadowAnimation.upRightAnimation):e>r.EVectorDirection.right&&e<r.EVectorDirection.down?(i=this.bodyAnimation.downRightAnimation,s=this.shadowAnimation.downRightAnimation):e>=r.EVectorDirection.down&&e<r.EVectorDirection.left?(i=this.bodyAnimation.downLeftAnimation,s=this.shadowAnimation.downLeftAnimation):(i=this.bodyAnimation.upLeftAnimation,s=this.shadowAnimation.upLeftAnimation),i!==this.currentBodyAnimation&&t&&(this.currentBodyAnimation=i,this.currentShadowAnimation=s,this.hideAllBodyAnimations(),this.hideAllShadowAnimations(),this.currentBodyAnimation.gotoAndPlay(0),this.currentShadowAnimation.gotoAndPlay(0),this.currentBodyAnimation.visible=!0,this.currentShadowAnimation.visible=!0)}processOrders(){const{tileMap:e}=this.game,t=this.getGridXY({center:!0});switch(this.order.type){case"move":{this.collisionCount=0;const i=Math.pow(this.order.toPoint.gridX-t.gridX,2)+Math.pow(this.order.toPoint.gridY-t.gridY,2);if(i<Math.pow(this.collisionRadius/e.gridSize,2))return this.order={type:"stand"},!0;{if(this.colliding&&i<Math.pow(5*this.collisionRadius/e.gridSize,2)&&(0===this.collisionCount?this.collisionCount=1:this.collisionCount++,this.collisionCount>30))return this.order={type:"stand"},!0;const t=Math.pow(i,.5);if(!this._moveTo(this.order.toPoint,t))return this.order={type:"stand"},!0}return!0}case"follow":{if(this.order.to.isDead())return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const e=this.order.to.getGridXY({center:!0}),i=Math.pow(e.gridX-t.gridX,2)+Math.pow(e.gridY-t.gridY,2);if(i<Math.pow(this.followRadius,2));else{const e=this.order.to.getGridXY({center:!0});this._moveTo({type:this.order.to.type,...e},i)}return!0}case"patrol":{const i=Math.pow(this.order.toPoint.gridX-t.gridX,2)+Math.pow(this.order.toPoint.gridY-t.gridY,2);if(i<Math.pow(this.sightRadius/e.gridSize,2)){const e=this.order.toPoint;this.order.toPoint=this.order.fromPoint,this.order.fromPoint=e}else this._moveTo(this.order.toPoint,i);return!0}}return!1}handleUpdate(e){super.handleUpdate(e),this.processOrders(),this.elapsedSwitchFrames>=this.switchFrames?(this.updateAnimation(!0),this.elapsedSwitchFrames=0):this.updateAnimation(this.moveTurning||0===this.elapsedSwitchFrames),this.elapsedSwitchFrames+=1,this.zIndex=this.y+this.height}checkCollisionObjects(e){const{tileMap:t,speedAdjustmentFactor:i,speedAdjustmentWhileTurningFactor:s}=this.game,r=this.getGridXY({center:!0}),o=this.speed*i*(this.moveTurning?s:1),n=Math.min(o,e),a=-Math.round(this.vector.direction)/this.vector.directions*2*Math.PI,h=r.gridX-n*Math.sin(a),d=r.gridY-n*Math.cos(a),c=[],{airMoveableItems:u}=t;for(let e=u.length-1;e>=0;e--){const i=u[e],s=i.getGridXY({center:!0});if(i!==this&&Math.abs(s.gridX-r.gridX)<3&&Math.abs(s.gridY-r.gridY)<3){const e=Math.pow(s.gridX-h,2)+Math.pow(s.gridY-d,2);e<Math.pow(.2*(this.collisionRadius+i.collisionRadius)/t.gridSize,2)?c.push({collisionType:l.hard,with:{type:i.type,x:s.gridX,y:s.gridY}}):e<Math.pow(.5*(this.collisionRadius+i.collisionRadius)/t.gridSize,2)&&c.push({collisionType:l.soft,with:{type:i.type,x:s.gridX,y:s.gridY}})}}return c}_moveTo(e,t){const{turnSpeedAdjustmentFactor:i,speedAdjustmentFactor:s,speedAdjustmentWhileTurningFactor:r}=this.game,n=this.getGridXY({center:!0});let a=(0,o.findAngleGrid)({from:e,to:n,directions:this.vector.directions});const h=this.checkCollisionObjects(t);if(this.hardCollision=!1,h.length>0){this.colliding=!0;const e={x:0,y:0};for(let t=h.length-1;t>=0;t--){const i=h[t],s=-(0,o.findAngle)({from:i.with,to:{x:n.gridX,y:n.gridY},directions:this.vector.directions})/this.vector.directions*2*Math.PI;let r=0;switch(i.collisionType){case l.hard:r=1.5+Math.random(),this.hardCollision=!0;break;case l.soft:r=.5+Math.random()}e.x+=r*Math.sin(s),e.y+=r*Math.cos(s)}a=(0,o.findAngle)({from:e,to:{x:0,y:0},directions:this.vector.directions})}else this.colliding=!1;const d=(0,o.angleDiff)({angle1:this.vector.direction,angle2:a,directions:this.vector.directions}),c=this.turnSpeed*i;Math.abs(d)>c*this.turnFactor?(this.vector.setDirection({direction:(0,o.wrapDirection)({direction:this.vector.direction+c*Math.abs(d)/d,directions:this.vector.directions})}),this.moveTurning=!0):(this.vector.setDirection({direction:a}),this.moveTurning=!1);const u=this.speed*s*(this.moveTurning?r:1),m=Math.min(u,t),p=-this.vector.direction/this.vector.directions*2*Math.PI,g=-m*Math.sin(p),w=-m*Math.cos(p),f=n.gridX+g,b=n.gridY+w;return this.setPositionByGridXY({gridX:f,gridY:b,center:!0}),!0}setupShadow(){const{offset:e}=this.drawShadowOptions;this.shadowSpritesContainer.position.set(e.x,e.y)}}t.AirVehicle=c},20855:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AttackableAirVehicle=void 0;const s=i(16445),r=i(33959),o=i(53555),n=i(42097),a=i(93947);class h extends a.AirVehicle{constructor(e){super(e),this.commands=[s.ECommandName.moveFollow,s.ECommandName.attackGuard,s.ECommandName.patrol],this.reloadTimeLeft=0,this.drawReloadBarOptions={alpha:0,width:0,height:0,fillColor:0,offset:{x:0,y:0}},this.attackRadius=0,this.canAttack=!1,this.canAttackLand=!1,this.canAttackAir=!1,this.setup(e)}setup(e){super.setup(e),this.reloadBar=new r.ReloadBar(this.drawReloadBarOptions),this.addChild(this.reloadBar)}isValidTarget(e){return e.team!==this.team&&(this.canAttackLand&&(e.type===n.EItemType.buildings||e.type===n.EItemType.vehicles)||this.canAttackAir&&e.type===n.EItemType.airVehicles)}findTargetInSight(e=0){const t=this.getGridXY({center:!0}),i={},s=this.game.tileMap.activeItems.children;for(let r=s.length-1;r>=0;r--){const o=s[r];if(this.isValidTarget(o)){const s=o.getGridXY({center:!0}),r=Math.pow(s.gridX-t.gridX,2)+Math.pow(s.gridY-t.gridY,2);r<Math.pow(this.sightRadius+e,2)&&(Array.isArray(i[r])||(i[r]=[]),i[r].push(o))}}return Object.keys(i).map(Number).sort(((e,t)=>e-t)).map((e=>i[e])).flat()[0]}processOrders(){if("patrol"!==this.order.type&&super.processOrders())return!0;const{tileMap:e,turnSpeedAdjustmentFactor:t}=this.game,i=this.getGridXY({center:!0});switch(this.order.type){case"stand":{const e=this.findTargetInSight();return null!=e&&(this.order={type:"attack",to:e}),!0}case"hunt":{const e=this.findTargetInSight(100);return null!=e&&(this.order={type:"attack",to:e,nextOrder:this.order}),!0}case"attack":{if(null==this.order.to)return!0;if(this.order.to.isDead()||!this.isValidTarget(this.order.to))return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const s=this.order.to.getGridXY({center:!0}),r=Math.pow(s.gridX-i.gridX,2)+Math.pow(s.gridY-i.gridY,2);if(r<Math.pow(this.attackRadius,2)){const r=(0,o.findAngleGrid)({from:s,to:i,directions:this.vector.directions}),n=(0,o.angleDiff)({angle1:this.vector.direction,angle2:r,directions:this.vector.directions}),a=this.turnSpeed*t;if(Math.abs(n)>a)this.vector.setDirection({direction:(0,o.wrapDirection)({direction:this.vector.direction+a*Math.abs(n)/n,directions:this.vector.directions})}),this.moveTurning=!0;else if(this.vector.setDirection({direction:r}),this.moveTurning=!1,this.reloadTimeLeft<=0){const t=this.game.getReloadTime(this.projectile);if("number"==typeof t){this.reloadTimeLeft=t;const s=-this.vector.direction/this.vector.directions*2*Math.PI,o=i.gridX-this.collisionRadius*Math.sin(s)/e.gridSize,n=i.gridY-this.collisionRadius*Math.cos(s)/e.gridSize,a=this.game.createProjectile({name:this.projectile,initX:o*e.gridSize,initY:n*e.gridSize,direction:r,target:this.order.to});null!=a&&e.addItem(a)}}}else{const e=Math.pow(r,.5);this._moveTo({type:this.order.to.type,...s},e)||(this.order={type:"stand"})}return!0}case"patrol":{const t=this.findTargetInSight();if(null!=t)return this.order={type:"attack",to:t,nextOrder:this.order},!0;const s=Math.pow(this.order.toPoint.gridX-i.gridX,2)+Math.pow(this.order.toPoint.gridY-i.gridY,2);if(s<Math.pow(this.sightRadius/e.gridSize,2)){const e=this.order.toPoint;this.order.toPoint=this.order.fromPoint,this.order.fromPoint=e}else this._moveTo(this.order.toPoint,s);return!0}case"guard":{if(this.order.to.isDead())return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const e=this.order.to.getGridXY({center:!0}),t=Math.pow(e.gridX-i.gridX,2)+Math.pow(e.gridY-i.gridY,2);if(t<Math.pow(this.followRadius,2)){const e=this.findTargetInSight();if(null!=e)return this.order={type:"attack",to:e,nextOrder:this.order},!0;"attack"===this.order.to.order.type&&(this.order={type:"attack",to:this.order.to.order.to,nextOrder:this.order})}else{const e=this.findTargetInSight();if(null!=e)this.order={type:"attack",to:e,nextOrder:this.order};else{const e=this.order.to.getGridXY({center:!0});this._moveTo({type:this.order.to.type,...e},t)}}return!0}case"move-and-attack":{const t=this.findTargetInSight();if(null!=t)return this.order={type:"attack",to:t,nextOrder:this.order},!0;const s=Math.pow(this.order.toPoint.gridX-i.gridX,2)+Math.pow(this.order.toPoint.gridY-i.gridY,2);if(s<Math.pow(this.collisionRadius/e.gridSize,2))return this.order={type:"stand"},!0;const r=Math.pow(s,.5);return this._moveTo(this.order.toPoint,r)||(this.order={type:"stand"}),!0}}return!1}handleUpdate(e){this.reloadTimeLeft>0&&(this.reloadTimeLeft-=this.game.reloadAdjustmentFactor),this.updateReload(),super.handleUpdate(e)}drawReloadBar(){this.reloadBar.draw(this.drawReloadBarOptions);const{offset:e}=this.drawReloadBarOptions;this.reloadBar.position.set(e.x,e.y)}updateReload(){const e=this.game.getReloadTime(this.projectile);"number"==typeof e&&this.reloadBar.updateReload((e-this.reloadTimeLeft)/e)}}t.AttackableAirVehicle=h},30332:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Chopper=void 0;const s=i(53555),r=i(42097),o=i(20855);class n extends o.AttackableAirVehicle{static textures(e){return{body:e===s.Team.blue?n.blueTextures:n.greenTextures,shadow:n.shadowTextures}}static prepareTextures({blueTextures:e,greenTextures:t,shadowTextures:i}){n.blueTextures=e,n.greenTextures=t,n.shadowTextures=i}constructor(e){var t;super({...e,textures:n.textures(e.team)}),this.itemName=r.EItemName.Chopper,this.collisionOptions={width:28,height:28,offset:{x:7,y:5}},this.drawSelectionOptions={width:0,height:0,radius:15,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:4,y:2}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:28,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:7,y:-5}},this.drawReloadBarOptions={alpha:1,width:28,height:2,fillColor:12690711,offset:{x:7,y:0}},this.drawShadowOptions={offset:{x:0,y:40}},this.collisionRadius=14,this.sightRadius=12,this.attackRadius=6,this.speed=25,this.hitPoints=50,this.turnSpeed=8,this.turnFactor=10,this.projectile=r.EItemName.Rocket,this.canAttack=!0,this.canAttackLand=!0,this.canAttackAir=!1,this.animationSpeed=.2,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===s.Team.blue?255:4243264,this.setupShadow(),this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.drawReloadBar(),this.updateReload(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport(),Object.values(this.bodyAnimation).concat(Object.values(this.shadowAnimation)).forEach((e=>{e.animationSpeed=this.animationSpeed}))}}n.cost=90,t.Chopper=n},60231:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wraith=void 0;const s=i(53555),r=i(42097),o=i(20855);class n extends o.AttackableAirVehicle{static textures(e){return{body:e===s.Team.blue?n.blueTextures:n.greenTextures,shadow:n.shadowTextures}}static prepareTextures({blueTextures:e,greenTextures:t,shadowTextures:i}){n.blueTextures=e,n.greenTextures=t,n.shadowTextures=i}constructor(e){var t;super({...e,textures:n.textures(e.team)}),this.itemName=r.EItemName.Wraith,this.collisionOptions={width:24,height:24,offset:{x:3,y:3}},this.drawSelectionOptions={width:0,height:0,radius:14,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:-1,y:-1}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:24,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:3,y:-8}},this.drawReloadBarOptions={alpha:1,width:24,height:2,fillColor:12690711,offset:{x:3,y:-3}},this.drawShadowOptions={offset:{x:0,y:40}},this.collisionRadius=12,this.sightRadius=14,this.attackRadius=8,this.speed=40,this.hitPoints=50,this.turnSpeed=4,this.turnFactor=10,this.projectile=r.EItemName.Laser,this.canAttack=!0,this.canAttackLand=!1,this.canAttackAir=!0,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===s.Team.blue?255:4243264,this.setupShadow(),this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.drawReloadBar(),this.updateReload(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}}n.cost=60,t.Wraith=n},76752:(e,t,i)=>{i(67279);const s=i(9678),r=i(23266),o=i(54462);(async function(){var e;const t=document.querySelector(".loader");null!=t&&(null===(e=t.parentElement)||void 0===e||e.removeChild(t)),await s.SceneManager.initialize();const i=new r.LoaderScene({viewWidth:s.SceneManager.width,viewHeight:s.SceneManager.height});await s.SceneManager.changeScene({name:"loader",newScene:i}),await i.initializeLoader();const{menuBackground:n}=i.getAssets();await s.SceneManager.changeScene({name:"menu",newScene:new o.MenuScene({app:s.SceneManager.app,viewWidth:s.SceneManager.width,viewHeight:s.SceneManager.height,menuTexture:n})})})().catch((e=>{var t;console.error(e);const i=document.querySelector(".error-message");null!=i&&(i.classList.remove("hidden"),i.innerText=Boolean(e)&&Boolean(e.message)?e.message:e);const s=document.querySelector(".error-stack");null!=s&&(s.classList.remove("hidden"),s.innerText=Boolean(e)&&Boolean(e.stack)?e.stack:"");const r=document.querySelector("canvas");null!=r&&(null===(t=r.parentElement)||void 0===t||t.removeChild(r))}))},18274:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AttackableBuilding=void 0;const s=i(58687),r=i(33959),o=i(7091),n=i(53555),a=i(42097),h=i(30756),d=i(16445);class l extends h.Building{constructor(e){super(e),this.commands=[d.ECommandName.attack],this.reloadTimeLeft=0,this.drawReloadBarOptions={alpha:0,width:0,height:0,fillColor:0,offset:{x:0,y:0}},this.attackRadius=0,this.canAttack=!1,this.canAttackLand=!1,this.canAttackAir=!1,this.vector=new o.Vector({direction:o.EVectorDirection.down}),this.moveTurning=!1,this.turnSpeed=0,null!=e.direction&&this.vector.setDirection({direction:e.direction})}setup(e){super.setup(e),this.reloadBar=new r.ReloadBar(this.drawReloadBarOptions),this.addChild(this.reloadBar);const{upTextures:t,upRightTextures:i,rightTextures:o,downRightTextures:n,downTextures:a,downLeftTextures:h,leftTextures:d,upLeftTextures:l}=e.textures,c=new s.AnimatedSprite(t);this.spritesContainer.addChild(c),this.upAnimation=c;const u=new s.AnimatedSprite(i);this.spritesContainer.addChild(u),this.upRightAnimation=u;const m=new s.AnimatedSprite(o);this.spritesContainer.addChild(m),this.rightAnimation=m;const p=new s.AnimatedSprite(n);this.spritesContainer.addChild(p),this.downRightAnimation=p;const g=new s.AnimatedSprite(a);this.spritesContainer.addChild(g),this.downAnimation=g;const w=new s.AnimatedSprite(h);this.spritesContainer.addChild(w),this.downLeftAnimation=w;const f=new s.AnimatedSprite(d);this.spritesContainer.addChild(f),this.leftAnimation=f;const b=new s.AnimatedSprite(l);this.spritesContainer.addChild(b),this.upLeftAnimation=b}switchAnimation(e){let t;switch(e){case h.BuildingAnimation.healthy:{const e=.5,{direction:i}=this.vector;t=i>=o.EVectorDirection.upLeft+e&&i<=o.EVectorDirection.upLeft+1||i>=o.EVectorDirection.up&&i<=o.EVectorDirection.upRight-e?this.upAnimation:i>=o.EVectorDirection.upRight+e&&i<=o.EVectorDirection.downRight-e?this.rightAnimation:i>=o.EVectorDirection.downRight+e&&i<=o.EVectorDirection.downLeft-e?this.downAnimation:i>=o.EVectorDirection.downLeft+e&&i<=o.EVectorDirection.upLeft-e?this.leftAnimation:i>o.EVectorDirection.up&&i<o.EVectorDirection.right?this.upRightAnimation:i>o.EVectorDirection.right&&i<o.EVectorDirection.down?this.downRightAnimation:i>=o.EVectorDirection.down&&i<o.EVectorDirection.left?this.downLeftAnimation:this.upLeftAnimation;break}case h.BuildingAnimation.damaged:t=this.damagedAnimation}t!==this.currentAnimation&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}isValidTarget(e){return e.team!==this.team&&(this.canAttackLand&&(e.type===a.EItemType.buildings||e.type===a.EItemType.vehicles)||this.canAttackAir&&e.type===a.EItemType.airVehicles)}findTargetInSight(e=0){const t=this.getGridXY({center:!0}),i={},s=this.game.tileMap.activeItems.children;for(let r=s.length-1;r>=0;r--){const o=s[r];if(this.isValidTarget(o)){const s=o.getGridXY({center:!0}),r=Math.pow(s.gridX-t.gridX,2)+Math.pow(s.gridY-t.gridY,2);r<Math.pow(this.sightRadius+e,2)&&(Array.isArray(i[r])||(i[r]=[]),i[r].push(o))}}return Object.keys(i).map(Number).sort(((e,t)=>e-t)).map((e=>i[e])).flat()[0]}drawReloadBar(){this.reloadBar.draw(this.drawReloadBarOptions);const{offset:e}=this.drawReloadBarOptions;this.reloadBar.position.set(e.x,e.y)}updateReload(){const e=this.game.getReloadTime(this.projectile);"number"==typeof e&&this.reloadBar.updateReload((e-this.reloadTimeLeft)/e)}processOrders(){if(!this.isHealthy())return!1;switch(this.order.type){case"stand":{const e=this.findTargetInSight();null!=e&&(this.order={type:"attack",to:e,nextOrder:this.order});break}case"attack":{if(null==this.order.to)return!0;const e=this.getGridXY({center:!0}),t=this.order.to.getGridXY({center:!0}),i=Math.pow(t.gridX-e.gridX,2)+Math.pow(t.gridY-e.gridY,2);if(this.order.to.isDead()||!this.isValidTarget(this.order.to)||i>Math.pow(this.sightRadius,2)){const e=this.findTargetInSight();null!=e?this.order.to=e:this.order={type:"stand"}}if("attack"!==this.order.type||null==this.order.to)return!0;if(i<Math.pow(this.attackRadius,2)){const{turnSpeedAdjustmentFactor:i,tileMap:s}=this.game,r=(0,n.findAngleGrid)({from:t,to:e,directions:this.vector.directions}),o=(0,n.angleDiff)({angle1:this.vector.direction,angle2:r,directions:this.vector.directions}),a=this.turnSpeed*i;if(Math.abs(o)>a)this.vector.setDirection({direction:(0,n.wrapDirection)({direction:this.vector.direction+a*Math.abs(o)/o,directions:this.vector.directions})}),this.moveTurning=!0;else if(this.vector.setDirection({direction:r}),this.moveTurning=!1,this.reloadTimeLeft<=0){const t=this.game.getReloadTime(this.projectile);if("number"==typeof t){this.reloadTimeLeft=t;const i=-Math.round(this.vector.direction)/this.vector.directions*2*Math.PI,o=e.gridX-this.collisionRadius*Math.sin(i)/s.gridSize,n=e.gridY-this.collisionRadius*Math.cos(i)/s.gridSize,a=this.game.createProjectile({name:this.projectile,initX:o*s.gridSize,initY:n*s.gridSize,direction:r,target:this.order.to});null!=a&&s.addItem(a)}}}break}}return!1}handleUpdate(e){this.reloadTimeLeft>0&&(this.reloadTimeLeft-=this.game.reloadAdjustmentFactor),this.processOrders(),this.updateAnimation(),this.updateReload(),this.zIndex=this.y+this.height}}t.AttackableBuilding=l},54539:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Base=t.BaseAnimation=void 0;const s=i(58687),r=i(53555),o=i(30756),n=i(42097),a=i(16445),h=i(70519),d=i(36645);var l;!function(e){e.constructing="constructing",e.healthy="healthy",e.damaged="damaged"}(l=t.BaseAnimation||(t.BaseAnimation={}));class c extends o.Building{static textures(e){return e===r.Team.blue?c.blueTextures:c.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){c.blueTextures=e,c.greenTextures=t}constructor(e){var t;super({...e,textures:c.textures(e.team)}),this.itemName=n.EItemName.Base,this.commands=[a.ECommandName.constructSCV,a.ECommandName.constructHarvester],this.collisionOptions={width:40,height:40,offset:{x:0,y:20}},this.drawSelectionOptions={width:44,height:44,radius:0,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:-2,y:18}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:40,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:0,y:-2}},this.sightRadius=8,this.hitPoints=500,this.life=this.hitPoints,this.constructingAnimationSpeed=.1,this.buildableGrid=[[1,1],[1,1]],this.passableGrid=[[1,1],[1,1]],Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===r.Team.blue?255:65280,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY}),this.drawLifeBar(),this.updateLife(),this.constructingAnimation.animationSpeed=this.constructingAnimationSpeed,this.updateAnimation()}setup(e){const t=c.textures(e.team);super.setup({...e,textures:t});const{constructingTextures:i}=t,r=new s.AnimatedSprite(i);this.spritesContainer.addChild(r),this.constructingAnimation=r}switchAnimation(e){let t;switch(e){case l.constructing:t=this.constructingAnimation;break;case l.healthy:t=this.healthyAnimation;break;case l.damaged:t=this.damagedAnimation}t!==this.currentAnimation&&null!=t&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}isConstructing(){return this.currentAnimation===this.constructingAnimation}updateAnimation(){if(this.isHealthy())if(this.isConstructing()){if(this.constructingAnimation.currentFrame===this.constructingAnimation.totalFrames-1&&(this.switchAnimation(l.healthy),null!=this.constructUnit)){const e=this.game.createItem(this.constructUnit);null!=e&&(this.game.cash[this.team]-=this.constructUnit.cost,(0,d.logCash)(`(${this.team}) base construct (-${this.constructUnit.cost}) b=${this.game.cash.blue} g=${this.game.cash.green}`),this.game.tileMap.addItem(e))}}else this.switchAnimation(l.healthy);else this.isAlive()&&this.switchAnimation(l.damaged)}processOrders(){if("construct-unit"===this.order.type){if(!this.isHealthy())return!1;const{tileMap:e,team:t,cash:i}=this.game;e.rebuildBuildableGrid();const{currentMapBuildableGrid:s,mapGridWidth:r,mapGridHeight:o}=e,{buildableGrid:n}=this,a=[],d=this.getGridXY();for(const e of[d.gridY-1,d.gridY+n.length])for(const t of[d.gridX-1,d.gridX+n[0].length])t<0||t>=r||e<0||e>=o||0===s[e][t]&&a.push({gridX:t,gridY:e});if(a.length<=0)return this.game.showMessage({character:h.EMessageCharacter.system,message:"Warning! Cannot teleport unit while landing bay is occupied.",selfRemove:!0}),this.order={type:"stand"},!0;const c=this.game.getItemCost(this.order.name);if("number"==typeof c)if(i[this.team]<c)this.team===t&&this.game.showMessage({character:h.EMessageCharacter.system,message:`Warning! Insufficient Funds. Need ${c} credits.`,selfRemove:!0});else{const e=a[Math.floor(Math.random()*a.length)];this.constructUnit={initGridX:e.gridX+.5,initGridY:e.gridY+.5,initCenter:!0,team:this.team,name:this.order.name,order:this.order.unitOrder,teleport:!0,cost:c},this.switchAnimation(l.constructing)}else console.warn(`Unable to calc item (name=${this.order.name}) cost`);this.order={type:"stand"}}return!1}}t.Base=c},30756:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BuildingAnimation=t.Building=void 0;const s=i(58687),r=i(42097),o=i(94973),n=i(46111),a=i(28807);class h extends n.SelectableLifeableSquareItem{constructor(e){super(e),this.commands=[],this.spritesContainer=new s.Container,this.buildableGrid=[],this.passableGrid=[],this.type=r.EItemType.buildings,this.cost=0,this.healthyAnimationSpeed=.1,this.damagedAnimationSpeed=.1,this.setup(e)}setup(e){this.addChild(this.selectedGraphics),this.addChild(this.spritesContainer),this.addChild(this.collisionGraphics);const{textures:{healthyTextures:t,damagedTextures:i}}=e,{healthyAnimationSpeed:r,damagedAnimationSpeed:n}=this,a=new s.AnimatedSprite(t);a.animationSpeed=r,this.spritesContainer.addChild(a),this.healthyAnimation=a;const h=new s.AnimatedSprite(i);h.animationSpeed=n,this.spritesContainer.addChild(h),this.damagedAnimation=h,this.lifeBar=new o.LifeBar(this.drawLifeBarOptions),this.addChild(this.lifeBar)}hideAllAnimations(){this.spritesContainer.children.forEach((e=>{e.visible=!1}))}updateAnimation(){this.isHealthy()?this.switchAnimation(d.healthy):this.isAlive()&&this.switchAnimation(d.damaged)}switchAnimation(e){let t;switch(e){case d.healthy:t=this.healthyAnimation;break;case d.damaged:t=this.damagedAnimation}t!==this.currentAnimation&&null!=t&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}handleUpdate(e){this.processOrders(),this.updateAnimation(),this.calcZIndex()}calcZIndex(){this.zIndex=this.y+this.height}calcPassablePoints({gridX:e,gridY:t}){return(0,a.calcPassablePoints)({gridX:e,gridY:t,passableGrid:this.passableGrid})}calcBuildablePoints({gridX:e,gridY:t}){return(0,a.calcBuildablePoints)({gridX:e,gridY:t,buildableGrid:this.buildableGrid})}}var d;t.Building=h,function(e){e.healthy="healthy",e.damaged="damaged"}(d=t.BuildingAnimation||(t.BuildingAnimation={}))},54536:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GroundTurret=t.GroundTurretAnimation=void 0;const s=i(58687),r=i(53555),o=i(18274),n=i(42097),a=i(30756);var h;!function(e){e.healthy="healthy",e.damaged="damaged",e.teleport="teleport"}(h=t.GroundTurretAnimation||(t.GroundTurretAnimation={}));class d extends o.AttackableBuilding{static textures(e){return e===r.Team.blue?d.blueTextures:d.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){d.blueTextures=e,d.greenTextures=t}constructor(e){var t;super({...e,textures:d.textures(e.team)}),this.itemName=n.EItemName.GroundTurret,this.drawSelectionOptions={width:26,height:23,radius:0,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:6,y:9}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:22,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:8,y:-2}},this.drawReloadBarOptions={alpha:1,width:22,height:2,fillColor:12690711,offset:{x:8,y:3}},this.collisionRadius=10,this.sightRadius=11,this.attackRadius=10,this.hitPoints=200,this.life=this.hitPoints,this.teleportAnimationSpeed=.1,this.canAttack=!0,this.canAttackLand=!0,this.canAttackAir=!1,this.turnSpeed=4,this.projectile=n.EItemName.CannonBall,this.order={type:"stand"},this.collisionOptions=d.collisionOptions,Array.isArray(e.commands)&&(this.commands=e.commands),this.buildableGrid=d.buildableGrid,this.passableGrid=d.passableGrid,this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===r.Team.blue?255:65280,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY}),this.drawLifeBar(),this.updateLife(),this.drawReloadBar(),this.updateReload(),this.teleportAnimation.animationSpeed=this.teleportAnimationSpeed,!0===e.teleport?this.switchAnimation(h.teleport):this.updateAnimation()}setup(e){const t=d.textures(e.team);super.setup({...e,textures:t});const i=new s.AnimatedSprite(t.teleportTextures);this.spritesContainer.addChild(i),this.teleportAnimation=i}isTeleporting(){return this.currentAnimation===this.teleportAnimation}updateAnimation(){this.isHealthy()?this.isTeleporting()?this.teleportAnimation.currentFrame===this.teleportAnimation.totalFrames-1&&this.switchAnimation(h.healthy):this.switchAnimation(h.healthy):this.isAlive()&&this.switchAnimation(h.damaged)}switchAnimation(e){let t;e===h.teleport&&(t=this.teleportAnimation),null!=t?t!==this.currentAnimation&&null!=t&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0):e===h.healthy?super.switchAnimation(a.BuildingAnimation.healthy):super.switchAnimation(a.BuildingAnimation.damaged)}}d.collisionOptions={width:22,height:19,offset:{x:8,y:11}},d.cost=150,d.buildableGrid=[[1]],d.passableGrid=[[1]],t.GroundTurret=d},46667:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OilDerrick=t.OilDerrickAnimation=void 0;const s=i(58687),r=i(53555),o=i(30756),n=i(42097),a=i(36645);var h;!function(e){e.deploy="deploy",e.healthy="healthy",e.damaged="damaged"}(h=t.OilDerrickAnimation||(t.OilDerrickAnimation={}));class d extends o.Building{static textures(e){return e===r.Team.blue?d.blueTextures:d.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){d.blueTextures=e,d.greenTextures=t}constructor(e){var t;super({...e,textures:d.textures(e.team)}),this.itemName=n.EItemName.OilDerrick,this.drawSelectionOptions={width:39,height:23,radius:0,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:0,y:39}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:36,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:2,y:-4}},this.sightRadius=4,this.hitPoints=300,this.life=this.hitPoints,this.deployAnimationSpeed=.1,this.elapsedTime=0,this.harvestInterval=1e3,this.harvestAmount=5,this.collisionOptions=d.collisionOptions,Array.isArray(e.commands)&&(this.commands=e.commands),this.buildableGrid=d.buildableGrid,this.passableGrid=d.passableGrid,this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===r.Team.blue?255:65280,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY}),this.drawLifeBar(),this.updateLife(),this.deployAnimation.animationSpeed=this.deployAnimationSpeed,!0===e.deploy?this.switchAnimation(h.deploy):this.updateAnimation()}setup(e){const t=d.textures(e.team);super.setup({...e,textures:t});const{deployTextures:i}=t,r=new s.AnimatedSprite(i);r.loop=!1,this.spritesContainer.addChild(r),this.deployAnimation=r}isDeploying(){return this.currentAnimation===this.deployAnimation}updateAnimation(){this.isHealthy()?this.isDeploying()?this.deployAnimation.currentFrame===this.deployAnimation.totalFrames-1&&this.switchAnimation(h.healthy):this.switchAnimation(h.healthy):this.isAlive()&&this.switchAnimation(h.damaged)}switchAnimation(e){let t;switch(e){case h.deploy:t=this.deployAnimation;break;case h.healthy:t=this.healthyAnimation;break;case h.damaged:t=this.damagedAnimation}t!==this.currentAnimation&&null!=t&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}handleUpdate(e){this.isHealthy()&&(this.elapsedTime>=this.harvestInterval&&(this.game.cash[this.team]+=this.harvestAmount,(0,a.logCash)(`(${this.team}) oil derrick (+${this.harvestAmount}) b=${this.game.cash.blue} g=${this.game.cash.green}`),this.elapsedTime=0),this.elapsedTime+=e),this.processOrders(),this.updateAnimation(),this.calcZIndex()}}d.collisionOptions={width:35,height:19,offset:{x:2,y:41}},d.buildableGrid=[[1,1]],d.passableGrid=[[1,1]],t.OilDerrick=d},41759:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Starport=t.StarportAnimation=void 0;const s=i(58687),r=i(53555),o=i(30756),n=i(42097),a=i(70519),h=i(16445),d=i(36645);var l;!function(e){e.open="open",e.close="close",e.teleport="teleport",e.healthy="healthy",e.damaged="damaged"}(l=t.StarportAnimation||(t.StarportAnimation={}));class c extends o.Building{static textures(e){return e===r.Team.blue?c.blueTextures:c.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){c.blueTextures=e,c.greenTextures=t}constructor(e){var t;super({...e,textures:c.textures(e.team)}),this.commands=[h.ECommandName.constructScoutTank,h.ECommandName.constructHeavyTank,h.ECommandName.constructChopper,h.ECommandName.constructWraith],this.itemName=n.EItemName.Starport,this.drawSelectionOptions={width:42,height:58,radius:0,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:-1,y:3}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:38,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:1,y:-4}},this.sightRadius=6,this.hitPoints=300,this.life=this.hitPoints,this.teleportAnimationSpeed=.1,this.closingAnimationSpeed=.1,this.collisionOptions=c.collisionOptions,Array.isArray(e.commands)&&(this.commands=e.commands),this.buildableGrid=c.buildableGrid,this.passableGrid=c.passableGrid,this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===r.Team.blue?255:65280,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY}),this.drawLifeBar(),this.updateLife(),this.teleportAnimation.animationSpeed=this.teleportAnimationSpeed,this.closingAnimation.animationSpeed=this.closingAnimationSpeed,this.openingAnimation.animationSpeed=this.closingAnimationSpeed,!0===e.teleport?this.switchAnimation(l.teleport):this.updateAnimation()}calcZIndex(){this.zIndex=this.y+this.height*this.passableGrid.filter((e=>e.some((e=>1===e)))).length/this.passableGrid.length}setup(e){const t=c.textures(e.team);super.setup({...e,textures:t});const{teleportTextures:i,closingTextures:r,openingTextures:o}=t,n=new s.AnimatedSprite(i);n.loop=!1,this.spritesContainer.addChild(n),this.teleportAnimation=n;const a=new s.AnimatedSprite(r);a.loop=!1,this.spritesContainer.addChild(a),this.closingAnimation=a;const h=new s.AnimatedSprite(o);h.loop=!1,this.spritesContainer.addChild(h),this.openingAnimation=h}isTeleporting(){return this.currentAnimation===this.teleportAnimation}isOpening(){return this.currentAnimation===this.openingAnimation}isClosing(){return this.currentAnimation===this.closingAnimation}isIdle(){return this.currentAnimation===this.healthyAnimation}updateAnimation(){if(this.isHealthy())if(this.isTeleporting())this.teleportAnimation.currentFrame===this.teleportAnimation.totalFrames-1&&this.switchAnimation(l.healthy);else if(this.isOpening()){if(this.openingAnimation.currentFrame===this.openingAnimation.totalFrames-1&&(this.switchAnimation(l.close),null!=this.constructUnit)){const e=this.game.createItem(this.constructUnit);null!=e&&(this.game.cash[this.team]-=this.constructUnit.cost,(0,d.logCash)(`(${this.team}) starport construct (-${this.constructUnit.cost}) b=${this.game.cash.blue} g=${this.game.cash.green}`),this.game.tileMap.addItem(e))}}else this.isClosing()&&(this.closingAnimation.currentFrame,this.closingAnimation.totalFrames),this.switchAnimation(l.healthy);else this.isAlive()&&this.switchAnimation(l.damaged)}switchAnimation(e){let t;switch(e){case l.teleport:t=this.teleportAnimation;break;case l.open:t=this.openingAnimation;break;case l.close:t=this.closingAnimation;break;case l.healthy:t=this.healthyAnimation;break;case l.damaged:t=this.damagedAnimation}t!==this.currentAnimation&&null!=t&&(this.currentAnimation=t,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}processOrders(){if("construct-unit"===this.order.type){if(!this.isHealthy())return!1;const e=this.getCollisionBounds(),{tileMap:t,team:i,cash:s}=this.game;let r=!1;for(let i=t.moveableItems.length-1;i>=0;i--){const s=t.moveableItems[i].getCollisionBounds();if(s.left>=e.left&&s.right<=e.right&&s.top>=e.top&&s.bottom<=e.bottom){r=!0;break}}const o=this.game.getItemCost(this.order.name);if("number"==typeof o)if(r)this.team===i&&this.game.showMessage({character:a.EMessageCharacter.system,message:"Warning! Cannot teleport unit while landing bay is occupied.",selfRemove:!0});else if(s[this.team]<o)this.team===i&&this.game.showMessage({character:a.EMessageCharacter.system,message:`Warning! Insufficient Funds. Need ${o} credits.`,selfRemove:!0});else{const e=this.getCollisionPosition({center:!0});this.constructUnit={initX:e.x,initY:e.y,initCenter:!0,team:this.team,name:this.order.name,order:this.order.unitOrder,teleport:!0,cost:o,uid:this.order.unitUid},this.switchAnimation(l.open)}else console.warn(`Unable to calc item (name=${this.order.name}) cost`);this.order={type:"stand"}}return!1}}c.collisionOptions={width:40,height:55,offset:{x:0,y:4}},c.cost=200,c.buildableGrid=[[1,1],[1,1],[1,1]],c.passableGrid=[[1,1],[0,0],[0,0]],t.Starport=c},39618:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const s=i(58687);class r extends s.Container{constructor(e){var t,i,s,r,o,n,a,h,d,l,c,u,m,p,g,w,f,b,y,x,T,v,C,S,M,k,A,E,I,Y,P,B,G,X,R,O,L,H,D,N,V,F,W,_,z;super(),this.selected=!1,this.disabled=!1,this.eventMode="static",this.cursor="pointer",this.onClick=e.onClick,this.iconPaddingTop=null!==(t=e.iconPaddingTop)&&void 0!==t?t:20,this.iconPaddingLeft=null!==(i=e.iconPaddingLeft)&&void 0!==i?i:20,this.iconIdleAlpha=null!==(s=e.iconIdleAlpha)&&void 0!==s?s:1,this.iconHoverAlpha=null!==(r=e.iconHoverAlpha)&&void 0!==r?r:1,this.iconSelectedAlpha=null!==(o=e.iconSelectedAlpha)&&void 0!==o?o:1,this.iconDisabledAlpha=null!==(n=e.iconDisabledAlpha)&&void 0!==n?n:1,this.textPaddingTop=null!==(a=e.textPaddingTop)&&void 0!==a?a:20,this.textPaddingLeft=null!==(h=e.textPaddingLeft)&&void 0!==h?h:20,this.fontSize=null!==(d=e.fontSize)&&void 0!==d?d:16,this.textColor=null!==(l=e.textColor)&&void 0!==l?l:0,this.textColorHover=null!==(c=e.textColorHover)&&void 0!==c?c:0,this.shadowTextColor=null!==(u=e.shadowTextColor)&&void 0!==u?u:0,this.shadowThickness=null!==(m=e.shadowThickness)&&void 0!==m?m:0,this.iconColor=null!==(p=e.iconColor)&&void 0!==p?p:0,this.iconColorSelected=null!==(w=null!==(g=e.iconColorSelected)&&void 0!==g?g:this.iconColor)&&void 0!==w?w:0,this.iconColorDisabled=null!==(f=e.iconColorDisabled)&&void 0!==f?f:0,this.iconColorHover=null!==(b=e.iconColorHover)&&void 0!==b?b:0,this.buttonIdleColor=null!==(y=e.buttonIdleColor)&&void 0!==y?y:0,this.buttonIdleAlpha=null!==(x=e.buttonIdleAlpha)&&void 0!==x?x:1,this.buttonHoverColor=null!==(v=null!==(T=e.buttonHoverColor)&&void 0!==T?T:e.buttonIdleColor)&&void 0!==v?v:0,this.buttonHoverAlpha=null!==(C=e.buttonHoverAlpha)&&void 0!==C?C:1,this.buttonBorderWidth=null!==(S=e.buttonBorderWidth)&&void 0!==S?S:0,this.buttonBorderColor=null!==(k=null!==(M=e.buttonBorderColor)&&void 0!==M?M:this.buttonIdleColor)&&void 0!==k?k:0,this.buttonBorderHoverColor=null!==(E=null!==(A=e.buttonBorderHoverColor)&&void 0!==A?A:e.buttonIdleColor)&&void 0!==E?E:0,this.buttonBorderAlpha=null!==(I=e.buttonBorderAlpha)&&void 0!==I?I:1,this.buttonBorderHoverAlpha=null!==(Y=e.buttonBorderHoverAlpha)&&void 0!==Y?Y:1,this.buttonSelectedColor=null!==(B=null!==(P=e.buttonSelectedColor)&&void 0!==P?P:this.buttonIdleColor)&&void 0!==B?B:0,this.buttonDisabledColor=null!==(G=e.buttonDisabledColor)&&void 0!==G?G:0,this.buttonSelectedAlpha=null!==(X=e.buttonSelectedAlpha)&&void 0!==X?X:1,this.buttonDisabledAlpha=null!==(R=e.buttonDisabledAlpha)&&void 0!==R?R:1,this.buttonBorderSelectedColor=null!==(L=null!==(O=e.buttonBorderSelectedColor)&&void 0!==O?O:this.buttonBorderColor)&&void 0!==L?L:0,this.buttonBorderDisabledColor=null!==(H=e.buttonBorderDisabledColor)&&void 0!==H?H:0,this.buttonBorderSelectedAlpha=null!==(D=e.buttonBorderSelectedAlpha)&&void 0!==D?D:1,this.buttonBorderDisabledAlpha=null!==(N=e.buttonBorderDisabledAlpha)&&void 0!==N?N:1,this.textColorSelected=null!==(F=null!==(V=e.textColorSelected)&&void 0!==V?V:this.textColor)&&void 0!==F?F:0,this.textColorDisabled=null!==(_=null!==(W=e.textColorDisabled)&&void 0!==W?W:this.textColor)&&void 0!==_?_:0,this.flexDirection=null!==(z=e.flexDirection)&&void 0!==z?z:"row",this.setup(e),this.draw(e),this.updateState(),"number"==typeof e.initX&&(this.position.x=e.initX),"number"==typeof e.initY&&(this.position.y=e.initY)}setup({text:e,buttonWidth:t,buttonHeight:i,iconTexture:r,iconScale:o=1,iconWidth:n,iconHeight:a,buttonBorderWidth:h=0}){const d=new s.Graphics;this.addChild(d),this.border=d;const l=new s.Graphics;this.addChild(l),this.background=l,this.background.position.set(h,h);const{iconPaddingTop:c,iconPaddingLeft:u,textPaddingTop:m,textPaddingLeft:p,flexDirection:g}=this,w=new s.Sprite(r);w.scale.set(o),"number"==typeof n&&(w.width=n),"number"==typeof a&&(w.height=a),w.position.set(u+h,c+h),this.addChild(w),this.icon=w;const f=new s.Text(e,{fontFamily:"'Courier New', Courier, monospace",fontSize:this.fontSize,fill:16777215,align:"center",stroke:this.shadowTextColor,strokeThickness:this.shadowThickness});null!=r?"row"===g?f.position.set(w.x+w.width+p,m):"col-center"===g?(f.anchor.set(.5,0),f.position.set(null!=t?t/2:h+u+w.width/2,w.y+w.height+m)):f.position.set(h+p,w.y+w.height+m):null==t&&null==i||(null!=t&&null!=i?(f.anchor.set(.5,.5),f.position.set(t/2,i/2)):null==t&&null!=i?(f.anchor.set(0,.5),f.position.set(0,i/2)):null!=t&&null==i&&(f.anchor.set(.5,0),f.position.set(t/2,0))),this.addChild(f),this.text=f,this.initEventLesteners()}initEventLesteners(){this.on("pointertap",(e=>{this.selected=!this.selected,this.updateState(),"function"==typeof this.onClick&&this.onClick(e)})),this.on("pointerdown",(e=>{"touch"===e.pointerType&&this.updateState(!0)})),this.on("pointerenter",(e=>{"mouse"===e.pointerType&&this.updateState(!0)})),this.on("pointerleave",(e=>{"mouse"===e.pointerType&&this.updateState()})),this.on("pointerup",(e=>{"touch"===e.pointerType&&this.updateState()}))}draw({iconPaddingTop:e=0,buttonWidth:t,buttonHeight:i,buttonRadius:s=0,buttonBorderWidth:r=0,textPaddingTop:o=0}){"number"!=typeof t&&(t=this.width+2*r),"number"!=typeof i&&(i=e+this.icon.height+o+this.text.height+2*r),this.border.beginFill(16777215),this.border.drawRoundedRect(0,0,t,i,s),this.border.endFill(),this.border.beginHole(),this.border.drawRoundedRect(r,r,t-2*r,i-2*r,s),this.border.endHole(),this.background.beginFill(16777215),this.background.drawRoundedRect(0,0,t-2*r,i-2*r,s),this.background.endFill()}color({bgAlpha:e,brdColor:t,brdAlpha:i,bgColor:s,txtColor:r,iconColor:o,iconAlpha:n}){this.border.tint=t,this.border.alpha=i,this.background.tint=s,this.background.alpha=e,this.text.tint=r,this.icon.tint=o,this.icon.alpha=n}idleColor({bgAlpha:e=this.buttonIdleAlpha,brdColor:t=this.buttonBorderColor,brdAlpha:i=this.buttonBorderAlpha,bgColor:s=this.buttonIdleColor,txtColor:r=this.textColor,iconColor:o=this.iconColor,iconAlpha:n=this.iconIdleAlpha}={}){this.color({bgAlpha:e,brdAlpha:i,brdColor:t,bgColor:s,txtColor:r,iconColor:o,iconAlpha:n})}hoverColor({bgAlpha:e=this.buttonHoverAlpha,brdColor:t=this.buttonBorderHoverColor,brdAlpha:i=this.buttonBorderHoverAlpha,bgColor:s=this.buttonHoverColor,txtColor:r=this.textColorHover,iconColor:o=this.iconColorHover,iconAlpha:n=this.iconHoverAlpha}={}){this.color({bgAlpha:e,brdAlpha:i,brdColor:t,bgColor:s,txtColor:r,iconColor:o,iconAlpha:n})}selectedColor({bgAlpha:e=this.buttonSelectedAlpha,brdColor:t=this.buttonBorderSelectedColor,brdAlpha:i=this.buttonBorderSelectedAlpha,bgColor:s=this.buttonSelectedColor,txtColor:r=this.textColorSelected,iconColor:o=this.iconColorSelected,iconAlpha:n=this.iconSelectedAlpha}={}){this.color({bgAlpha:e,brdAlpha:i,brdColor:t,bgColor:s,txtColor:r,iconColor:o,iconAlpha:n})}disabledColor({bgAlpha:e=this.buttonDisabledAlpha,brdColor:t=this.buttonBorderDisabledColor,brdAlpha:i=this.buttonBorderDisabledAlpha,bgColor:s=this.buttonDisabledColor,txtColor:r=this.textColorDisabled,iconColor:o=this.iconColorDisabled,iconAlpha:n=this.iconDisabledAlpha}={}){this.color({bgAlpha:e,brdAlpha:i,brdColor:t,bgColor:s,txtColor:r,iconColor:o,iconAlpha:n})}setSelected(e){this.selected=e,this.selected?this.selectedColor():this.idleColor()}setDisabled(e){this.disabled=e,this.disabled?this.selectedColor():this.idleColor()}updateState(e=!1){this.disabled?this.disabledColor():e?this.hoverColor():this.selected?this.selectedColor():this.idleColor()}}t.Button=r},76566:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const s=i(58687);class r extends s.Graphics{constructor(e){super(),this.game=e.game,this.draw(e),"number"==typeof e.initY&&(this.position.y=e.initY)}draw({viewWidth:e,viewHeight:t}){this.clear(),this.beginFill(16777215),this.drawRect(0,0,e,t),this.endFill()}handleUpdate(e){}handleResize({viewWidth:e,viewHeight:t}){const{gridSize:i,background:{width:s,height:r}}=this.game.tileMap,o=s+2*i,n=r+2*i;this.draw({viewWidth:e>o?o:e,viewHeight:t>n?n:t})}getCameraBounds(){const{width:e,height:t}=this,{scale:{x:i,y:s},pivot:{x:r,y:o}}=this.game.tileMap;return{top:o,right:r+e/i,bottom:o+t/s,left:r}}getCameraGridBounds(){const{top:e,right:t,bottom:i,left:s}=this.getCameraBounds(),{gridSize:r}=this.game.tileMap;return{topGridY:Math.floor(e/r),bottomGridY:Math.floor(i/r),leftGridX:Math.floor(s/r),rightGridX:Math.floor(t/r)}}}r.options={scrollEdge:100},t.Camera=r},42930:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommandsBar=void 0;const s=i(58687),r=i(53555),o=i(42097),n=i(16445),a=i(39618),h=i(22591),d=i(9498),l=i(54536),c=i(41759),u=i(33244),m=i(22273),p=i(30332),g=i(60231);class w extends s.Container{static prepareTextures({textures:e}){w.textures=e,w.commandsDic={[n.ECommandName.deselect]:{iconTexture:e.iconDeselectTexture,text:"deselect",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.moveFollow]:{iconTexture:e.iconMoveFollowTexture,text:"move\nfollow",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.attack]:{iconTexture:e.iconAttackTexture,text:"attack",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.attackGuard]:{iconTexture:e.iconAttackGuardTexture,text:"attack\nguard",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.patrol]:{iconTexture:e.iconPatrolTexture,text:"patrol",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.buildTurret]:{iconTexture:e.iconBuildTurretTexture,text:`Turret\n${l.GroundTurret.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.buildStarport]:{iconTexture:e.iconBuildStarportTexture,text:`Starport\n${c.Starport.cost}`,iconWidth:36,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:10},[n.ECommandName.deploy]:{iconTexture:e.iconDeployTexture,text:"deploy",iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.constructSCV]:{iconTexture:e.iconConstructSCVTexture,text:`SCV\n${h.SCV.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.constructHarvester]:{iconTexture:e.iconConstructHarvesterTexture,text:`Harvester\n${d.Harvester.cost}`,iconWidth:30,iconHeight:30,iconPaddingTop:12,iconPaddingLeft:12},[n.ECommandName.constructScoutTank]:{iconTexture:e.iconConstructScoutTankTexture,text:`Scout Tank\n${u.ScoutTank.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.constructHeavyTank]:{iconTexture:e.iconConstructHeavyTankTexture,text:`Heavy Tank\n${m.HeavyTank.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.constructChopper]:{iconTexture:e.iconConstructChopperTexture,text:`Chopper\n${p.Chopper.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8},[n.ECommandName.constructWraith]:{iconTexture:e.iconConstructWraithTexture,text:`Wraith\n${g.Wraith.cost}`,iconWidth:40,iconHeight:40,iconPaddingTop:8,iconPaddingLeft:8}}}constructor(e){super(),this.commandTiles=new s.Container,this.commandNames=[],this.calcClickHandler=e=>{switch(e){case n.ECommandName.moveFollow:return()=>{this.deselectTiles(n.ECommandName.moveFollow)};case n.ECommandName.attack:return()=>{this.deselectTiles(n.ECommandName.attack)};case n.ECommandName.attackGuard:return()=>{this.deselectTiles(n.ECommandName.attackGuard)};case n.ECommandName.patrol:return()=>{this.deselectTiles(n.ECommandName.patrol)};case n.ECommandName.deselect:return()=>{this.deselectTiles(),this.game.clearSelection(!0)};case n.ECommandName.buildTurret:return e=>{this.deselectTiles(n.ECommandName.buildTurret)};case n.ECommandName.buildStarport:return e=>{this.deselectTiles(n.ECommandName.buildStarport)};case n.ECommandName.deploy:return e=>{this.deselectTiles(n.ECommandName.deploy)};case n.ECommandName.constructSCV:return()=>{this.deselectTiles(n.ECommandName.constructSCV),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructSCV)&&(e.order={type:"construct-unit",name:o.EItemName.SCV})}))};case n.ECommandName.constructHarvester:return()=>{this.deselectTiles(n.ECommandName.constructHarvester),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructHarvester)&&(e.order={type:"construct-unit",name:o.EItemName.Harvester})}))};case n.ECommandName.constructScoutTank:return()=>{this.deselectTiles(n.ECommandName.constructScoutTank),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructScoutTank)&&(e.order={type:"construct-unit",name:o.EItemName.ScoutTank})}))};case n.ECommandName.constructHeavyTank:return()=>{this.deselectTiles(n.ECommandName.constructHeavyTank),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructHeavyTank)&&(e.order={type:"construct-unit",name:o.EItemName.HeavyTank})}))};case n.ECommandName.constructChopper:return()=>{this.deselectTiles(n.ECommandName.constructChopper),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructChopper)&&(e.order={type:"construct-unit",name:o.EItemName.Chopper})}))};case n.ECommandName.constructWraith:return()=>{this.deselectTiles(n.ECommandName.constructWraith),this.game.selectedItems.forEach((e=>{e.commands.includes(n.ECommandName.constructWraith)&&(e.order={type:"construct-unit",name:o.EItemName.Wraith})}))}}},this.game=e.game,this.setup()}setup(){this.addChild(this.commandTiles)}prepareCommands(e){const t=new Set([n.ECommandName.deselect]);if(1===e.length){const i=e[0];return i.team===this.game.team&&i.commands.forEach((e=>t.add(e))),this.drawCommands([...t.values()])}const i=e.some((e=>e.type===o.EItemType.vehicles||e.type===o.EItemType.airVehicles));return e.forEach((e=>{e.team===this.game.team&&(i&&(e.type===o.EItemType.vehicles||e.type===o.EItemType.airVehicles)&&t.size<5||e.type===o.EItemType.buildings)&&e.commands.forEach((e=>t.add(e)))})),this.drawCommands([...t.values()])}clearCommandTiles(){for(;this.commandTiles.children.length>0;)this.commandTiles.children[0].removeFromParent()}deselectTiles(e){this.commandTiles.children.forEach((t=>{t.commandName===e?t.setSelected(!0):t.setSelected(!1)}))}getSelectedCommandName(){const e=this.commandTiles.children.find((e=>e.selected));return null!=e?e.commandName:void 0}drawCommands(e){return!(0,r.compareArrays)(this.commandNames,e)&&(this.clearCommandTiles(),this.commandNames=e,this.commandNames.forEach((e=>{const t=w.commandsDic[e],i=new f({commandName:e,buttonRadius:3,iconIdleAlpha:.3,iconHoverAlpha:.4,textPaddingLeft:0,textPaddingTop:8,buttonWidth:60,fontSize:10,textColor:16777215,textColorHover:16776960,iconColor:16777215,iconColorHover:16776960,shadowTextColor:8388736,shadowThickness:1,buttonHoverColor:4539717,buttonIdleColor:4539717,flexDirection:"col-center",buttonBorderWidth:2,buttonBorderColor:1578774,buttonBorderHoverColor:16776960,...t,onClick:this.calcClickHandler(e)});i.position.set(0,this.commandTiles.height),this.commandTiles.addChild(i)})),!0)}}w.commandsDic={},t.CommandsBar=w;class f extends a.Button{constructor(e){super(e),this.commandName=e.commandName}}},94973:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LifeBar=void 0;const s=i(58687);class r extends s.Container{constructor(e){super(),this.borderThickness=e.borderThickness,this.setup()}setup(){this.borderBox=new s.Graphics,this.addChild(this.borderBox);const e=new s.Container;this.addChild(e),this.bars=e,this.emptyBar=new s.Graphics,e.addChild(this.emptyBar);const t=new s.Graphics;e.addChild(t),this.fillBar=t}draw({borderColor:e,borderAlpha:t,fillColor:i,emptyColor:s,width:r,height:o,borderThickness:n}){const{borderBox:a,fillBar:h,emptyBar:d}=this;a.beginFill(e),a.drawRect(0,0,r,o),a.endFill(),a.alpha=t,this.bars.position.set(n,n),d.beginFill(s),d.drawRect(0,0,r-2*n,o-2*n),d.endFill(),h.beginFill(i),h.drawRect(0,0,r-2*n,o-2*n),h.endFill()}updateLife(e){this.fillBar.width=(this.emptyBar.width-this.borderThickness)*e}}t.LifeBar=r},9563:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MiniMap=void 0;const s=i(58687),r=i(36645),o=i(53555),n=i(42097);class a extends s.Graphics{}class h extends s.Graphics{}class d extends s.Container{}class l extends s.Container{}class c extends s.Sprite{}class u extends s.Graphics{}class m extends s.Graphics{}class p extends s.Container{constructor(e){super(),this.rebuildRequired=!0,this.pointerDownX=-1,this.pointerDownY=-1,this.border=new a,this.borderContainer=new d,this.backgroundContainer=new l,this.background=new c,this.background2=new c,this.sightMini=new m,this.cameraRect=new h,this.activeItemsMini=new u,this.handlePointerDown=e=>{if(this.game.gameEnded)return;const t=this.background.toLocal(e);this.pointerDownX=t.x,this.pointerDownY=t.y,(0,r.logPointerEvent)(`MiniMap pdX=${this.pointerDownX} pdX=${this.pointerDownY} down`),this.pointerDownX>-1&&this.pointerDownY>-1&&(t.x>=this.cameraRect.x&&t.x<=this.cameraRect.x+this.cameraRect.width&&t.y>=this.cameraRect.y&&t.y<=this.cameraRect.y+this.cameraRect.height||this.game.tileMap.goTo(t))},this.handlePointerUp=e=>{this.game.gameEnded||(this.pointerDownX=this.pointerDownY=-1,(0,r.logPointerEvent)(`MiniMap pdX=${this.pointerDownX} pdX=${this.pointerDownY} up`))},this.handlePointerMove=e=>{if(!this.game.gameEnded&&this.pointerDownX>-1&&this.pointerDownY>-1){const t=this.background.toLocal(e);(0,r.logPointerEvent)(`MiniMap pdX=${this.pointerDownX} pdX=${this.pointerDownY} mX=${t.x} mY=${t.y}`),this.game.tileMap.goDiff({diffX:t.x-this.pointerDownX,diffY:t.y-this.pointerDownY}),this.pointerDownX=t.x,this.pointerDownY=t.y}},this.handlePointerLeave=e=>{this.game.gameEnded||(this.pointerDownX=this.pointerDownY=-1,(0,r.logPointerEvent)(`Game pdX=${this.pointerDownX} pdX=${this.pointerDownY} up`))},this.game=e.game,this.initWidth=e.initWidth,this.initHeight=e.initHeight,this.setup(),this.draw(),this.addEventLesteners()}setup(){this.addChild(this.border),this.addChild(this.borderContainer),this.borderContainer.addChild(this.backgroundContainer);const{borderWidth:e}=p.options;this.borderContainer.position.set(e,e),this.backgroundContainer.addChild(this.background),this.background.alpha=.3,this.backgroundContainer.addChild(this.background2),this.backgroundContainer.addChild(this.activeItemsMini),this.backgroundContainer.addChild(this.cameraRect),this.backgroundContainer.addChild(this.sightMini)}draw(){const{initWidth:e,initHeight:t}=this,{borderColor:i,backgroundColor:s,borderWidth:r}=p.options;this.border.beginFill(i),this.border.drawRect(0,0,e,t),this.border.endFill(),this.border.beginFill(s),this.border.drawRect(r,r,e-2*r,t-2*r),this.border.endFill()}addEventLesteners(){this.backgroundContainer.eventMode="static",this.backgroundContainer.on("pointerdown",this.handlePointerDown),this.backgroundContainer.on("pointerup",this.handlePointerUp),this.backgroundContainer.on("pointermove",this.handlePointerMove),this.backgroundContainer.on("pointerleave",this.handlePointerLeave),this.activeItemsMini.interactiveChildren=!1}assignBackgroundTexture({texture:e}){this.background.texture=e,this.background2.texture=e,this.fit({texture:e}),this.drawCameraRect(),this.updateCameraRect()}handleUpdate(e){this.updateCameraRect(),this.updateItems()}handleResize(e){this.drawCameraRect(),this.updateCameraRect()}fit({texture:e}){const{gridSize:t}=this.game.tileMap,{initWidth:i,initHeight:s}=this,{borderWidth:r}=p.options,{width:o,height:n}=e,a=i-2*r,h=s-2*r;let d=1;const l=o+2*t,c=n+2*t;d=l>=c?a/l:h/c,this.borderContainer.scale.set(d);const u=a/this.borderContainer.scale.x,m=h/this.borderContainer.scale.y,g=u>o?(u-o)/2:0,w=m>n?(m-n)/2:0;this.backgroundContainer.x=g,this.backgroundContainer.y=w}drawCameraRect(){const{cameraRectColor:e,cameraRectThickness:t}=p.options;this.cameraRect.clear(),this.cameraRect.beginFill(e);const{width:i,height:s}=this.game.camera,{scale:{x:r,y:o}}=this.game.tileMap,n=i/r,a=s/o,{scale:{x:h,y:d}}=this.borderContainer,l=t/h,c=t/d;this.cameraRect.drawRect(0,0,n,a),this.cameraRect.endFill(),this.cameraRect.beginHole(),this.cameraRect.drawRect(l,c,n-2*l,a-2*c),this.cameraRect.endHole()}updateCameraRect(){const{x:e,y:t}=this.game.tileMap.pivot;this.cameraRect.position.set(e,t)}updateItems(){this.rebuildRequired&&this.drawItems()}getItemColor(e){const{itemBlueTeamClor:t,itemGreeTeamClor:i,itemBlueTeamAttackClor:s,itemGreenTeamAttackClor:r}=p.options;return"attack"===e.order.type?e.team===o.Team.blue?s:r:e.team===o.Team.blue?t:i}drawItems(){const{activeItemsMini:e,background2:t,sightMini:i}=this,{activeItems:s,gridSize:o}=this.game.tileMap;e.clear(),i.clear();for(let t=0;t<s.children.length;t++){const a=s.children[t];if(!a.renderable)continue;e.beginFill(this.getItemColor(a));const h=a.getCollisionBounds(),d=a.getCollisionPosition({center:!0});a.type===n.EItemType.buildings?e.drawRect(h.left,h.top,h.right-h.left,h.bottom-h.top):a.type!==n.EItemType.vehicles&&a.type!==n.EItemType.airVehicles||e.drawCircle(d.x,d.y,Math.max(a.collisionGraphics.width,a.collisionGraphics.height)/2),r.logNoFog.enabled||a.team!==this.game.team||(i.beginFill(16777215),i.drawCircle(d.x,d.y,a.sightRadius*o),i.endFill()),e.endFill()}r.logNoFog.enabled||(t.mask=i)}}p.options={borderColor:4539717,backgroundColor:4741996,borderWidth:2,cameraRectColor:12690711,cameraRectThickness:2,itemBlueTeamClor:255,itemBlueTeamAttackClor:16711680,itemGreeTeamClor:65280,itemGreenTeamAttackClor:16711680},t.MiniMap=p},33959:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReloadBar=void 0;const s=i(58687);class r extends s.Container{constructor(e){super(),this.setup()}setup(){const e=new s.Graphics;this.addChild(e),this.fillBar=e}draw({fillColor:e,width:t,height:i,alpha:s}){this.maxWidth=t;const{fillBar:r}=this;r.beginFill(e),r.drawRect(0,0,t,i),r.endFill(),r.alpha=s}updateReload(e){this.fillBar.width=this.maxWidth*e}}t.ReloadBar=r},48599:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsModal=void 0;const s=i(58687),r=i(39618),o=i(36645);class n extends r.Button{}class a extends s.Graphics{}class h extends s.Graphics{}class d extends s.Container{constructor(e){super(),this.dragStartX=-1,this.bar=new a,this.caret=new h,this.onPointerDown=e=>{this.dragStartX=this.bar.toLocal(e).x},this.onPointerMove=e=>{if(this.dragStartX>-1){const t=this.bar.toLocal(e).x,i=t-this.dragStartX;this.caret.position.x+=i,this.dragStartX=t,this.checkCaretLimits(),this.triggerChangeEvent()}},this.onPointerUp=e=>{this.dragStartX=-1,this.setCaretCenter(this.bar.toLocal(e).x),this.checkCaretLimits(),this.triggerChangeEvent()},this.onChange=e.onChange,this.setup(),this.draw(e),this.setupEventListeners()}setup(){this.addChild(this.bar),this.addChild(this.caret)}draw({width:e}){const{barBorderColor:t,barHeight:i,barRadius:s,barColor:r,barBorderWidth:o,caretRadius:n,caretBorderColor:a,caretBorderWidth:h,caretColor:l}=d.options,{bar:c,caret:u}=this;c.beginFill(t),c.drawRoundedRect(0,0,e,i,s),c.endFill(),c.beginFill(r);const m=i-2*o;c.drawRoundedRect(o,o,e-2*o,m,s),c.endFill();const p=o+.5*m,g=o+.5*m;u.position.set(p-n,g-n),u.beginFill(a),u.drawCircle(n,n,n),u.endFill(),u.beginFill(l),u.drawCircle(n,n,n-h),u.endFill()}setupEventListeners(){this.eventMode="static",this.on("pointerdown",this.onPointerDown),this.on("pointermove",this.onPointerMove),this.on("pointerup",this.onPointerUp),this.on("pointerupoutside",this.onPointerUp)}getCaretCenter(){return this.caret.position.x+d.options.caretRadius}setCaretCenter(e){this.caret.position.x=e-d.options.caretRadius}calcCaretLimits(){const{width:e}=this.bar,{barHeight:t,barBorderWidth:i}=d.options,s=i+(t-2*i)/2;return{min:s,max:e-s}}checkCaretLimits(){const e=this.getCaretCenter(),{min:t,max:i}=this.calcCaretLimits();e<t?this.setCaretCenter(t):e>i&&this.setCaretCenter(i)}triggerChangeEvent(){const e=this.getCaretCenter(),{min:t,max:i}=this.calcCaretLimits();this.onChange((e-t)/(i-t))}updateCaretCenter(e){const{min:t,max:i}=this.calcCaretLimits();this.setCaretCenter(t+(i-t)*e)}}d.options={barRadius:3,barHeight:10,barColor:16777215,barBorderColor:1578774,barBorderWidth:3,caretRadius:18,caretColor:8388736,caretBorderColor:4539717,caretBorderWidth:3};class l extends s.Container{static prepareTextures({textures:e}){l.textures=e}constructor(e){var t;super(),this.resizeTimeoutId=0,this.onChanged=e.onChanged,this.volume=null!==(t=e.volume)&&void 0!==t?t:0,this.setup(e),this.updateTexture(),this.slider.updateCaretCenter(this.volume)}setup({text:e}){const{minVolume:t,maxVolume:i,slider:s,volumeButton:{offset:r,textColor:o,textColorHover:a,textPaddingLeft:h,textPaddingTop:c,iconScale:u,iconColor:m,iconColorHover:p,iconPaddingLeft:g,iconPaddingTop:w,buttonRadius:f,buttonHeight:b,buttonIdleAlpha:y,buttonHoverAlpha:x,buttonSelectedAlpha:T}}=l.options;this.volumeButton=new n({text:e,textColor:o,textColorHover:a,textPaddingLeft:h,textPaddingTop:c,iconTexture:l.textures.iconVolumeHighTexture,iconScale:u,iconColor:m,iconColorHover:p,onClick:()=>{this.volume=this.volume>t?t:i,this.updateTexture(),this.slider.updateCaretCenter(this.volume),this.triggerDeBounce()},iconPaddingLeft:g,iconPaddingTop:w,buttonRadius:f,buttonHeight:b,buttonIdleAlpha:y,buttonHoverAlpha:x,buttonSelectedAlpha:T}),this.volumeButton.position.set(r.x,r.y),this.addChild(this.volumeButton),this.slider=new d({width:s.width,onChange:e=>{this.volume=e,this.updateTexture(),this.triggerDeBounce()}}),this.slider.position.set(s.offset.x,s.offset.y),this.addChild(this.slider)}limitVolume(){const{maxVolume:e,minVolume:t}=l.options;this.volume>e?this.volume=e:this.volume<t&&(this.volume=t)}updateTexture(){this.limitVolume();const{iconVolumeOffTexture:e,iconVolumeLowTexture:t,iconVolumeMiddleTexture:i,iconVolumeHighTexture:s}=l.textures,{minVolume:r,lowVolume:o,middleVolume:n}=l.options,{icon:a}=this.volumeButton;this.volume===r?a.texture=e:this.volume<=o?a.texture=t:this.volume<=n?a.texture=i:a.texture=s}triggerDeBounce(){this.cancelScheduledTriggerHandler(),this.scheduleTriggerHandler()}cancelScheduledTriggerHandler(){clearTimeout(this.resizeTimeoutId)}scheduleTriggerHandler(){this.resizeTimeoutId=window.setTimeout((()=>{this.cancelScheduledTriggerHandler(),this.triggerOnChanged()}),l.triggerTimeout)}triggerOnChanged(){"function"==typeof this.onChanged&&this.onChanged(this.volume)}}l.options={minVolume:0,lowVolume:.3,middleVolume:.7,maxVolume:1,volumeButton:{textColor:16777215,textColorHover:16776960,textPaddingLeft:15,textPaddingTop:12,iconScale:.5,iconColor:16777215,iconColorHover:16776960,iconPaddingLeft:10,iconPaddingTop:10,buttonRadius:3,buttonHeight:50,buttonIdleAlpha:0,buttonHoverAlpha:0,buttonSelectedAlpha:0,offset:{x:50,y:0}},slider:{width:300,offset:{x:5,y:50}}},l.triggerTimeout=200;class c extends s.Graphics{}class u extends s.Container{}class m extends r.Button{}class p extends r.Button{}class g extends s.Text{}class w extends s.Container{static prepareTextures({textures:e}){w.textures=e,l.prepareTextures({textures:e})}constructor(e){super(),this.audio=e.audio,this.onClosed=e.onClosed,this.setup(e),this.draw(e)}setup(e){this.modalBox=new c,this.addChild(this.modalBox);const{fontFamily:t,fontSize:i,fontWeight:s,fill:r,align:o,shadowTextColor:n,shadowThickness:a,offset:h}=w.headerTextOptions;this.headerText=new g("Settings",{fontFamily:t,fontSize:i,fontWeight:s,fill:r,align:o,stroke:n,strokeThickness:a}),this.headerText.position.set(h.x,h.y),this.addChild(this.headerText);const{voiceLine:d,shootLine:m,hitLine:p,messageLine:f}=w.volumeLinesOptions;this.voiceVolumeFormLine=new l({...w.textures,volume:this.audio.voiceVolume,text:"Voice volume",onChanged:e=>{this.audio.voiceVolume=e,this.audio.playRandomVoice()}}),this.voiceVolumeFormLine.position.set(d.offset.x,d.offset.y),this.addChild(this.voiceVolumeFormLine),this.shootVolumeFormLine=new l({...w.textures,volume:this.audio.shootVolume,text:"Shoot volume",onChanged:e=>{this.audio.shootVolume=e,this.audio.playRandomShoot()}}),this.shootVolumeFormLine.position.set(m.offset.x,m.offset.y),this.addChild(this.shootVolumeFormLine),this.hitVolumeFormLine=new l({...w.textures,volume:this.audio.hitVolume,text:"Hit volume",onChanged:e=>{this.audio.hitVolume=e,this.audio.playRandomHit()}}),this.hitVolumeFormLine.position.set(p.offset.x,p.offset.y),this.addChild(this.hitVolumeFormLine),this.messageVolumeFormLine=new l({...w.textures,volume:this.audio.messageVolume,text:"Message volume",onChanged:e=>{this.audio.messageVolume=e,this.audio.playRandomMessage()}}),this.messageVolumeFormLine.position.set(f.offset.x,f.offset.y),this.addChild(this.messageVolumeFormLine),this.buttons=new u,this.addChild(this.buttons)}draw(e){const{boxOptions:{width:t,height:i,backgroundColor:s,outerBorderWidth:r,outerBorderColor:o,borderRadius:n}}=w;let a=0,h=0,d=t,l=i;this.modalBox.beginFill(s),this.modalBox.drawRoundedRect(a,h,d,l,n),this.modalBox.endFill(),a+=r,h+=r,d-=2*r,l-=2*r,this.modalBox.beginFill(o),this.modalBox.drawRoundedRect(a,h,d,l,n),this.modalBox.endFill();const{iconCircleXMarkTexture:c,iconCircleCheckTexture:u}=w.textures,{leftTwo:g,top:f,fillSuccess:b,fillError:y,widthLeft:x,widthRight:T,iconPaddingTop:v,textPaddingTop:C,paddingLeft:S,iconScale:M,height:k,twoPaddingLeft:A,buttonBorderColor:E,buttonBorderHoverColor:I,buttonBorderWidth:Y}=w.buttonOptions,{textSize:P,textColor:B,textColorHover:G}=w.buttonTextOptions,X=new m({text:"Cancel",fontSize:P,textColor:B,textColorHover:G,iconColor:B,iconColorHover:G,iconTexture:c,iconScale:M,iconPaddingLeft:S,iconPaddingTop:v,textPaddingLeft:S,textPaddingTop:C,buttonHeight:k,buttonRadius:n,buttonIdleColor:y,buttonWidth:x,buttonBorderColor:E,buttonBorderHoverColor:I,buttonBorderWidth:Y,initX:g,initY:f,onClick:()=>{this.audio.resetAll(),this.hideModal(),this.onClosed()}});this.buttons.addChild(X),this.buttonLeft=X;const R=new p({text:"Apply",fontSize:P,textColor:B,textColorHover:G,iconColor:B,iconColorHover:G,iconTexture:u,iconScale:M,iconPaddingLeft:S,iconPaddingTop:v,textPaddingLeft:S,textPaddingTop:C,buttonIdleColor:b,buttonWidth:T,buttonHeight:k,buttonRadius:n,buttonBorderColor:E,buttonBorderHoverColor:I,buttonBorderWidth:Y,initX:g+x+A,initY:f,onClick:()=>{this.audio.saveAll(),this.hideModal(),this.onClosed()}});this.buttons.addChild(R),this.buttonRight=R}showModal(){this.visible=!0}hideModal(){this.visible=!1}handleUpdate(e){}handleResize({viewWidth:e,viewHeight:t}){const i=e,s=t,{width:r,height:n}=w.boxOptions,a=r,h=n;let d=1;h>=a?s<h&&(d=s/h,d*a>i&&(d=i/a),(0,o.logLayout)(`Settings Modal by height (sc=${d})`)):i<a&&(d=i/a,d*h>s&&(d=s/h),(0,o.logLayout)(`Settings Modal by width (sc=${d})`));const l=Math.floor(a*d),c=Math.floor(h*d),u=i>l?(i-l)/2:0,m=s>c?(s-c)/2:0;(0,o.logLayout)(`aw=${i} (ow=${l}) x=${u} ah=${s} (oh=${c}) y=${m}`),this.x=u,this.width=l,this.y=m,this.height=c,(0,o.logLayout)(`x=${u} y=${m} w=${this.width} h=${this.height}`)}}w.boxOptions={backgroundColor:4539717,outerBorderColor:4741996,outerBorderWidth:3,width:350,height:500,borderRadius:5},w.headerTextOptions={fontFamily:"'Courier New', Courier, monospace",fontSize:24,fontWeight:"bold",fill:16777215,align:"center",shadowTextColor:8388736,shadowThickness:1,offset:{x:110,y:25}},w.volumeLinesOptions={voiceLine:{offset:{x:20,y:80}},shootLine:{offset:{x:20,y:160}},hitLine:{offset:{x:20,y:240}},messageLine:{offset:{x:20,y:320}}},w.buttonOptions={top:430,leftTwo:15,paddingLeft:12,twoPaddingLeft:20,iconPaddingTop:10,textPaddingTop:16,widthLeft:150,widthRight:150,height:55,fillRegular:4539717,fillError:10105874,fillSuccess:2278750,borderRadius:10,iconScale:.7,buttonBorderColor:4741996,buttonBorderHoverColor:16776960,buttonBorderWidth:1},w.buttonTextOptions={top:95,textColor:16777215,textSize:20,textColorHover:16776960},t.SettingsModal=w},65400:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SideBar=void 0;const s=i(58687),r=i(42930),o=i(36645),n=i(39618);class a extends s.Container{constructor(e){var t;super(),this.toX=0,this.toOpen=!1,this.toClose=!1,this.opened=!1,this.closed=!0,this.game=e.game,this.viewWidth=e.viewWidth,this.align=null!==(t=e.align)&&void 0!==t?t:"left",this.setup(e),this.drawStaticContent(),this.drawMask(),this.setAlignment()}setup(e){this.staticContent=new s.Container,this.addChild(this.staticContent),this.hideableContent=new s.Container,this.addChild(this.hideableContent),this.commandsBar=new r.CommandsBar({game:e.game}),this.hideableContent.addChild(this.commandsBar),this.contentMask=new s.Graphics,this.addChild(this.contentMask),"number"==typeof e.initY&&(this.position.y=e.initY)}setAlignment(){"left"===this.align?this.position.x=0:this.position.x=this.viewWidth-this.width}setHideableContentPosition(){this.closed?("left"===this.align?this.hideableContent.position.x=-this.width:this.hideableContent.position.x=this.width,(0,o.logSideBar)(`closed hideable-${this.align} ${this.hideableContent.position.x}`)):this.opened&&("left"===this.align?this.hideableContent.position.x=this.width>this.hideableContent.width?this.width-this.hideableContent.width:0:this.hideableContent.position.x=0,(0,o.logSideBar)(`opened hideable-${this.align} ${this.hideableContent.position.x}`))}calcHideableContentPosition({forceOpen:e=!1,forceClose:t=!1}={}){e?("left"===this.align?this.toX=this.width>this.hideableContent.width?this.width-this.hideableContent.width:0:this.toX=0,(0,o.logSideBar)(`force open hideable-${this.align} toX=${this.toX}`)):t&&("left"===this.align?this.toX=-this.width:this.toX=this.width,(0,o.logSideBar)(`force close hideable-${this.align} toX=${this.toX}`))}getToggleText(){return`${"left"===this.align?">>>":"<<<"}\ncash:\n${this.game.cash[this.game.team]}`}drawStaticContent(){this.toggleButton=new n.Button({text:this.getToggleText(),fontSize:16,textColor:16777215,textColorHover:16776960,shadowTextColor:8388736,shadowThickness:1,buttonWidth:a.options.initWidth,buttonBorderHoverColor:16776960,buttonHoverColor:4539717,buttonIdleColor:4539717,buttonSelectedColor:4539717,buttonBorderWidth:2,buttonBorderColor:1578774,onClick:()=>{this.align="left"===this.align?"right":"left",this.setAlignment(),this.setHideableContentPosition(),this.calcHideableContentPosition({forceOpen:this.toOpen,forceClose:this.toClose})}}),this.staticContent.addChild(this.toggleButton)}drawMask({height:e}={}){const{initWidth:t,initHeight:i}=a.options;this.contentMask.clear(),this.contentMask.beginFill(16777215),this.contentMask.drawRect(0,0,Math.max(t,this.width),null!=e?e:i),this.contentMask.endFill(),this.contentMask.position.set(0,this.staticContent.height),this.hideableContent.position.set(0,this.staticContent.height),this.hideableContent.mask=this.contentMask}handleResize({viewWidth:e,initY:t}){this.viewWidth=e,this.position.y=t}handleUpdate(e){this.toggleButton.text.text=this.getToggleText();const t="left"===this.align;this.toOpen?((0,o.logSideBar)(`update-to-open (${this.hideableContent.position.x}) toX=${this.toX}`),(t?this.hideableContent.position.x>this.toX-.1:this.hideableContent.position.x<this.toX+.1)?(this.hideableContent.position.x=this.toX,this.toOpen=!1,this.opened=!0,this.closed=!1):t?this.hideableContent.position.x+=.1*(this.toX-this.hideableContent.position.x):this.hideableContent.position.x-=.1*(this.hideableContent.position.x-this.toX)):this.toClose&&((0,o.logSideBar)(`update-to-close (${this.hideableContent.position.x}) toX=${this.toX}`),(t?this.hideableContent.position.x<this.toX+.1:this.hideableContent.position.x>this.toX-.1)?(this.hideableContent.position.x=this.toX,this.toClose=!1,this.opened=!1,this.closed=!0):t?this.hideableContent.position.x-=.1*(this.hideableContent.position.x-this.toX):this.hideableContent.position.x+=.1*(this.toX-this.hideableContent.position.x))}handleSelectedItems(e){if((0,o.logSideBar)(`handleSelectedItems (${e.length}) opened=${this.opened} toOpen=${this.toOpen} toClose=${this.toClose}`),e.length>0){const t=this.commandsBar.prepareCommands(e);(t||0===this.commandsBar.commandTiles.children.length)&&this.drawMask({height:this.commandsBar.height}),(!this.opened&&!this.toOpen||t)&&this.open()}else(!this.closed||this.opened&&!this.toClose||!this.opened&&this.toOpen)&&this.close(),this.commandsBar.deselectTiles()}open(){(0,o.logSideBar)("open()"),this.toOpen=!0,this.toClose=!1,this.setHideableContentPosition(),this.calcHideableContentPosition({forceOpen:!0})}close(){(0,o.logSideBar)("close()"),this.toOpen=!1,this.toClose=!0,this.setHideableContentPosition(),this.calcHideableContentPosition({forceClose:!0})}}a.options={initWidth:70,initHeight:300},t.SideBar=a},75171:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StartModal=void 0;const s=i(58687),r=i(39618),o=i(9127);class n extends s.Graphics{}class a extends s.Text{}class h extends s.Container{}class d extends s.Container{static prepareTextures({textures:e}){d.textures=e}constructor(e){super(),this.sucess=!1,this.elapsedSpawnFrames=0,this.spawnFrame=Math.floor(20*Math.random()+60),this.particles=new s.ParticleContainer(300,{position:!0,scale:!0,tint:!0}),this.boxOptions={backgroundColor:4539717,outerBorderColor:4741996,outerBorderWidth:3,width:350,height:250,borderRadius:5},this.reasonTextOptions={top:-50,textColor:12690711,strokeColor:8388736,strokeThickness:1,textSize:20,fontWeight:"bold",lineHeight:30},this.buttonOptions={top:170,leftOne:105,leftTwo:15,paddingLeft:20,paddingTop:15,widthOne:150,widthLeft:150,widthRight:150,height:50,fillRegular:4539717,fillError:10105874,fillSuccess:2278750,borderRadius:10,iconScale:.5},this.buttonTextOptions={top:95,textColor:16777215,textSize:20,textColorHover:16776960},this.setup(e),this.draw(e)}setup(e){this.modalBox=new n,this.addChild(this.modalBox);const{boxOptions:t,reasonTextOptions:i}=this;this.reasonText=new a("-",{fontSize:i.textSize,fill:i.textColor,fontWeight:i.fontWeight,fontFamily:"'Courier New', Courier, monospace",align:"center",wordWrap:!0,wordWrapWidth:t.width-2*t.outerBorderWidth,stroke:i.strokeColor,strokeThickness:i.strokeThickness,lineHeight:i.lineHeight}),this.reasonText.anchor.set(.5,.5),this.reasonText.position.set(t.width/2,t.height/2+i.top),this.addChild(this.reasonText),this.dynamicContent=new h,this.addChild(this.dynamicContent)}draw(e){const{boxOptions:{width:t,height:i,backgroundColor:s,outerBorderWidth:r,outerBorderColor:o,borderRadius:n}}=this;let a=0,h=0,d=t,l=i;this.modalBox.beginFill(s),this.modalBox.drawRoundedRect(a,h,d,l,n),this.modalBox.endFill(),a+=r,h+=r,d-=2*r,l-=2*r,this.modalBox.beginFill(o),this.modalBox.drawRoundedRect(a,h,d,l,n),this.modalBox.endFill()}showModal({message:e,success:t,view:i,onLeftClick:s,onRightClick:o}){this.cleanFromAll();const{iconHomeTexture:n,iconNextTexture:a,iconRepeatTexture:h}=d.textures,{leftOne:l,leftTwo:c,top:u,fillRegular:m,fillSuccess:p,fillError:g,widthOne:w,widthLeft:f,widthRight:b,height:y,borderRadius:x,paddingTop:T,paddingLeft:v,iconScale:C}=this.buttonOptions,{textSize:S,textColor:M,textColorHover:k}=this.buttonTextOptions;this.sucess=t,this.visible=!0,this.reasonText.text=e;const A={text:"Home",fontSize:S,textColor:M,textColorHover:k,iconColor:M,iconColorHover:k,onClick:s,iconTexture:n,iconScale:C,iconPaddingLeft:v,iconPaddingTop:T,textPaddingLeft:v,textPaddingTop:T,buttonHeight:y,buttonRadius:x},E={text:"",fontSize:S,textColor:M,textColorHover:k,iconColor:M,iconColorHover:k,onClick:o,iconScale:C,iconPaddingLeft:v,iconPaddingTop:T,textPaddingLeft:v,textPaddingTop:T,buttonIdleColor:t?p:g,buttonWidth:b,buttonHeight:y,buttonRadius:x,initX:c+f+v,initY:u};switch(i){case"home":A.buttonIdleColor=t?p:g,A.buttonWidth=w,A.initX=l,A.initY=u;break;case"home-next":{A.buttonIdleColor=m,A.buttonWidth=f,A.initX=c,A.initY=u,E.text="Next",E.iconTexture=a;const e=new r.Button(E);this.dynamicContent.addChild(e);break}case"home-repeat":{A.buttonIdleColor=m,A.buttonWidth=f,A.initX=c,A.initY=u,E.text="Repeat",E.iconTexture=h;const e=new r.Button(E);this.dynamicContent.addChild(e);break}}const I=new r.Button(A);this.dynamicContent.addChild(I),this.dynamicContent.addChild(this.particles)}hideModal(){this.visible=!1}cleanFromAll(){for(this.hideModal();null!=this.particles.children[0];)this.particles.children[0].removeFromParent();for(;null!=this.dynamicContent.children[0];)this.dynamicContent.children[0].removeFromParent()}handleUpdate(e){if(this.visible){if(this.particles.children.forEach((e=>{e.handleUpdate()})),this.elapsedSpawnFrames>=this.spawnFrame&&this.sucess){const e={x:Math.random()*this.width,y:Math.random()*this.height};for(let t=0;t<30;t++){const t=new o.Firework;this.particles.addChild(t),t.position.set(e.x,e.y)}this.spawnFrame=Math.floor(20*Math.random()+60),this.elapsedSpawnFrames=0}this.elapsedSpawnFrames+=1;for(let e=0;e<this.particles.children.length;e++){const t=this.particles.children[e];t.markedForDeletion&&(t.removeFromParent(),e--)}}}}t.StartModal=d},70519:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBar=t.EMessageCharacter=void 0;const s=i(58687),r=i(36645);var o;!function(e){e.system="system",e.op="op",e.pilot="pilot",e.driver="driver"}(o=t.EMessageCharacter||(t.EMessageCharacter={}));class n extends s.Container{constructor(e){super(),this.setupAndDraw(e)}setupAndDraw({texture:e,message:t,time:i,maxWidth:r=0}){const{characterWidth:o,timeTextSize:h,timeTextColor:d}=n.options,l=new s.Sprite(e);l.width=o,l.height=l.scale.x*l.height,this.addChild(l),this.img=l;const c=new s.Text(a.getTimeText(i),{fontSize:h,fill:d});c.position.set(l.x,l.height),this.addChild(c),this.reAppendMessage({maxWidth:r,message:t})}reAppendMessage({maxWidth:e,message:t}){null!=this.msgText&&(t=this.msgText.text,this.msgText.destroy());const{padding:i,messageTextSize:r,messageTextColor:o}=n.options,a=new s.Text(t,{fontSize:r,fill:o,wordWrap:!0,wordWrapWidth:e-this.img.width-2*i});a.position.set(this.img.width+i,0),this.addChild(a),this.msgText=a}}n.options={padding:20,characterWidth:40,timeTextColor:8558242,timeTextSize:12,messageTextColor:12690711,messageTextSize:14};class a extends s.Container{static prepareTextures({textures:e}){a.textures=e}constructor(e){super(),this.scrollToLastMessage=!1,this.pointerDownY=-1,this.handlePointerDown=e=>{const t=this.messageList.toLocal(e);this.pointerDownY=t.y,(0,r.logPointerEvent)(`StatusBar.pointerDownY=${this.pointerDownY} down`)},this.handlePointerUp=()=>{this.pointerDownY=-1,(0,r.logPointerEvent)(`StatusBar.pointerDownY=${this.pointerDownY} up`)},this.handlePointerLeave=()=>{this.pointerDownY=-1,(0,r.logPointerEvent)(`StatusBar.pointerDownY=${this.pointerDownY} leave`)},this.handlePointerMove=e=>{if((0,r.logPointerEvent)(`StatusBar.pointerDownY=${this.pointerDownY} move`),this.pointerDownY>-1){const t=this.messageList.toLocal(e);(0,r.logPointerEvent)(`localPositionX=${t.x} localPositionY=${t.y}`);const i=this.pointerDownY-t.y;this.messageList.pivot.y+=i;const{maxPivot:s}=this,{pivot:o}=this.messageList;o.y<=0?o.y=0:o.y>s&&(o.y=s)}},this.handleWheel=e=>{let t=this.messageList.pivot.y+e.deltaY/10;const{maxPivot:i}=this;t<=0?t=0:t>i&&(t=i),this.messageList.pivot.y=t},this.setup(),this.draw(e),this.addEventLesteners()}static getTimeText(e){let t=e/1e3;const i=Math.round(t%60);t=Math.floor(t/60);const s=Math.round(t%60);t=Math.floor(t/60);const r=e=>String(e).padStart(2,"0");return`Time:\n${r(Math.round(t%24))}:${r(s)}:${r(i)}`}setup(){const e=new s.Graphics;this.addChild(e),this.graphicsBox=e;const t=new s.Graphics;e.addChild(t),this.graphicsBoxShadow=t;const i=new s.Graphics;e.addChild(i),this.messageListMask=i;const r=new s.Container;e.addChild(r),this.messageList=r}draw({initWidth:e,initHeight:t}){const{options:{backgroundColor:i,outerBorderColor:s,outerBorderWidth:r,innerBorderColor:o,innerBorderWidth:n,innerBorderRadius:h,shadowColor:d,shadowWidth:l,shadowAlpha:c}}=a;let u=0,m=0,p=e,g=t;this.graphicsBox.clear(),this.graphicsBox.beginFill(s),this.graphicsBox.drawRect(u,m,p,g),this.graphicsBox.endFill(),u+=r,m+=r,p-=2*r,g-=2*r,this.graphicsBox.beginFill(o),this.graphicsBox.drawRoundedRect(u,m,p,g,h),this.graphicsBox.endFill(),u+=n,m+=n,p-=2*n,g-=2*n,this.graphicsBox.beginFill(i),this.graphicsBox.drawRoundedRect(u,m,p,g,h),this.graphicsBox.endFill(),this.graphicsBoxShadow.clear(),this.graphicsBoxShadow.position.set(u,m),this.graphicsBoxShadow.lineStyle({width:l,color:d}),this.graphicsBoxShadow.drawRoundedRect(0,0,p,g,h),this.graphicsBoxShadow.endFill(),this.graphicsBoxShadow.alpha=c,u+=h,m+=h,p-=2*h,g-=2*h,this.messageListMask.position.set(u,m),this.drawMask({width:p,height:g}),this.messageList.mask=this.messageListMask,this.messageList.position.set(u,m)}drawMask({width:e,height:t}){const{options:{backgroundColor:i,innerBorderRadius:s}}=a;this.messageListMask.clear(),this.messageListMask.beginFill(i),this.messageListMask.drawRoundedRect(0,0,e,t,s),this.messageListMask.endFill(),this.messageList.mask=this.messageListMask}appendMessage({character:e,message:t,time:i,selfRemove:s,height:r}){let h;switch(e){case o.system:h=a.textures.systemTexture;break;case o.op:h=a.textures.girl1Texture;break;case o.pilot:h=a.textures.girl2Texture;break;case o.driver:h=a.textures.man1Texture}if(null!=this.messageList.mask){const{padding:e}=a.options,o=new n({texture:h,message:t,time:i,maxWidth:this.maxMessageWidth});o.position.set(e,0===this.messageList.height?e:this.messageList.height+2*e),this.messageList.addChild(o),s&&setTimeout((()=>{o.removeFromParent(),this.reAppendMessages({width:this.width,height:r}),this.messageList.pivot.y=this.maxPivot}),3e3);const{maxPivot:d}=this;this.messageList.height>d&&(this.scrollToLastMessage=!0)}}get maxPivot(){const{padding:e}=a.options,t=this.messageList.mask.height-2*e;return this.messageList.height>0?this.messageList.height-t:0}handleUpdate(e){if(this.scrollToLastMessage){const{maxPivot:e}=this;this.messageList.pivot.y<e-.01?this.messageList.pivot.y+=.01*e:this.scrollToLastMessage=!1}}addEventLesteners(){this.eventMode="static",this.on("pointerdown",this.handlePointerDown),this.on("pointermove",this.handlePointerMove),this.on("pointerup",this.handlePointerUp),this.on("pointerleave",this.handlePointerLeave),this.on("wheel",this.handleWheel)}cleanFromAll(){for(;null!=this.messageList.children[0];)this.messageList.children[0].removeFromParent();this.scrollToLastMessage=!1,this.messageList.pivot.y=0}get maxMessageWidth(){return this.messageList.mask.width-2*a.options.padding}reAppendMessages({width:e,height:t}){const{padding:i}=a.options,s=[];for(let e=0;e<this.messageList.children.length;e++){const t=this.messageList.children[e];t.removeFromParent(),s.push(t),e--}this.draw({initWidth:e,initHeight:t}),s.forEach((e=>{e.position.set(i,0===this.messageList.height?i:this.messageList.height+2*i),e.reAppendMessage({maxWidth:this.maxMessageWidth}),this.messageList.addChild(e)})),this.messageList.pivot.y=0}setLimit({width:e,height:t}){this.width!==e&&(this.reAppendMessages({width:e,height:t}),this.messageList.pivot.y=this.maxPivot)}}a.options={outerBorderColor:4741996,outerBorderWidth:3,innerBorderColor:1578774,innerBorderWidth:2,innerBorderRadius:3,backgroundColor:4539717,shadowColor:1578774,shadowWidth:3,shadowAlpha:.5,padding:10},t.StatusBar=a},76385:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TileMap=void 0;const s=i(58687),r=i(11954),o=i(14137),n=i(23266),a=i(42097),h=i(36645),d=i(16445),l=i(54536),c=i(41759),u=i(46667),m=i(9678);class p extends s.Container{}class g extends s.Container{}class w extends s.Container{}class f extends s.Graphics{}class b extends s.Graphics{}class y extends s.Sprite{}class x extends s.Container{}class T extends s.Container{constructor(e){super(),this.rebuildPassableRequired=!1,this._initialMapTerrainGrid=[],this._currentMapPassableGrid=[],this._currentMapBuildableGrid=[],this._initialMapDeployableGrid=[],this._currentMapDeployableGrid=[],this._currentCopyMapPassableGrid=[],this.hitboxes=new x,this.activeItems=new p,this.orders=new g,this.projectiles=new w,this.sightBlurred=new f,this.sight=new b,this.background=new y,this.background2=new y,this.background3=new y,this.minXPivot=0,this.maxXPivot=0,this.minYPivot=0,this.maxYPivot=0,this.minScale=0,this.maxScale=0,this.game=e.game,this.setup(),"number"==typeof e.initX&&(this.position.x=e.initX),"number"==typeof e.initY&&(this.position.y=e.initY)}setup(){this.addChild(this.background),this.addChild(this.background2),this.addChild(this.background3),this.addChild(this.activeItems),this.addChild(this.hitboxes),this.addChild(this.orders),this.addChild(this.projectiles),this.addChild(this.sightBlurred),this.addChild(this.sight)}static async idleLoad(){await s.Assets.loadBundle(n.manifest.bundles.map((e=>e.name)).filter(((e,t)=>t>0)))}initLevel({mapImageSrc:e,mapSettingsSrc:t,viewWidth:i,viewHeight:n}){const a=s.Assets.get(e),d=s.Assets.get(t);this.background.texture=a,h.logNoFog.enabled||(this.background2.texture=a,this.background3.texture=a,this.background2.alpha=.5),this.scale.set(1,1),this.pivot.set(0,0);const l=r.MapSettings.mapTilesToPositions({mapSettings:d,layerName:"Water,Clay,Lava,Rock-Fence"});this.gridSize=d.tilewidth,this.mapGridWidth=d.width,this.mapGridHeight=d.height,this._initialMapTerrainGrid=[];for(let e=0;e<this.mapGridHeight;e++){this._initialMapTerrainGrid[e]=[];for(let t=0;t<this.mapGridWidth;t++){const i=t*d.tilewidth,s=e*d.tileheight,r=l.some((e=>e.x===i&&e.y===s));this._initialMapTerrainGrid[e][t]=r?1:0}}if(this.hitboxes.alpha=.3,h.logGrid.enabled)for(let e=0;e<this.mapGridWidth;e++)for(let t=0;t<this.mapGridHeight;t++){const i=new s.Graphics;i.beginFill(16777215),i.position.set(e*this.gridSize,t*this.gridSize),i.drawRect(0,0,this.gridSize,this.gridSize),i.endFill(),i.beginHole(),i.drawRect(1,1,this.gridSize-2,this.gridSize-2),i.endHole();const r=new s.Text(`x=${e}\ny=${t}`,{fontSize:20,fill:16776960,align:"center"});r.anchor.set(.5,.5),r.position.set(this.gridSize/2,this.gridSize/2),r.scale.set(.4),i.addChild(r),i.alpha=.3,this.background3.addChild(i)}o.Hitbox.prepareTextures({texture:m.SceneManager.app.renderer.generateTexture(o.Hitbox.prepareGraphics({mapGridWidth:this.mapGridWidth,mapGridHeight:this.mapGridHeight,tileWidth:d.tilewidth,tileHeight:d.tileheight,borderWidth:2}))});for(let e=0;e<this.mapGridWidth;e++)for(let t=0;t<this.mapGridHeight;t++){const i=d.tilewidth*e,s=d.tileheight*t,r=new o.Hitbox({initGridX:e,initGridY:t});r.position.set(i,s),this.hitboxes.addChild(r)}this._initialMapDeployableGrid=[];const c=r.MapSettings.mapObjectToPositions({mapSettings:d,layerName:"Oilfields"});for(let e=0;e<this.mapGridHeight;e++){this._initialMapDeployableGrid[e]=[];for(let t=0;t<this.mapGridWidth;t++)this._initialMapDeployableGrid[e][t]=1}const{buildableGrid:p}=u.OilDerrick;c.forEach((e=>{for(let t=p.length-1;t>=0;t--)for(let i=p[t].length-1;i>=0;i--)this._initialMapDeployableGrid[e.y/this.gridSize+t][e.x/this.gridSize+i]=0})),this._currentMapPassableGrid=[],this._currentMapBuildableGrid=[],this.rebuildPassableRequired=!0,this.calcScaleLimits(),this.calcPivotLimits()}handleResize({viewWidth:e,viewHeight:t}){this.calcScaleLimits(),this.checkScaleLimits(),this.calcPivotLimits(),this.checkPivotLimits()}calcPivotLimits(){const{width:e,height:t}=this.game.camera,{scale:i,gridSize:s}=this,{width:r,height:o}=this.background,n=(r+s)*i.x,a=(o+s)*i.y,h=e,d=t;n>h?(this.maxXPivot=(n-h)/i.x,this.minXPivot=-s):(this.maxXPivot=-s,this.minXPivot=-s),a>d?(this.maxYPivot=(a-d)/i.y,this.minYPivot=-s):(this.maxYPivot=-s,this.minYPivot=-s)}calcScaleLimits(){const{width:e,height:t}=this.game.camera,{maxScaleRatio:i}=T.options,{width:s,height:r}=this.background;this.minScale=1,this.maxScale=i*Math.min(s/e,r/t)}checkScaleLimits(){const{scale:e}=this;e.x<this.minScale?e.x=this.minScale:e.x>this.maxScale&&(e.x=this.maxScale),e.y<this.minScale?e.y=this.minScale:e.y>this.maxScale&&(e.y=this.maxScale)}cleanFromAll(){for(this.pivot.set(0,0),this.scale.set(1,1);null!=this.activeItems.children[0];)this.activeItems.children[0].removeFromParent();for(;null!=this.projectiles.children[0];)this.projectiles.children[0].removeFromParent();for(;null!=this.orders.children[0];)this.orders.children[0].removeFromParent()}handleUpdate(e){const t=this.allItems;for(const i of t)i.handleUpdate(e);const i=this.game.sideBar.commandsBar.getSelectedCommandName(),s=this.game.cash[this.game.team];i===d.ECommandName.buildTurret&&s>=l.GroundTurret.cost||i===d.ECommandName.buildStarport&&s>=c.Starport.cost||h.logHitboxes.enabled?(this.rebuildBuildableGrid(),o.Hitbox.updateColor({currentMapGrid:this.currentMapBuildableGrid,hitboxes:this.hitboxes,cameraGridBounds:this.game.camera.getCameraGridBounds()}),this.hitboxes.visible=!0):i===d.ECommandName.deploy||h.logHitboxes.enabled?(this.rebuildBuildableGrid(),this.mergeBuildableGridIntoDeployable(),o.Hitbox.updateColor({currentMapGrid:this._currentMapDeployableGrid,hitboxes:this.hitboxes,cameraGridBounds:this.game.camera.getCameraGridBounds()}),this.hitboxes.visible=!0):this.hitboxes.visible=!1,this.game.tileMap.activeItems.sortChildren(),this.updateFog()}addItem(e){e.type===a.EItemType.buildings||e.type===a.EItemType.vehicles||e.type===a.EItemType.airVehicles?this.activeItems.addChild(e):e.type===a.EItemType.projectiles&&this.projectiles.addChild(e)}get moveableItems(){return[...this.activeItems.children.filter((e=>e.type===a.EItemType.vehicles||e.type===a.EItemType.airVehicles))]}get groundMoveableItems(){return[...this.activeItems.children.filter((e=>e.type===a.EItemType.vehicles))]}get airMoveableItems(){return[...this.activeItems.children.filter((e=>e.type===a.EItemType.airVehicles))]}get staticItems(){return[...this.activeItems.children.filter((e=>e.type===a.EItemType.buildings))]}get allItems(){return[...this.activeItems.children,...this.projectiles.children]}getTeamMoveableItems(e){return this.moveableItems.filter((t=>t.team===e))}getTeamStaticItems(e){return this.staticItems.filter((t=>t.team===e))}itemUnderPointer(e){const t=t=>{const i=t.getCollisionBounds();return!!(t.isAlive()&&e.x>=i.left&&e.x<=i.right&&e.y>=i.top&&e.y<=i.bottom)},i=this.moveableItems.find(t);return null!=i?i:this.staticItems.find(t)}get currentMapPassableGrid(){return this.rebuildPassableRequired&&(this.rebuildPassableGrid(),this.rebuildPassableRequired=!1),this._currentMapPassableGrid}get currentMapBuildableGrid(){return this._currentMapBuildableGrid}get initialMapDeployableGrid(){return this._initialMapDeployableGrid}get currentMapDeployableGrid(){return this._currentMapDeployableGrid}get currentCopyMapPassableGrid(){const{currentMapPassableGrid:e}=this;this._currentCopyMapPassableGrid.length=e.length;for(let t=0;t<e.length;t++){Array.isArray(this._currentCopyMapPassableGrid[t])?this._currentCopyMapPassableGrid[t].length=e[t].length:this._currentCopyMapPassableGrid[t]=new Array(e[t].length);for(let i=0;i<e[t].length;i++)this._currentCopyMapPassableGrid[t][i]=e[t][i]}return this._currentCopyMapPassableGrid}rebuildPassableGrid(){this._currentMapPassableGrid.length!==this._initialMapTerrainGrid.length&&(this._currentMapPassableGrid=this._initialMapTerrainGrid.map((e=>e.slice())));const{staticItems:e}=this;for(let t=e.length-1;t>=0;t--){const i=e[t],s=i.getGridXY({floor:!0});i.calcPassablePoints(s).forEach((({gridX:e,gridY:t})=>{this._currentMapPassableGrid[t][e]=1}))}}rebuildBuildableGrid(e){this._currentMapBuildableGrid.length!==this._initialMapTerrainGrid.length&&(this._currentMapBuildableGrid=this._initialMapTerrainGrid.map((e=>e.slice())));for(let e=0;e<this.mapGridWidth;e++)for(let t=0;t<this.mapGridHeight;t++)this._currentMapBuildableGrid[t][e]=this._initialMapTerrainGrid[t][e];const{activeItems:t}=this,{tileMap:{mapGridWidth:i,mapGridHeight:s}}=this.game;for(let r=t.children.length-1;r>=0;r--){const o=t.children[r];if(o.type===a.EItemType.buildings||o.type===a.EItemType.terrain){const e=o.getGridXY(),{buildableGrid:t}=o;for(let i=t.length-1;i>=0;i--)for(let s=t[i].length-1;s>=0;s--)1===t[i][s]&&(this._currentMapBuildableGrid[e.gridY+i][e.gridX+s]=1)}else if(o.type===a.EItemType.vehicles&&o!==e){const e=o.getGridCollisionBounds(),t=e.leftGridX,r=e.rightGridX,n=e.topGridY,a=e.bottomGridY;for(let e=t;e<=r;e++)for(let t=n;t<=a;t++)e<0||e>=i||t<0||t>=s||(this._currentMapBuildableGrid[t][e]=1)}}}mergeBuildableGridIntoDeployable(){this._currentMapDeployableGrid.length!==this._initialMapDeployableGrid.length&&(this._currentMapDeployableGrid=this._initialMapDeployableGrid.map((e=>e.slice())));for(let e=this._currentMapDeployableGrid.length-1;e>=0;e--)for(let t=this._currentMapDeployableGrid[e].length-1;t>=0;t--)this._currentMapDeployableGrid[e][t]=this._initialMapDeployableGrid[e][t],0===this._currentMapDeployableGrid[e][t]&&(this._currentMapDeployableGrid[e][t]=this._currentMapBuildableGrid[e][t])}getItemByUid(e,t){return(null!=t?t:this.activeItems.children).find((t=>t.uid===e))}isItemsDead(e){Array.isArray(e)||(e=[e]);const{activeItems:t}=this;return e.some((e=>{const i=this.getItemByUid(e,t.children);return null==i||i.isDead()}))}goTo({x:e,y:t,center:i=!0}){const{cameraRect:s}=this.game.topBar.miniMap,{pivot:r}=this,o=i?e-.5*s.width:e,n=i?t-.5*s.height:t;r.x=o,r.y=n,this.checkPivotLimits()}goDiff({diffX:e,diffY:t}){const{pivot:i}=this;i.x+=e,i.y+=t,this.checkPivotLimits()}checkPivotLimits(){const{pivot:e}=this;e.x<this.minXPivot?e.x=this.minXPivot:e.x>this.maxXPivot&&(e.x=this.maxXPivot),e.y<this.minYPivot?e.y=this.minYPivot:e.y>this.maxYPivot&&(e.y=this.maxYPivot)}zoom({scaleFactor:e,sX:t=0,sY:i=0}){const s=Math.abs(e),{pivot:{x:r,y:o},scale:{x:n}}=this,a=t-r,h=i-o;let d;d=e>=0?n*s:n/s,d<this.minScale?d=this.minScale:d>this.maxScale&&(d=this.maxScale);const l=n/d;let c,u;c=a*l,u=h*l;const m=r+(e>=0?1:-1)*Math.abs(a-c),p=o+(e>=0?1:-1)*Math.abs(h-u);this.scale.set(d,d),this.pivot.set(m,p),this.checkScaleLimits(),this.calcPivotLimits(),this.checkPivotLimits()}updateFog(){const{activeItems:e,gridSize:t,sight:i,sightBlurred:r,background:o,background3:n,projectiles:a}=this,d=o.y,l=o.x+o.width,c=o.y+o.height,u=o.x;i.clear(),r.clear();const m=[];for(let s=0;s<e.children.length;s++){const o=e.children[s];if(o.team===this.game.team){const s=o.getCollisionBounds();if(s.left<u&&s.right<u||s.left>l&&s.right>l||s.top<d&&s.bottom<d||s.top>c&&s.bottom>c){o.renderable=!1;continue}o.renderable=!0;const n=o.getCollisionPosition({center:!0});if(h.logNoFog.enabled||(i.beginFill(16777215),i.drawCircle(n.x,n.y,o.sightRadius*t),i.endFill(),r.beginFill(16777215),r.drawCircle(n.x,n.y,o.sightRadius*t*1.3),r.endFill()),h.logNoSightHide.enabled)continue;for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.team!==this.game.team&&!m.includes(s.uid)){const e=s.getCollisionPosition({center:!0});Math.hypot(n.y-e.y,n.x-e.x)<o.sightRadius*t*1.3?(s.renderable=!0,m.push(s.uid)):s.renderable=!1}}}}h.logNoFog.enabled||(o.mask=r,e.mask=r,a.mask=r,o.filters=[new s.BlurFilter],n.mask=i)}}T.options={maxScaleRatio:5},t.TileMap=T},97037:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TopBar=void 0;const s=i(58687),r=i(70519),o=i(9563);class n extends s.Container{constructor(e){super(),this.setup(e)}setup({game:e}){const{statusBarWidth:t,miniMapWidth:i,initHeight:s}=n.options;this.statusBar=new r.StatusBar({initWidth:t,initHeight:s}),this.addChild(this.statusBar),this.miniMap=new o.MiniMap({game:e,initWidth:i,initHeight:s}),this.addChild(this.miniMap),this.miniMap.position.set(this.statusBar.width,0)}handleResize({viewWidth:e,viewHeight:t}){const{statusBarWidth:i,miniMapWidth:s,initHeight:r}=n.options,o=e-s,a=o>i?(o-i)/2:0;this.statusBar.position.set(a,0);const h=o>i?i:o;this.statusBar.setLimit({width:h,height:r}),this.miniMap.x=e-this.miniMap.width,this.miniMap.handleResize({viewWidth:e,viewHeight:t})}handleUpdate(e){this.statusBar.handleUpdate(e),this.miniMap.handleUpdate(e)}}n.options={statusBarWidth:600,miniMapWidth:150,initHeight:100},t.TopBar=n},28807:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcBuildablePoints=t.calcPassablePoints=void 0,t.calcPassablePoints=function({gridX:e,gridY:t,passableGrid:i}){const s=[];for(let r=0;r<i.length;r++)for(let o=0;o<i[r].length;o++)1===i[r][o]&&s.push({gridX:e+o,gridY:t+r});return s},t.calcBuildablePoints=function({gridX:e,gridY:t,buildableGrid:i}){const s=[];for(let r=0;r<i.length;r++)for(let o=0;o<i[r].length;o++)1===i[r][o]&&s.push({gridX:e+o,gridY:t+r});return s}},16445:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ECommandName=void 0,(i=t.ECommandName||(t.ECommandName={})).deselect="deselect",i.moveFollow="moveFollow",i.attack="attack",i.attackGuard="attackGuard",i.patrol="patrol",i.deploy="deploy",i.buildTurret="buildTurret",i.buildStarport="buildStarport",i.constructSCV="constructSCV",i.constructHarvester="constructHarvester",i.constructScoutTank="constructScoutTank",i.constructHeavyTank="constructHeavyTank",i.constructChopper="constructChopper",i.constructWraith="constructWraith"},42097:(e,t)=>{var i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.EItemName=t.EItemType=void 0,(s=t.EItemType||(t.EItemType={})).none="none",s.buildings="buildings",s.vehicles="vehicles",s.airVehicles="airVehicles",s.terrain="terrain",s.projectiles="projectiles",(i=t.EItemName||(t.EItemName={})).None="none",i.Base="base",i.OilDerrick="oil-derrick",i.Starport="starport",i.GroundTurret="ground-turret",i.SCV="scv",i.Harvester="harvester",i.Transport="transport",i.ScoutTank="scout-tank",i.HeavyTank="heavy-tank",i.Chopper="chopper",i.Wraith="wraith",i.Bullet="bullet",i.CannonBall="cannon-ball",i.Rocket="heatseeker",i.Laser="laser"},33755:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;const s=i(58687),r=i(42097),o=i(53555),n=i(36645);class a extends s.Container{constructor(e){var t;super(),this.sightRadius=0,this.collisionRadius=0,this.type=r.EItemType.none,this.itemName=r.EItemName.None,this.commands=[],this.collisionGraphics=new s.Graphics,this.collisionOptions={width:0,height:0,offset:{x:0,y:0}},this.uid="number"==typeof e.uid?e.uid:(0,o.generateUid)(),this.game=e.game,this.order=null!==(t=e.order)&&void 0!==t?t:{type:"stand"}}setup(e){this.addChild(this.collisionGraphics)}getGridXY({floor:e=!1,center:t=!1}={}){const{gridSize:i}=this.game.tileMap,s=this.getCollisionPosition({center:t}),r={gridX:s.x/i,gridY:s.y/i};return e&&(r.gridX=Math.floor(r.gridX),r.gridY=Math.floor(r.gridY)),r}setPositionByXY({x:e,y:t,center:i=!1}){const{x:s,y:r,width:o,height:n}=this.collisionGraphics,a=0-(s+(i?o/2:0)),h=0-(r+(i?n/2:0));this.position.set(e+a,t+h)}setPositionByGridXY({gridX:e,gridY:t,center:i}){const{gridSize:s}=this.game.tileMap;this.setPositionByXY({x:e*s,y:t*s,center:i})}handleUpdate(e){}drawCollision(){const{offset:e,width:t,height:i}=this.collisionOptions,{collisionGraphics:s}=this;s.position.set(e.x,e.y),s.beginFill(16777215),s.drawRect(0,0,t,i),s.endFill(),s.alpha=n.logItemBounds.enabled?.5:0}getCollisionPosition({center:e=!1}={}){const{x:t,y:i,width:s,height:r}=this.collisionGraphics,o={x:this.x+t,y:this.y+i};return e&&(o.x+=s/2,o.y+=r/2),o}getCollisionBounds(){const e=this.getCollisionPosition();return{top:e.y,right:e.x+this.collisionGraphics.width,bottom:e.y+this.collisionGraphics.height,left:e.x}}getGridCollisionBounds(){const e=this.getCollisionBounds(),{gridSize:t}=this.game.tileMap,i={topGridY:e.top/t,rightGridX:e.right/t,bottomGridY:e.bottom/t,leftGridX:e.left/t},s={topGridY:Math.floor(i.topGridY),rightGridX:Math.floor(i.rightGridX),bottomGridY:Math.floor(i.bottomGridY),leftGridX:Math.floor(i.leftGridX)};return{topGridY:s.topGridY,leftGridX:s.leftGridX,rightGridX:i.rightGridX===s.rightGridX&&i.leftGridX===i.rightGridX-1?s.leftGridX:s.rightGridX,bottomGridY:i.bottomGridY===s.bottomGridY&&i.topGridY===i.bottomGridY-1?s.topGridY:s.bottomGridY}}processOrders(){return!1}removeAndDestroy(){this.removeFromParent()}}t.Item=a},73986:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LifeableItem=void 0;const s=i(33755),r=i(94973);class o extends s.Item{constructor(e){super(e),this.life=0,this.hitPoints=0,this.drawLifeBarOptions={borderColor:0,borderThickness:0,borderAlpha:0,width:0,height:0,fillColor:0,emptyColor:0,offset:{x:0,y:0}},null!=e.life&&(this.life=e.life)}setup(e){this.lifeBar=new r.LifeBar(this.drawLifeBarOptions),this.addChild(this.lifeBar)}drawLifeBar(){this.lifeBar.draw(this.drawLifeBarOptions);const{offset:e}=this.drawLifeBarOptions;this.lifeBar.position.set(e.x,e.y)}isAlive(){return this.life>0}isHealthy(){return this.life>=.4*this.hitPoints}isDead(){return!this.isAlive()}subLife(e){this.life-=e,this.isDead()?this.removeAndDestroy():(this.updateLife(),this.updateAnimation())}updateLife(){this.lifeBar.updateLife(this.life/this.hitPoints)}updateAnimation(){}}t.LifeableItem=o},46111:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableLifeableSquareItem=t.SelectableLifeableRoundItem=void 0;const s=i(58687),r=i(73986);class o extends r.LifeableItem{constructor(e){super(e),this.selectedGraphics=new s.Graphics,this.selected=!1,this.selectable=!0,this.drawSelectionOptions={width:0,height:0,radius:0,strokeWidth:0,strokeColor:0,strokeSecondColor:0,offset:{x:0,y:0}},this.team=e.team,"boolean"==typeof e.selectable&&(this.selectable=e.selectable)}setSelected(e){this.selectedGraphics.alpha=e?.5:0,this.selected=e}drawSelection(){}removeAndDestroy(){super.removeAndDestroy();const e=this.game.isItemSelected(this);this.game.deselectItem(this),e&&this.game.sideBar.handleSelectedItems(this.game.selectedItems)}}t.SelectableLifeableRoundItem=class extends o{drawSelection(){const{offset:e,strokeWidth:t,strokeColor:i,strokeSecondColor:s,radius:r}=this.drawSelectionOptions,{selectedGraphics:o}=this;o.position.set(e.x,e.y);const n=2*Math.PI/8,a=r+t,h=r+t;for(let e=0;e<8;e++){o.beginFill(e%2==0?i:s);const d=n*e,l=n*(e+1),c=r+t;o.moveTo(a+r*Math.cos(d),h+r*Math.sin(d)),o.lineTo(a+c*Math.cos(d),h+c*Math.sin(d)),o.arc(a,h,c,d,l),o.lineTo(a+r*Math.cos(l),h+r*Math.sin(l)),o.arc(a,h,r,l,d,!0),o.endFill()}o.alpha=0}},t.SelectableLifeableSquareItem=class extends o{drawSelection(){const{offset:e,strokeWidth:t,strokeColor:i,strokeSecondColor:s,width:r,height:o}=this.drawSelectionOptions,{selectedGraphics:n}=this;n.position.set(e.x,e.y);const a=r/2,h=o/2;n.beginFill(i),n.drawRect(0,0,a,t),n.endFill(),n.beginFill(s),n.drawRect(a,0,a,t),n.endFill(),n.beginFill(i),n.drawRect(r-t,0,t,h),n.endFill(),n.beginFill(s),n.drawRect(r-t,h,t,h),n.endFill(),n.beginFill(i),n.drawRect(a,o-t,a,t),n.endFill(),n.beginFill(s),n.drawRect(0,o-t,a,t),n.endFill(),n.beginFill(i),n.drawRect(0,h,t,h),n.endFill(),n.beginFill(s),n.drawRect(0,0,t,h),n.endFill(),n.alpha=0}removeAndDestroy(){super.removeAndDestroy(),this.game.tileMap.rebuildPassableRequired=!0}}},17837:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TeleportableSelectableLifeableRoundItem=void 0;const s=i(46111);class r extends s.SelectableLifeableRoundItem{handleUpdate(e){super.handleUpdate(e),null!=this.teleportGraphics&&(this.teleportGraphics.alpha>0?this.teleportGraphics.alpha-=.01:(this.teleportGraphics.alpha=0,this.teleportGraphics.removeFromParent(),this.teleportGraphics=void 0))}drawTeleport(){const{offset:e,strokeWidth:t,radius:i}=this.drawSelectionOptions,{teleportGraphics:s}=this;if(null!=s){s.position.set(e.x,e.y);const r=i+t,o=i+t;s.beginFill(16777215),s.drawCircle(r,o,i+t),s.endFill()}}}t.TeleportableSelectableLifeableRoundItem=r},79420:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Bullet=void 0;const s=i(42097),r=i(85634);class o extends r.Projectile{constructor(e){super({...e,textures:o.textures}),this.itemName=s.EItemName.Bullet,this.speed=50,this.distanceTolive=10,this.damage=1,this.collisionOptions={width:4,height:4,offset:{x:3,y:4}},this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:!0}),this.game.audio.playShoot("bullet")}static prepareTextures({textures:e}){o.textures=e}playHitSound(){this.game.audio.playHit("bullet-hit")}}o.reloadTime=2,o.shootAudio="",t.Bullet=o},63452:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CannonBall=void 0;const s=i(42097),r=i(85634);class o extends r.Projectile{constructor(e){super({...e,textures:o.textures}),this.itemName=s.EItemName.CannonBall,this.speed=60,this.distanceTolive=20,this.damage=20,this.collisionOptions={width:4,height:4,offset:{x:3,y:3}},this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:!0}),this.game.audio.playShoot("cannon-ball")}static prepareTextures({textures:e}){o.textures=e}playHitSound(){this.game.audio.playHit("cannon-hit")}}o.reloadTime=40,t.CannonBall=o},35191:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Laser=void 0;const s=i(42097),r=i(85634);class o extends r.Projectile{constructor(e){super({...e,textures:o.textures}),this.itemName=s.EItemName.Laser,this.speed=60,this.distanceTolive=20,this.damage=15,this.turnSpeed=1,this.collisionOptions={width:4,height:4,offset:{x:3,y:3}},this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:!0}),this.game.audio.playShoot("laser")}static prepareTextures({textures:e}){o.textures=e}playHitSound(){this.game.audio.playHit("laser-hit")}}o.reloadTime=30,t.Laser=o},85634:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Projectile=void 0;const s=i(58687),r=i(42097),o=i(7091),n=i(53555),a=i(33755);class h extends a.Item{constructor(e){super(e),this.commands=[],this.type=r.EItemType.projectiles,this.distanceTolive=0,this.damage=0,this.distanceTravelled=0,this.vector=new o.Vector({direction:o.EVectorDirection.down}),this.speed=0,this.followRadius=0,this.turnSpeed=0,this.turnFactor=0,this.moveTurning=!1,this.hardCollision=!1,this.collisionCount=0,this.colliding=!1,this.spritesContainer=new s.Container,this.uid="number"==typeof e.uid?e.uid:(0,n.generateUid)(),this.game=e.game,this.order={type:"fire",to:e.target},this.setup(e),this.vector.setDirection({direction:e.direction}),this.switchAnimation()}setup({textures:{upTextures:e,upRightTextures:t,rightTextures:i,downRightTextures:r,downTextures:o,downLeftTextures:n,leftTextures:a,upLeftTextures:h,explodeTextures:d}}){this.addChild(this.spritesContainer),this.addChild(this.collisionGraphics);const l=new s.AnimatedSprite(e);this.spritesContainer.addChild(l),this.upAnimation=l;const c=new s.AnimatedSprite(t);this.spritesContainer.addChild(c),this.upRightAnimation=c;const u=new s.AnimatedSprite(i);this.spritesContainer.addChild(u),this.rightAnimation=u;const m=new s.AnimatedSprite(r);this.spritesContainer.addChild(m),this.downRightAnimation=m;const p=new s.AnimatedSprite(o);this.spritesContainer.addChild(p),this.downAnimation=p;const g=new s.AnimatedSprite(n);this.spritesContainer.addChild(g),this.downLeftAnimation=g;const w=new s.AnimatedSprite(a);this.spritesContainer.addChild(w),this.leftAnimation=w;const f=new s.AnimatedSprite(h);this.spritesContainer.addChild(f),this.upLeftAnimation=f;const b=new s.AnimatedSprite(d);b.loop=!1,this.spritesContainer.addChild(b),this.explodeAnimation=b}hideAllAnimations(){this.spritesContainer.children.forEach((e=>{e.visible=!1}))}switchAnimation(){let e;const t=.5,{direction:i}=this.vector;e=i>=o.EVectorDirection.upLeft+t&&i<=o.EVectorDirection.up||i>=o.EVectorDirection.up&&i<=o.EVectorDirection.upRight-t?this.upAnimation:i>=o.EVectorDirection.upRight+t&&i<=o.EVectorDirection.downRight-t?this.rightAnimation:i>=o.EVectorDirection.downRight+t&&i<=o.EVectorDirection.downLeft-t?this.downAnimation:i>=o.EVectorDirection.downLeft+t&&i<=o.EVectorDirection.upLeft-t?this.leftAnimation:i>o.EVectorDirection.up&&i<o.EVectorDirection.right?this.upRightAnimation:i>o.EVectorDirection.right&&i<o.EVectorDirection.down?this.downRightAnimation:i>=o.EVectorDirection.down&&i<o.EVectorDirection.left?this.downLeftAnimation:this.upLeftAnimation,e!==this.currentAnimation&&(this.currentAnimation=e,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}switchToExplodeAnimation(){this.hideAllAnimations(),this.currentAnimation=this.explodeAnimation,this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0,this.currentAnimation.onComplete=()=>{this.removeFromParent()}}reachedTarget(){if("fire"===this.order.type){const e=this.getCollisionBounds(),t=this.order.to.getCollisionBounds();return(0,n.checkCollision)(e,t)>.5}return!1}playHitSound(){}isExploding(){return this.currentAnimation===this.explodeAnimation}processOrders(){if("fire"===this.order.type){const e=this.reachedTarget();return this.distanceTravelled>this.distanceTolive||e?e?(this.playHitSound(),this.order.to.subLife(this.damage),this.switchToExplodeAnimation(),this.order={type:"stand"}):this.removeFromParent():this._moveTo(this.order.to),!0}return!1}handleUpdate(e){this.processOrders()}_moveTo(e){const t=this.getGridXY({center:!0});if(this.turnSpeed>0){const i=e.getGridXY({center:!0}),s=(0,n.findAngleGrid)({from:i,to:t,directions:this.vector.directions}),r=(0,n.angleDiff)({angle1:this.vector.direction,angle2:s,directions:this.vector.directions}),o=this.turnSpeed*this.game.turnSpeedAdjustmentFactor;Math.abs(r)>o&&(this.vector.setDirection({direction:(0,n.wrapDirection)({direction:this.vector.direction+o*Math.abs(r)/r,directions:this.vector.directions})}),this.switchAnimation())}const i=this.speed*this.game.speedAdjustmentFactor;this.distanceTravelled+=i;const s=-this.vector.direction/this.vector.directions*2*Math.PI,r=-i*Math.sin(s),o=-i*Math.cos(s),a=t.gridX+r,h=t.gridY+o;this.setPositionByGridXY({gridX:a,gridY:h,center:!0})}}h.reloadTime=0,t.Projectile=h},95978:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Rocket=void 0;const s=i(42097),r=i(85634);class o extends r.Projectile{constructor(e){super({...e,textures:o.textures}),this.itemName=s.EItemName.Rocket,this.speed=25,this.distanceTolive=25,this.damage=20,this.turnSpeed=2,this.collisionOptions={width:5,height:5,offset:{x:3,y:3}},this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:!0}),this.game.audio.playShoot("rocket")}static prepareTextures({textures:e}){o.textures=e}playHitSound(){this.game.audio.playHit("rocket-hit")}}o.reloadTime=40,t.Rocket=o},80224:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignScene=void 0;const s=i(58687),r=i(9678),o=i(7091),n=i(53555),a=i(22273),h=i(33244),d=i(70519),l=i(65078),c=i(42097),u=i(30332),m=i(16445),p=i(84631),g=i(60231),w=i(82241),f=i(36645),b=i(54536),y=i(22591);class x extends s.Container{constructor(e){super(),this.missions=[],this.currentMissionIdx=x.options.startMission,this.triggers=[],"number"==typeof e.missionIdx&&(this.currentMissionIdx=e.missionIdx),this.setup(e)}setup({viewWidth:e,viewHeight:t,game:i}){i.viewWidth=e,i.viewHeight=t,i.team=n.Team.blue,i.type="campaign",this.game=i}handleResize(e){this.game.handleResize(e)}handleUpdate(e){this.game.handleUpdate(e),this.game.gameEnded||(0,l.handleTiggers)({deltaMS:e,triggers:this.triggers})}startCurrentLevel(){const e=this.missions[this.currentMissionIdx];this.triggers=e.triggers.map((e=>(0,l.createTrigger)(e))),this.game.startGame(e),e.items.forEach((e=>{const t=this.game.createItem(e);null!=t&&this.game.tileMap.addItem(t)})),this.game.tileMap.rebuildBuildableGrid(),this.game.cash[n.Team.blue]=e.cash.blue,this.game.cash[n.Team.green]=e.cash.green,(0,f.logCash)(`(${this.game.team}) initial b=${this.game.cash.blue} g=${this.game.cash.green}`),this.game.showMessage({character:d.EMessageCharacter.system,message:`Mission: ${e.name}\n${e.briefing}`,playSound:!1})}mountedHandler(){this.addChild(this.game),this.prepareMissions(),this.startCurrentLevel()}prepareMissions(){this.missions=[{name:"Rescue",briefing:"In the months since the great war, mankind has fallen into chaos. Billions are dead with cities in ruins.\nSmall groups of survivors band together to try and survive as best as they can.\nWe are trying to reach out to all the survivors in this sector before we join back with the main colony.",mapImageSrc:"level1Background",mapSettingsSrc:"level1Settings",startGridX:57,startGridY:12,cash:{blue:0,green:0},items:[{name:"base",initGridX:55,initGridY:6,team:n.Team.blue,commands:[],life:100},{name:"heavy-tank",initGridX:57,initGridY:12,direction:o.EVectorDirection.downRight,team:n.Team.blue,uid:-1},{name:"transport",initGridX:-3,initGridY:2,direction:o.EVectorDirection.right,team:n.Team.blue,uid:-3,commands:[]},{name:"transport",initGridX:-3,initGridY:4,direction:o.EVectorDirection.left,team:n.Team.blue,uid:-4,commands:[]},{name:"scout-tank",initGridX:40,initGridY:20,direction:o.EVectorDirection.up,team:n.Team.green,uid:-2,life:21,order:{type:"patrol",fromPoint:{gridX:34,gridY:20},toPoint:{gridX:42,gridY:26}}},{name:"scout-tank",initGridX:14,initGridY:0,direction:o.EVectorDirection.down,team:n.Team.green,uid:-5,life:21,order:{type:"patrol",fromPoint:{gridX:14,gridY:0},toPoint:{gridX:14,gridY:14}}}],triggers:[{type:l.ETriggerType.timed,time:3e3,action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander!! We haven't heard from the last convoy in over two hours. They should have arrived by now."})}},{type:l.ETriggerType.timed,time:1e4,action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"They were last seen in the North West Sector. Could you investigate?"})}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-1,-3,-4]),action:()=>{this.endMission({success:!1})}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead(-2),action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"The rebels have been getting very aggressive lately. I hope the convoy is safe. Find them and escort them back to the base."})}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.getItemByUid(-1);if(null!=e){const t=e.getGridXY({center:!0});return t.gridX<30&&t.gridY<30}return!1},action:()=>{this.game.showMessage({character:d.EMessageCharacter.driver,message:"Can anyone hear us? Our convoy has been pinned down by rebel tanks. We need help."})}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.getItemByUid(-1);if(null!=e){const t=e.getGridXY({center:!0});return t.gridX<10&&t.gridY<10}return!1},action:()=>{const e=this.game.tileMap.getItemByUid(-1);null!=e&&(this.game.showMessage({character:d.EMessageCharacter.driver,message:"Thank you. We thought we would never get out of here alive."}),this.game.processOrder({uids:[-3,-4],order:{type:"follow",to:e}}))}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.getItemByUid(-3),t=this.game.tileMap.getItemByUid(-4);if(null!=e&&null!=t){const i=e.getGridXY({center:!0}),s=t.getGridXY({center:!0});return i.gridX>52&&i.gridY<18&&s.gridX>52&&s.gridY<18}return!1},action:()=>{this.endMission({success:!0})}}]},{name:"Assault",briefing:"Thanks to the supplies from the convoy, we now have the base up and running.\nThe rebels nearby are proving to be a problem. We need to take them out. \nFirst set up the base defences. Then find and destroy all rebels in the area.\nThe colony will be sending us reinforcements to help us out.",mapImageSrc:"level1Background",mapSettingsSrc:"level1Settings",startGridX:55,startGridY:18,cash:{blue:0,green:0},items:[{name:"base",initGridX:55,initGridY:6,team:n.Team.blue,commands:[m.ECommandName.constructSCV],uid:-1},{name:"ground-turret",initGridX:53,initGridY:17,direction:o.EVectorDirection.up,team:n.Team.blue},{name:"heavy-tank",initGridX:55,initGridY:16,direction:o.EVectorDirection.upLeft,team:n.Team.blue,uid:-2,order:{type:"stand"}},{name:"scout-tank",initGridX:55,initGridY:36,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"hunt"}},{name:"scout-tank",initGridX:53,initGridY:36,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"hunt"}},{name:"scout-tank",initGridX:5,initGridY:5,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:5,gridY:5},toPoint:{gridX:20,gridY:20}}},{name:"scout-tank",initGridX:5,initGridY:15,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:5,gridY:15},toPoint:{gridX:20,gridY:30}}},{name:"scout-tank",initGridX:25,initGridY:5,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:25,gridY:5},toPoint:{gridX:25,gridY:20}}},{name:"scout-tank",initGridX:35,initGridY:5,direction:o.EVectorDirection.down,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:35,gridY:5},toPoint:{gridX:35,gridY:30}}},{name:"base",initGridX:5,initGridY:36,team:n.Team.green,uid:-11},{name:"starport",initGridX:1,initGridY:30,team:n.Team.green,uid:-12},{name:"starport",initGridX:4,initGridY:32,team:n.Team.green,uid:-13},{name:"harvester",initGridX:1,initGridY:38,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:1,gridY:38}}},{name:"harvester",initGridX:10,initGridY:38,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:10,gridY:38}}},{name:"ground-turret",initGridX:5,initGridY:28,direction:o.EVectorDirection.up,team:n.Team.green},{name:"ground-turret",initGridX:7,initGridY:33,direction:o.EVectorDirection.upLeft,team:n.Team.green},{name:"ground-turret",initGridX:8,initGridY:37,direction:o.EVectorDirection.upRight,team:n.Team.green}],triggers:[{type:l.ETriggerType.timed,time:8e3,action:()=>{const{tileMap:e}=this.game,t=e.getItemByUid(-2);null!=t&&(this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander!! Reinforcements have arrived from the colony."}),e.addItem(new h.ScoutTank({game:this.game,initX:58*e.gridSize,initY:22*e.gridSize,team:n.Team.blue,order:{type:"guard",to:t}})),e.addItem(new h.ScoutTank({game:this.game,initX:60*e.gridSize,initY:21*e.gridSize,team:n.Team.blue,order:{type:"guard",to:t}})))}},{type:l.ETriggerType.conditional,interval:5e3,remove:!1,condition:()=>this.game.tileMap.staticItems.filter((e=>e.itemName===c.EItemName.GroundTurret&&e.team===this.game.team)).length<2,action:()=>{let e=!1;this.game.tileMap.moveableItems.filter((e=>e.itemName===c.EItemName.SCV&&e.team===this.game.team)).length>0?this.game.cash[this.game.team]<b.GroundTurret.cost&&(this.game.cash[this.game.team]+=b.GroundTurret.cost,e=!0):this.game.cash[this.game.team]<b.GroundTurret.cost+y.SCV.cost&&(this.game.cash[this.game.team]+=b.GroundTurret.cost+y.SCV.cost,e=!0),e&&this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander!! We have enough resources for another ground turret.\nSet up the turret to keep the base safe from any more attacks.",selfRemove:!0})}},{type:l.ETriggerType.interval,interval:1e4,action:()=>{this.game.cash[n.Team.green]>100&&this.game.tileMap.getTeamMoveableItems(n.Team.green).length<10&&(this.game.processOrder({uids:[-12],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"hunt"}}}),this.game.processOrder({uids:[-13],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"hunt"}}}))}},{type:l.ETriggerType.interval,interval:18e4,action:()=>{if(this.game.tileMap.getTeamMoveableItems(n.Team.blue).length<15){this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander!! More Reinforcments have arrived."});const{tileMap:e}=this.game;e.addItem(new h.ScoutTank({game:this.game,initX:62*e.gridSize,initY:22*e.gridSize,team:n.Team.blue,order:{type:"move-and-attack",toPoint:{gridX:55,gridY:21}}})),e.addItem(new a.HeavyTank({game:this.game,initX:61*e.gridSize,initY:23*e.gridSize,team:n.Team.blue,order:{type:"move-and-attack",toPoint:{gridX:56,gridY:23}}}))}}},{type:l.ETriggerType.timed,time:3e5,action:()=>{this.game.showMessage({character:d.EMessageCharacter.pilot,message:"Close Air Support en route. Will try to do what I can."});const{tileMap:e}=this.game;e.addItem(new u.Chopper({game:this.game,initX:61*e.gridSize,initY:22*e.gridSize,commands:[],team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:61*e.gridSize,initY:20*e.gridSize,team:n.Team.blue,order:{type:"hunt"}}))}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead(-1),action:()=>{this.endMission({success:!1})}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead(-11),action:()=>{this.endMission({success:!0})}}]},{name:"Under Siege",briefing:"Thanks to the attack led by you, we now have control of the rebel base. We can expect the rebels to try to retaliate.\n The colony is sending in aircraft to help us evacuate back to the main camp. All we need to do is hang tight until the choppers get here. \n Luckily, we have some supplies and ammunition to defend ourselves with until they get here. \nProtect the transports at all costs.",mapImageSrc:"level1Background",mapSettingsSrc:"level1Settings",startGridX:7,startGridY:29,cash:{blue:0,green:0},items:[{name:"base",initGridX:5,initGridY:36,team:n.Team.blue,uid:-11},{name:"starport",initGridX:1,initGridY:28,team:n.Team.blue,uid:-12},{name:"starport",initGridX:4,initGridY:32,team:n.Team.blue,uid:-13},{name:"harvester",initGridX:1.5,initGridY:38.5,initCenter:!0,team:n.Team.blue,order:{type:"deploy",toPoint:{gridX:1,gridY:38}}},{name:"ground-turret",initGridX:7,initGridY:28,team:n.Team.blue},{name:"ground-turret",initGridX:8,initGridY:32,team:n.Team.blue},{name:"ground-turret",initGridX:11,initGridY:37,team:n.Team.blue},{name:"transport",initGridX:2,initGridY:33,team:n.Team.blue,commands:[],uid:-1},{name:"transport",initGridX:1,initGridY:34,team:n.Team.blue,commands:[],uid:-2},{name:"transport",initGridX:2,initGridY:35,team:n.Team.blue,commands:[],uid:-3},{name:"transport",initGridX:1,initGridY:36,team:n.Team.blue,commands:[],uid:-4},{name:"chopper",initGridX:15,initGridY:40,team:n.Team.blue,commands:[],uid:-5,order:{type:"patrol",fromPoint:{gridX:15,gridY:40},toPoint:{gridX:0,gridY:25}}},{name:"scout-tank",initGridX:15,initGridY:16,team:n.Team.green,order:{type:"hunt"}},{name:"scout-tank",initGridX:17,initGridY:16,team:n.Team.green,order:{type:"hunt"}},{name:"starport",initGridX:35,initGridY:37,team:n.Team.green,uid:-23},{name:"starport",initGridX:33,initGridY:37,team:n.Team.green,uid:-24},{name:"harvester",initGridX:28.5,initGridY:39.5,initCenter:!0,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:28,gridY:39}}},{name:"harvester",initGridX:30.5,initGridY:39.5,initCenter:!0,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:30,gridY:39}}},{name:"starport",initGridX:3,initGridY:0,team:n.Team.green,uid:-21},{name:"starport",initGridX:6,initGridY:0,team:n.Team.green,uid:-22},{name:"harvester",initGridX:0,initGridY:2,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:0,gridY:2}}},{name:"harvester",initGridX:0,initGridY:4,team:n.Team.green,order:{type:"deploy",toPoint:{gridX:0,gridY:4}}}],triggers:[{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-1,-2,-3,-4]),action:()=>{this.endMission({success:!1})}},{type:l.ETriggerType.timed,time:5e3,action:()=>{this.game.showMessage({character:d.EMessageCharacter.driver,message:"Commander!! The rebels have started attacking. We need to protect the base at any cost."})}},{type:l.ETriggerType.timed,time:2e4,action:()=>{const{tileMap:e}=this.game;e.addItem(new p.Transport({game:this.game,initX:57*e.gridSize,initY:3*e.gridSize,commands:[],team:n.Team.blue,uid:-6})),this.game.processOrder({uids:[-5],orderType:"guard",toUid:-6}),this.game.showMessage({character:d.EMessageCharacter.driver,message:"Commander!! The colony has sent some extra supplies. We are coming in from the North East sector through rebel territory. We could use a little protection."})}},{type:l.ETriggerType.timed,time:28e3,action:()=>{const{tileMap:e}=this.game;e.addItem(new h.ScoutTank({game:this.game,initX:57*e.gridSize,initY:28*e.gridSize,team:n.Team.green,order:{type:"hunt"}})),e.addItem(new g.Wraith({game:this.game,initX:55*e.gridSize,initY:33*e.gridSize,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:55,gridY:33},toPoint:{gridX:55,gridY:30}}})),e.addItem(new g.Wraith({game:this.game,initX:53*e.gridSize,initY:33*e.gridSize,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:53,gridY:33},toPoint:{gridX:53,gridY:30}}})),e.addItem(new h.ScoutTank({game:this.game,initX:35*e.gridSize,initY:25*e.gridSize,team:n.Team.green,order:{type:"patrol",fromPoint:{gridX:35,gridY:25},toPoint:{gridX:35,gridY:30}}})),this.game.showMessage({character:d.EMessageCharacter.pilot,message:"I'm on my way."})}},{type:l.ETriggerType.timed,time:48e3,action:()=>{this.game.processOrder({uids:[-6],order:{type:"move",toPoint:{gridX:1.5,gridY:38.5}}}),this.game.showMessage({character:d.EMessageCharacter.driver,message:"Thanks! Appreciate the backup. All right. Off we go."})}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.getItemByUid(-5);return null!=e&&e.life<.8*e.hitPoints},action:()=>{this.game.showMessage({character:d.EMessageCharacter.pilot,message:"We are under attack! Need assistance. This doesn't look good."})}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.getItemByUid(-6);if(null!=e){const t=e.getGridXY({center:!0});return t.gridX<5&&t.gridY>37}return!1},action:()=>{this.game.cash[n.Team.blue]+=200,this.game.showMessage({character:d.EMessageCharacter.driver,message:"The rebels came out of nowhere. There was nothing we could do. She saved our lives. Hope these supplies were worth it."})}},{type:l.ETriggerType.interval,interval:15e4,action:()=>{let e=0,t=0;const{moveableItems:i}=this.game.tileMap;for(let s=0;s<i.length;s++){const r=i[s];if(r.team===n.Team.green)switch(r.itemName){case"wraith":e++;break;case"heavy-tank":t++}}0===e?this.game.processOrder({uids:[-23,-24],order:{type:"construct-unit",name:c.EItemName.Chopper,unitOrder:{type:"hunt"}}}):1===e?(this.game.processOrder({uids:[-23],order:{type:"construct-unit",name:c.EItemName.Wraith,unitOrder:{type:"hunt"}}}),this.game.processOrder({uids:[-24],order:{type:"construct-unit",name:c.EItemName.Chopper,unitOrder:{type:"hunt"}}})):this.game.processOrder({uids:[-23,-24],order:{type:"construct-unit",name:c.EItemName.Chopper,unitOrder:{type:"hunt"}}}),0===t?this.game.processOrder({uids:[-21,-22],order:{type:"construct-unit",name:c.EItemName.HeavyTank,unitOrder:{type:"hunt"}}}):1===t?(this.game.processOrder({uids:[-21],order:{type:"construct-unit",name:c.EItemName.HeavyTank,unitOrder:{type:"hunt"}}}),this.game.processOrder({uids:[-22],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"hunt"}}})):this.game.processOrder({uids:[-21,-22],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"hunt"}}});const s=[];for(let e=0;e<i.length;e++){const t=i[e];t.team===n.Team.green&&s.push(t.uid)}this.game.processOrder({uids:s,order:{type:"hunt"}})}},{type:l.ETriggerType.timed,time:48e4,action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander! The colony air fleet is just a few minutes away."})}},{type:l.ETriggerType.timed,time:6e5,action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander! The colony air fleet is approaching"});const{tileMap:e}=this.game;e.addItem(new g.Wraith({game:this.game,initX:-1*e.gridSize,initY:20*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:-1*e.gridSize,initY:22*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new g.Wraith({game:this.game,initX:-1*e.gridSize,initY:24*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:-1*e.gridSize,initY:26*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new g.Wraith({game:this.game,initX:-1*e.gridSize,initY:28*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:-1*e.gridSize,initY:30*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new g.Wraith({game:this.game,initX:-1*e.gridSize,initY:32*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:-1*e.gridSize,initY:34*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new g.Wraith({game:this.game,initX:-1*e.gridSize,initY:36*e.gridSize,team:n.Team.blue,order:{type:"hunt"}})),e.addItem(new u.Chopper({game:this.game,initX:-1*e.gridSize,initY:38*e.gridSize,team:n.Team.blue,order:{type:"hunt"}}))}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.getTeamStaticItems(n.Team.green).length<=0,action:()=>{this.endMission({success:!0})}}]},{name:"Development",briefing:"We need to build a base from scratch!",mapImageSrc:"level2Background",mapSettingsSrc:"level2Settings",startGridX:2,startGridY:37,cash:{blue:160,green:0},items:[{name:"base",initGridX:2,initGridY:36,team:n.Team.blue,commands:[m.ECommandName.constructHarvester],uid:-1},{name:"base",initGridX:56,initGridY:2,team:n.Team.green,uid:-2}],triggers:[{type:l.ETriggerType.timed,time:2e3,action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"Commander! Please build harvester truck and deplot it on some oil field to become oil derrick."})}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.Harvester))),action:()=>{const e=this.game.tileMap.getItemByUid(-1);null!=e&&(this.game.clearSelection(!0),e.commands=[])}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.OilDerrick))),action:()=>{const e=this.game.tileMap.getItemByUid(-1);null!=e&&(this.game.clearSelection(!0),e.commands=[m.ECommandName.constructSCV],this.game.showMessage({character:d.EMessageCharacter.op,message:"We need to build fortifications to resist enemy attacks, please choose the main base to build scv."}),this.game.cash[n.Team.blue]+=40,this.game.cash[n.Team.green]+=160,this.game.processOrder({uids:[-2],order:{type:"construct-unit",name:c.EItemName.Harvester,unitOrder:{type:"deploy",toPoint:{gridX:51,gridY:2}}}}))}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.SCV));return null!=e&&(e.commands=[m.ECommandName.moveFollow,m.ECommandName.patrol,m.ECommandName.buildTurret]),Boolean(e)},action:()=>{const e=this.game.tileMap.getItemByUid(-1);null!=e&&(this.game.clearSelection(!0),e.commands=[],this.game.cash[n.Team.blue]+=150,this.game.showMessage({character:d.EMessageCharacter.op,message:"SCV can build a turret to resist the enemy's attack.\nSelect SCV and build a turret on the right side of the main base"}),this.game.cash[n.Team.green]+=240,this.game.processOrder({uids:[-2],order:{type:"construct-unit",name:c.EItemName.SCV,unitOrder:{type:"build",name:c.EItemName.Starport,toPoint:{gridX:53,gridY:6}}}}))}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.GroundTurret))),action:()=>{this.game.clearSelection(!0);const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.SCV&&e.team===this.game.team));null!=e&&(e.commands=[m.ECommandName.moveFollow,m.ECommandName.patrol]);const t=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.GroundTurret&&e.team===this.game.team)),i=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===n.Team.green));null!=i&&null!=t?(this.game.showMessage({character:d.EMessageCharacter.op,message:"The enemy is attacking!"}),this.game.cash[n.Team.green]+=50,this.game.processOrder({uids:[i.uid],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"attack",to:t},unitUid:-3}})):this.endMission({success:!1})}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.getItemByUid(-3)),action:()=>{},insertTrigger:{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-3]),action:()=>{const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.SCV&&e.team===this.game.team));null!=e&&(this.game.clearSelection(!0),e.commands=[m.ECommandName.moveFollow,m.ECommandName.patrol,m.ECommandName.buildStarport],this.game.cash[n.Team.blue]+=200,this.game.showMessage({character:d.EMessageCharacter.op,message:"SCV can build a Starport to produce military units.\nSelect SCV and build a Starport on the right side of the main base"}))}}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===this.game.team))),action:()=>{this.game.clearSelection(!0);const e=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===this.game.team));if(null!=e){const t=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.SCV&&e.team===this.game.team));null!=t&&(t.commands=[m.ECommandName.moveFollow,m.ECommandName.patrol]),this.game.showMessage({character:d.EMessageCharacter.op,message:"Starport has been built, please select the star port and build a Scout Tank and a Chopper."}),e.commands=[m.ECommandName.constructScoutTank,m.ECommandName.constructChopper]}}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.ScoutTank&&e.team===this.game.team));return Boolean(e)},action:()=>{this.game.clearSelection(!0);const e=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===this.game.team));if(null!=e){const t=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.Chopper&&e.team===this.game.team));e.commands=null==t?[m.ECommandName.constructChopper]:[]}}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.Chopper&&e.team===this.game.team));return Boolean(e)},action:()=>{this.game.clearSelection(!0);const e=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===this.game.team));if(null!=e){const t=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.ScoutTank&&e.team===this.game.team));e.commands=null==t?[m.ECommandName.constructScoutTank]:[]}}},{type:l.ETriggerType.conditional,condition:()=>{const e=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.ScoutTank&&e.team===this.game.team)),t=this.game.tileMap.moveableItems.find((e=>e.itemName===c.EItemName.Chopper&&e.team===this.game.team));return Boolean(e)&&Boolean(t)},action:()=>{this.game.showMessage({character:d.EMessageCharacter.op,message:"There is an enemy on the right side of the map, destroy the enemy unit!"});const e=this.game.tileMap.staticItems.find((e=>e.itemName===c.EItemName.Starport&&e.team===n.Team.green));null!=e&&(this.game.cash[n.Team.green]+=50,this.game.processOrder({uids:[e.uid],order:{type:"construct-unit",name:c.EItemName.ScoutTank,unitOrder:{type:"patrol",fromPoint:{gridX:58,gridY:10},toPoint:{gridX:51,gridY:10}},unitUid:-4}}))}},{type:l.ETriggerType.conditional,condition:()=>Boolean(this.game.tileMap.getItemByUid(-4)),action:()=>{},insertTrigger:{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-4]),action:()=>{this.game.clearSelection(!0),this.game.showMessage({character:d.EMessageCharacter.op,message:"Well done! Destroy enemy base!"}),this.game.cash[n.Team.green]+=200,this.game.tileMap.activeItems.children.forEach((e=>{if(e.team===this.game.team)switch(e.itemName){case c.EItemName.Base:e.commands=[m.ECommandName.constructSCV,m.ECommandName.constructHarvester];break;case c.EItemName.SCV:e.commands=[m.ECommandName.moveFollow,m.ECommandName.patrol,m.ECommandName.buildTurret,m.ECommandName.buildStarport];break;case c.EItemName.Starport:e.commands=[m.ECommandName.constructScoutTank,m.ECommandName.constructHeavyTank,m.ECommandName.constructChopper,m.ECommandName.constructWraith]}})),this.game.ai=new w.AI({game:this.game,team:n.Team.green})}}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-1]),action:()=>{this.endMission({success:!1})}},{type:l.ETriggerType.conditional,condition:()=>this.game.tileMap.isItemsDead([-2]),action:()=>{this.endMission({success:!0})}}]}]}endMission({success:e}){const t=this.currentMissionIdx===this.missions.length-1;this.game.endGame({success:e,message:e?t?"Mission Accomplished!\nThis was the last mission in the campaign.\nThank You for playing.":"Mission Accomplished!\nReady for new mission?":"Mission Failed.\nTry again?",view:e?t?"home":"home-next":"home-repeat",onLeftClick:()=>{r.SceneManager.changeScene({name:"menu"}).catch(console.error)},onRightClick:()=>{e&&!t&&this.currentMissionIdx++,this.startCurrentLevel()}})}}x.options={startMission:0},t.CampaignScene=x},23266:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoaderScene=t.manifest=void 0;const s=i(58687),r=i(36645);t.manifest={bundles:[{name:"initial-bundle",assets:{spritesheet:"assets/spritesheets/spritesheet.json",menuBackground:"assets/images/splashscreen.png",level1Background:"assets/levels/level-1.png",level1Settings:"assets/levels/level-1.json"}},{name:"characters-bundle",assets:{characterGirl1:"assets/images/character-girl-1.png",characterGirl2:"assets/images/character-girl-2.png",characterMan1:"assets/images/character-man-1.png",characterSystem:"assets/images/character-system.png"}},{name:"level-2-bundle",assets:{level2Background:"assets/levels/level-2.png",level2Settings:"assets/levels/level-2.json"}}]};class o extends s.Container{constructor(e){super(),this.downloadProgress=e=>{this.loaderBarFill.width=(o.barOptions.width-2*o.barOptions.borderThick)*e},this.setup(),this.draw(),this.loaderBarFill.width=10}setup(){const e=new s.Graphics;this.addChild(e),this.loaderBarBorder=e;const t=new s.Graphics;this.addChild(t),this.loaderBarFill=t}draw(){const{barOptions:e}=o,{loaderBarFill:t,loaderBarBorder:i}=this;i.beginFill(e.borderColor),i.drawRoundedRect(0,0,e.width,e.height,e.borderRadius),i.endFill(),t.beginFill(e.fillColor),t.position.set(e.borderThick,e.borderThick),t.drawRoundedRect(0,0,e.width-2*e.borderThick,e.height-2*e.borderThick,e.borderRadius),t.endFill()}async initializeLoader(){await s.Assets.init({manifest:t.manifest}),await s.Assets.loadBundle(t.manifest.bundles[0].name,this.downloadProgress)}getAssets(){return{spritesheet:s.Assets.get("spritesheet"),menuBackground:s.Assets.get("menuBackground")}}handleResize({viewWidth:e,viewHeight:t}){const i=e,s=t,n=this.width,a=this.height;if(i>=n&&s>=a){const e=i>n?(i-n)/2:0,t=s>a?(s-a)/2:0;(0,r.logLayout)(`Spacing aw=${i} tw=${n} ah=${s} th=${a}`),this.x=e,this.width=o.barOptions.width,this.y=t,this.height=o.barOptions.height}else{let e=1;a>=n?(e=s/a,e*n>i&&(e=i/n),(0,r.logLayout)(`By height (sc=${e})`)):(e=i/n,(0,r.logLayout)(`By width (sc=${e})`),e*a>s&&(e=s/a));const t=Math.floor(n*e),o=Math.floor(a*e),h=i>t?(i-t)/2:0,d=s>o?(s-o)/2:0;(0,r.logLayout)(`aw=${i} (ow=${t}) ah=${s} (oh=${o})`),this.x=h,this.width=t,this.y=d,this.height=o}(0,r.logLayout)(`x=${this.x} y=${this.y} w=${this.width} h=${this.height}`)}handleMounted(){}handleUpdate(){}}o.barOptions={width:350,height:40,fillColor:1588688,borderRadius:5,borderThick:5,borderColor:0},t.LoaderScene=o},54462:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MenuScene=void 0;const s=i(58687),r=i(9678),o=i(36645),n=i(39618),a=i(76385),h=i(80224),d=i(70519),l=i(32419),c=i(69221),u=i(53555),m=i(48599),p=i(76789);class g extends s.Container{}class w extends s.Container{}class f extends n.Button{}class b extends s.Container{constructor(e){super(),this.audio=new p.Audio,this.gravity=.7,this.gameEnded=!1,this.content=new g,this.choices=new w,this.drawMainOptions=()=>{this.clearFromAll();const e={text:"",fontSize:48,textColor:16777215,textColorHover:16776960,shadowTextColor:8388736,shadowThickness:2,buttonSelectedAlpha:0,buttonIdleAlpha:0,buttonHoverAlpha:0},t=new n.Button({onClick:this.drawMissionOptions,...e,text:"Campaign"});this.choices.addChild(t);const i=new n.Button({onClick:this.goToVersusCPUScene,...e,text:"Versus CPU"});this.choices.addChild(i),i.position.set(0,t.height)},this.drawMissionOptions=()=>{this.clearFromAll();const e=s.Assets.get("spritesheet"),{textures:t}=e,i={text:"",fontSize:32,textColor:16777215,textColorHover:16776960,shadowTextColor:8388736,shadowThickness:2,buttonIdleAlpha:0,buttonSelectedAlpha:0,buttonHoverAlpha:0},r=new n.Button({iconTexture:t["icon-home.png"],onClick:this.drawMainOptions,...i,text:"Home",buttonWidth:200,buttonHeight:50,iconScale:1,iconColor:16777215,iconColorHover:16776960,fontSize:48});this.choices.addChild(r),[0,1,2,3].forEach((e=>{const t=new n.Button({onClick:()=>{this.goToCampaignScene(e)},...i,text:`Mission ${e+1}`});t.position.set(0,this.choices.height),this.choices.addChild(t)}))},this.goToCampaignScene=e=>{null==this.game&&(this.game=new c.Game({viewWidth:r.SceneManager.width,viewHeight:r.SceneManager.height,type:"campaign",team:u.Team.blue,audio:this.audio})),r.SceneManager.changeScene({name:"campaign",newScene:new h.CampaignScene({app:r.SceneManager.app,game:this.game,viewWidth:r.SceneManager.width,viewHeight:r.SceneManager.height,missionIdx:e}),initialResize:!1}).catch(console.error)},this.goToVersusCPUScene=()=>{null==this.game&&(this.game=new c.Game({viewWidth:r.SceneManager.width,viewHeight:r.SceneManager.height,type:"singleplayer",team:u.Team.blue,audio:this.audio})),r.SceneManager.changeScene({name:"versusCPU",newScene:new l.VersusCPUScene({app:r.SceneManager.app,game:this.game,viewWidth:r.SceneManager.width,viewHeight:r.SceneManager.height}),initialResize:!1}).catch(console.error)},this.setup(e),this.drawMainOptions(),setTimeout((()=>{a.TileMap.idleLoad().then((()=>{d.StatusBar.prepareTextures({textures:{girl1Texture:s.Assets.get("characterGirl1"),girl2Texture:s.Assets.get("characterGirl2"),man1Texture:s.Assets.get("characterMan1"),systemTexture:s.Assets.get("characterSystem")}})})).catch(console.error)}))}setup({menuTexture:e}){this.addChild(this.content);const t=new s.Sprite(e);this.content.addChild(t),this.background=t,this.content.addChild(this.choices);const{textures:i}=s.Assets.get("spritesheet");this.settingsButton=new f({text:"",textColor:16777215,iconColor:16777215,iconColorHover:16776960,iconPaddingLeft:10,iconPaddingTop:10,buttonWidth:75,buttonHeight:65,buttonIdleColor:4539717,buttonBorderColor:16777215,buttonBorderHoverColor:16776960,buttonBorderWidth:1,buttonRadius:10,iconTexture:i["icon-gears.png"],onClick:()=>{this.disableInteractivity(),this.settingsModal.showModal()}}),this.content.addChild(this.settingsButton),m.SettingsModal.prepareTextures({textures:{iconHomeTexture:i["icon-home.png"],iconVolumeOffTexture:i["icon-volume-off.png"],iconVolumeLowTexture:i["icon-volume-low.png"],iconVolumeMiddleTexture:i["icon-volume-middle.png"],iconVolumeHighTexture:i["icon-volume-high.png"],iconCircleXMarkTexture:i["icon-circle-xmark.png"],iconCircleCheckTexture:i["icon-circle-check.png"],iconGearsTexture:i["icon-gears.png"]}});const o=new m.SettingsModal({audio:this.audio,viewWidth:r.SceneManager.width,viewHeight:r.SceneManager.height,onHomeClick:()=>{console.log("onHomeClick")},onClosed:()=>{this.enableInteractivity()}});this.settingsModal=o}clearFromAll(){for(;this.choices.children.length>0;)this.choices.children[0].removeFromParent()}handleResize({viewWidth:e,viewHeight:t}){const i=e,s=t,{width:r,height:n}=this.background.texture,a=r,h=n;let d=1;h>=a?s<h&&(d=s/h,d*a>i&&(d=i/a),(0,o.logLayout)(`By height (sc=${d})`)):i<a&&(d=i/a,d*h>s&&(d=s/h),(0,o.logLayout)(`By width (sc=${d})`));const l=Math.floor(a*d),c=Math.floor(h*d),u=i>l?(i-l)/2:0,m=s>c?(s-c)/2:0;(0,o.logLayout)(`aw=${i} (ow=${l}) x=${u} ah=${s} (oh=${c}) y=${m}`),this.content.x=u,this.background.width=l,this.content.y=m,this.background.height=c,(0,o.logLayout)(`x=${u} y=${m} w=${this.width} h=${this.height}`);const{offset:p}=b.options.settingsButton;this.settingsButton.position.set(p.x,p.y*d);const{mainOffset:g}=b.options.choices;this.choices.position.set(g.x,(n-g.y)*d),this.settingsModal.handleResize({viewWidth:e,viewHeight:t})}handleUpdate(e){}mountedHandler(){this.addChild(this.settingsModal),this.settingsModal.hideModal()}enableInteractivity(){this.settingsButton.eventMode="static",this.choices.interactiveChildren=!0}disableInteractivity(){this.settingsButton.eventMode="none",this.choices.interactiveChildren=!1}}b.options={choices:{mainOffset:{x:50,y:320},missionOffset:{x:50,y:50}},settingsButton:{offset:{x:50,y:20}}},t.MenuScene=b},9678:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneManager=void 0;const s=i(58687),r=i(36645);class o extends s.Container{init(){}handleUpdate(){}handleResize(){}}class n{constructor(){}static get width(){return window.innerWidth}static get height(){return window.innerHeight}static async initialize(){var e;const t=new s.Application({autoDensity:!0,resolution:null!==(e=window.devicePixelRatio)&&void 0!==e?e:1,width:n.width,height:n.height,resizeTo:window});document.body.appendChild(t.view),r.logApp.enabled&&((0,r.logApp)("window.app initialized!"),window.app=t),n.app=t,n.setupEventLesteners()}static setupEventLesteners(){window.addEventListener("resize",n.resizeDeBounce),n.app.ticker.add(n.updateHandler)}static async changeScene({name:e,newScene:t,initialResize:i=!0}){if(null!=t?n.scenes.has(e)||n.scenes.set(e,t):t=n.scenes.get(e),null==t)throw new Error("Unable to detect new scene");n.app.stage.removeChild(n.currentScene),n.currentScene=t,n.app.stage.addChild(n.currentScene),i&&n.resizeHandler(),"function"==typeof t.mountedHandler&&t.mountedHandler()}static resizeDeBounce(){n.cancelScheduledResizeHandler(),n.scheduleResizeHandler()}static cancelScheduledResizeHandler(){clearTimeout(n.resizeTimeoutId)}static scheduleResizeHandler(){n.resizeTimeoutId=setTimeout((()=>{n.cancelScheduledResizeHandler(),n.resizeHandler()}),n.resizeTimeout)}static resizeHandler(){n.currentScene.handleResize({viewWidth:n.width,viewHeight:n.height})}static updateHandler(){n.currentScene.handleUpdate(n.app.ticker.deltaMS)}}n.currentScene=new o,n.resizeTimeout=300,n.scenes=new Map,t.SceneManager=n},32419:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VersusCPUScene=void 0;const s=i(58687),r=i(9678),o=i(53555),n=i(70519),a=i(65078),h=i(42097),d=i(82241),l=i(36645);class c extends s.Container{constructor(e){super(),this.triggers=[],this.setup(e)}setup({viewWidth:e,viewHeight:t,game:i}){i.viewWidth=e,i.viewHeight=t,i.team=o.Team.blue,i.type="singleplayer",this.game=i}handleResize(e){this.game.handleResize(e)}handleUpdate(e){this.game.handleUpdate(e),this.game.gameEnded||(0,a.handleTiggers)({deltaMS:e,triggers:this.triggers})}start(){this.triggers=[{type:a.ETriggerType.conditional,condition:()=>0===this.game.tileMap.staticItems.filter((e=>e.team===this.game.team)).length,action:()=>{this.endVersus({success:!1})}},{type:a.ETriggerType.conditional,condition:()=>0===this.game.tileMap.staticItems.filter((e=>e.team===o.Team.green)).length,action:()=>{this.endVersus({success:!0})}}].map((e=>(0,a.createTrigger)(e))),this.game.startGame({mapImageSrc:"level2Background",mapSettingsSrc:"level2Settings",startGridX:2,startGridY:37}),[{name:h.EItemName.Base,initGridX:2,initGridY:36,team:o.Team.blue},{name:h.EItemName.Base,initGridX:56,initGridY:2,team:o.Team.green}].forEach((e=>{const t=this.game.createItem(e);null!=t&&this.game.tileMap.addItem(t)})),this.game.tileMap.rebuildBuildableGrid(),this.game.cash[o.Team.blue]=1600,this.game.cash[o.Team.green]=1600,(0,l.logCash)(`(${this.game.team}) initial b=${this.game.cash.blue} g=${this.game.cash.green}`),this.game.showMessage({character:n.EMessageCharacter.system,message:"Versus CPU",playSound:!1}),this.game.ai=new d.AI({game:this.game,team:o.Team.green})}mountedHandler(){this.addChild(this.game),this.start()}endVersus({success:e}){this.game.endGame({success:e,message:e?"You win!\nOne more time?":"You lose...\nTry again?",view:"home-repeat",onLeftClick:()=>{r.SceneManager.changeScene({name:"menu"}).catch(console.error)},onRightClick:()=>{this.start()}})}}t.VersusCPUScene=c},82241:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AI=void 0;const s=i(30332),r=i(60231),o=i(54536),n=i(46667),a=i(41759),h=i(28807),d=i(42097),l=i(36645),c=i(9498),u=i(22273),m=i(22591),p=i(33244);class g{constructor(){this.count=0,this.uids=[],this.items=[],this.idDic={},this.pickedUids=[]}account(e){this.count++,this.uids.push(e.uid),this.items.push(e),this.idDic[e.uid]=e}one(){return[this.items[Math.floor(Math.random()*this.items.length)]]}other(e=!1){const t=this.items.filter((e=>!this.pickedUids.includes(e.uid)));if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];return this.pickedUids.push(e.uid),[e]}return e?[]:this.one()}}class w extends g{constructor(){super(...arguments),this.items=[]}one(){const e=this.items.filter((e=>!e.isConstructing()));return e.length>0?[e[Math.floor(Math.random()*e.length)]]:[this.items[Math.floor(Math.random()*this.items.length)]]}other(e=!1){const t=this.items.filter((e=>!e.isConstructing()&&!this.pickedUids.includes(e.uid)));if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];return this.pickedUids.push(e.uid),[e]}return e?[]:this.one()}}class f extends g{constructor(){super(...arguments),this.items=[]}one(){const e=this.items.filter((e=>e.isIdle()));return e.length>0?[e[Math.floor(Math.random()*e.length)]]:[this.items[Math.floor(Math.random()*this.items.length)]]}other(e=!1){const t=this.items.filter((e=>e.isIdle()&&!this.pickedUids.includes(e.uid)));if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];return this.pickedUids.push(e.uid),[e]}return e?[]:this.one()}}class b{constructor({game:e,team:t}){this.elapsedFrames=0,this.calcOrdersEachFrame=100,this.game=e,this.team=t}static getNewStat(){return{buildings:{[d.EItemName.Base]:new w,[d.EItemName.OilDerrick]:new g,[d.EItemName.Starport]:new f,[d.EItemName.GroundTurret]:new g},groundVehicles:{[d.EItemName.SCV]:new g,[d.EItemName.Harvester]:new g,[d.EItemName.ScoutTank]:new g,[d.EItemName.HeavyTank]:new g},airVehicles:{[d.EItemName.Chopper]:new g,[d.EItemName.Wraith]:new g}}}collectStat(){this.stat=b.getNewStat();const{activeItems:e}=this.game.tileMap;for(let t=0;t<e.children.length;t++){const i=e.children[t];if(i.team===this.team)switch(i.itemName){case"base":this.stat.buildings.base.account(i);break;case"oil-derrick":this.stat.buildings["oil-derrick"].account(i);break;case"ground-turret":this.stat.buildings["ground-turret"].account(i);break;case"starport":this.stat.buildings.starport.account(i);break;case"harvester":this.stat.groundVehicles.harvester.account(i);break;case"scv":this.stat.groundVehicles.scv.account(i);break;case"scout-tank":this.stat.groundVehicles["scout-tank"].account(i);break;case"heavy-tank":this.stat.groundVehicles["heavy-tank"].account(i);break;case"chopper":this.stat.airVehicles.chopper.account(i);break;case"wraith":this.stat.airVehicles.wraith.account(i)}}}get attackableUnitCount(){const{stat:e}=this;return e.groundVehicles["scout-tank"].count+e.groundVehicles["heavy-tank"].count+e.airVehicles.chopper.count+e.airVehicles.wraith.count}get cash(){return this.game.cash[this.team]}handleUpdate(e){this.elapsedFrames>=this.calcOrdersEachFrame?(this.elapsedFrames=0,this.calcOrders()):this.elapsedFrames+=1}calcMainOrders(){const{stat:{buildings:{base:e,"oil-derrick":t},groundVehicles:{harvester:i}},attackableUnitCount:s,cash:r}=this,{currentMapBuildableGrid:o}=this.game.tileMap,a=[{gridX:51,gridY:2},{gridX:51,gridY:29},{gridX:31,gridY:38},{gridX:30,gridY:17}].map((e=>(0,h.calcBuildablePoints)({buildableGrid:n.OilDerrick.buildableGrid,...e}))).filter((e=>e.every((({gridX:e,gridY:t})=>0===o[t][e])))).map((e=>e[0]));if(a.length>0){if(0===t.count&&0===i.count&&r>=c.Harvester.cost)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Harvester,unitOrder:{type:"deploy",toPoint:a[0]}}}),(0,l.logAI)(`calcMainOrders(${r}) 1`),!0;if(1===t.count&&0===i.count&&r>=1.2*c.Harvester.cost&&s>8)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Harvester,unitOrder:{type:"deploy",toPoint:a[0]}}}),(0,l.logAI)(`calcMainOrders(${r}) 2`),!0;if(2===t.count&&0===i.count&&r>=1.4*c.Harvester.cost&&s>12)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Harvester,unitOrder:{type:"deploy",toPoint:a[0]}}}),(0,l.logAI)(`calcMainOrders(${r}) 3`),!0;if(3===t.count&&0===i.count&&r>=2*c.Harvester.cost&&s>14)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Harvester,unitOrder:{type:"deploy",toPoint:a[0]}}}),(0,l.logAI)(`calcMainOrders(${r}) 4`),!0;i.count>0&&(this.game.processOrder({items:i.one(),order:{type:"deploy",toPoint:a[0]}}),(0,l.logAI)(`calcMainOrders(${r}) 5`))}return!1}calcSecondaryOrders(){const{stat:{buildings:{base:e,starport:t},groundVehicles:{scv:i}},attackableUnitCount:s,cash:r}=this,{currentMapBuildableGrid:o}=this.game.tileMap,n=[{gridX:53,gridY:6},{gridX:58,gridY:6}].map((e=>(0,h.calcBuildablePoints)({buildableGrid:a.Starport.buildableGrid,...e}))).filter((e=>e.every((({gridX:e,gridY:t})=>0===o[t][e])))).map((e=>e[0]));if(0===i.count&&r>=m.SCV.cost)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.SCV,unitOrder:{type:"move",toPoint:{gridX:59,gridY:4}}}}),(0,l.logAI)(`calcSecondaryOrders(${r}) 1`),!0;if(n.length>0){if(1===i.count&&0===t.count&&r>=a.Starport.cost)return this.game.processOrder({items:i.one(),order:{type:"build",name:d.EItemName.Starport,toPoint:n[0]}}),(0,l.logAI)(`calcSecondaryOrders(${r}) 2`),!0;if(1===i.count&&1===t.count&&r>=1.5*a.Starport.cost&&s>8)return this.game.processOrder({items:i.one(),order:{type:"build",name:d.EItemName.Starport,toPoint:n[0]}}),(0,l.logAI)(`calcSecondaryOrders(${r}) 3`),!0}return!1}calcAttackableOrders(){const{stat:{buildings:{starport:e},groundVehicles:{"scout-tank":t,"heavy-tank":i},airVehicles:{chopper:s,wraith:r}},cash:o}=this;return 0===s.count?(this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Chopper,unitOrder:{type:"patrol",fromPoint:{gridX:57,gridY:9},toPoint:{gridX:52,gridY:12}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 1`),!0):0===r.count?(this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Wraith,unitOrder:{type:"patrol",fromPoint:{gridX:58,gridY:10},toPoint:{gridX:51,gridY:10}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 2`),!0):1===s.count&&1===r.count?(this.game.processOrder({items:e.other(),order:{type:"construct-unit",name:d.EItemName.Chopper,unitOrder:{type:"patrol",fromPoint:{gridX:51,gridY:3},toPoint:{gridX:58,gridY:3}}}}),this.game.processOrder({items:e.other(),order:{type:"construct-unit",name:d.EItemName.Wraith,unitOrder:{type:"patrol",fromPoint:{gridX:51,gridY:3},toPoint:{gridX:58,gridY:3}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 3`),!0):0===i.count?(this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.HeavyTank,unitUid:-324,unitOrder:{type:"patrol",fromPoint:{gridX:54,gridY:12},toPoint:{gridX:54,gridY:14}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 4`),!0):1===i.count?(this.game.processOrder({items:e.other(),order:{type:"construct-unit",name:d.EItemName.HeavyTank,unitOrder:{type:"move-and-attack",toPoint:{gridX:50,gridY:14}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 5`),!0):t.count<3&&o>=p.ScoutTank.cost&&(this.game.processOrder({items:e.other(!0),order:{type:"construct-unit",name:d.EItemName.ScoutTank,unitOrder:{type:"move-and-attack",toPoint:{gridX:51,gridY:15}}}}),(0,l.logAI)(`calcAttackableOrders(${o}) 6`),!0)}calcFortificationOrders(){const{stat:{buildings:{"ground-turret":e},groundVehicles:{scv:t}},cash:i}=this,{currentMapBuildableGrid:s}=this.game.tileMap,r=[{gridX:50,gridY:9},{gridX:52,gridY:11},{gridX:55,gridY:11},{gridX:58,gridY:11}].map((e=>(0,h.calcBuildablePoints)({buildableGrid:o.GroundTurret.buildableGrid,...e}))).filter((e=>e.every((({gridX:e,gridY:t})=>0===s[t][e])))).map((e=>e[0]));if(1===t.count&&i>=o.GroundTurret.cost&&r.length>0){if(0===e.count)return this.game.processOrder({items:t.one(),order:{type:"build",name:d.EItemName.GroundTurret,toPoint:r[0]}}),(0,l.logAI)(`calcFortificationOrders(${i}) 1`),!0;if(1===e.count&&i>=1.2*o.GroundTurret.cost)return this.game.processOrder({items:t.one(),order:{type:"build",name:d.EItemName.GroundTurret,toPoint:r[0]}}),(0,l.logAI)(`calcFortificationOrders(${i}) 2`),!0;if(2===e.count&&i>=1.4*o.GroundTurret.cost)return this.game.processOrder({items:t.one(),order:{type:"build",name:d.EItemName.GroundTurret,toPoint:r[0]}}),(0,l.logAI)(`calcFortificationOrders(${i}) 3`),!0;if(3===e.count&&i>=2*o.GroundTurret.cost)return this.game.processOrder({items:t.one(),order:{type:"build",name:d.EItemName.GroundTurret,toPoint:r[0]}}),(0,l.logAI)(`calcFortificationOrders(${i}) 4`),!0}return!1}calcWaveOrders(){const{stat:{buildings:{"ground-turret":e},groundVehicles:{"scout-tank":t,"heavy-tank":i},airVehicles:{chopper:s,wraith:r}},cash:o}=this,n=Math.random();return t.count>=3&&i.count>=3&&o>50&&n>=.6?(this.game.processOrder({items:t.items,order:{type:"move-and-attack",toPoint:{gridX:0,gridY:39}}}),this.game.processOrder({items:i.items,order:{type:"move-and-attack",toPoint:{gridX:0,gridY:39}}}),(0,l.logAI)(`calcWaveOrders(${o}) 1`),!0):s.count>=3&&r.count>=5&&o>100&&e.count>=2&&n>=.9&&(this.game.processOrder({items:s.items,order:{type:"move-and-attack",toPoint:{gridX:0,gridY:39}}}),this.game.processOrder({items:r.items,order:{type:"move-and-attack",toPoint:{gridX:0,gridY:39}}}),(0,l.logAI)(`calcWaveOrders(${o}) 2`),!0)}calcRandomOrders(){const{stat:{buildings:{starport:e}},cash:t}=this,i=Math.random(),o=1+3*Math.random();if(i<.1){if(t>=s.Chopper.cost*o)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Chopper,unitOrder:{type:"patrol",fromPoint:{gridX:50,gridY:2},toPoint:{gridX:58,gridY:15}}}}),(0,l.logAI)(`calcRandomOrders(${t}) 1`),!0}else if(i<.3){if(t>=r.Wraith.cost*o)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.Wraith,unitOrder:{type:"patrol",fromPoint:{gridX:51,gridY:3},toPoint:{gridX:57,gridY:15}}}}),(0,l.logAI)(`calcRandomOrders(${t}) 2`),!0}else if(i<.6){if(t>=u.HeavyTank.cost*o)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.HeavyTank,unitOrder:{type:"move-and-attack",toPoint:{gridX:55,gridY:17}}}}),(0,l.logAI)(`calcRandomOrders(${t}) 3`),!0}else if(i<.9&&t>=p.ScoutTank.cost*o)return this.game.processOrder({items:e.one(),order:{type:"construct-unit",name:d.EItemName.ScoutTank,unitOrder:{type:"move-and-attack",toPoint:{gridX:52,gridY:18}}}}),(0,l.logAI)(`calcRandomOrders(${t}) 4`),!0;return!1}calcOrders(){this.collectStat(),this.calcMainOrders()||this.calcSecondaryOrders()||this.calcAttackableOrders()||this.calcFortificationOrders()||this.calcWaveOrders()||this.calcRandomOrders()||(0,l.logAI)(`calcOrders(${this.cash})`)}}t.AI=b},13476:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AStar=void 0;class i{static diagonalSuccessors({$N:e,$S:t,$E:i,$W:s,N:r,S:o,E:n,W:a,grid:h,result:d,i:l}){return e&&(i&&0===h[r][n]&&(d[l++]={x:n,y:r}),s&&0===h[r][a]&&(d[l++]={x:a,y:r})),t&&(i&&0===h[o][n]&&(d[l++]={x:n,y:o}),s&&0===h[o][a]&&(d[l++]={x:a,y:o})),d}static diagonalSuccessorsFree({$N:e,$S:t,$E:i,$W:s,N:r,S:o,E:n,W:a,grid:h,rows:d,cols:l,result:c,i:u}){return e=r>-1,t=o<d,s=a>-1,n<l&&(e&&0===h[r][n]&&(c[u++]={x:n,y:r}),t&&0===h[o][n]&&(c[u++]={x:n,y:o})),s&&(e&&0===h[r][a]&&(c[u++]={x:a,y:r}),t&&0===h[o][a]&&(c[u++]={x:a,y:o})),c}static nothingToDo({result:e}){return e}static successors({find:e,x:t,y:i,grid:s,rows:r,cols:o}){const n=i-1,a=i+1,h=t+1,d=t-1,l=n>-1&&0===s[n][t],c=a<r&&0===s[a][t],u=h<o&&0===s[i][h],m=d>-1&&0===s[i][d],p=[];let g=0;return l&&(p[g++]={x:t,y:n}),u&&(p[g++]={x:h,y:i}),c&&(p[g++]={x:t,y:a}),m&&(p[g++]={x:d,y:i}),e({$N:l,$S:c,$E:u,$W:m,N:n,S:a,E:h,W:d,grid:s,rows:r,cols:o,result:p,i:g})}static diagonal({start:e,end:t,f1:i,f2:s}){return s(i(e.x-t.x),i(e.y-t.y))}static euclidean({start:e,end:t,f2:i}){const s=e.x-t.x,r=e.y-t.y;return i(s*s+r*r)}static manhattan({start:e,end:t,f1:i}){return i(e.x-t.x)+i(e.y-t.y)}static calc({grid:e,start:t,end:s,f:r}){const o=e[0].length,n=e.length,a=o*n,h=Math.abs;let d=Math.max;const l={},c=[],u=[{x:t.gridX,y:t.gridY,f:0,g:0,v:t.gridX+t.gridY*o}];let m,p,g,w,f,b,y,x,T,v=1;const C={x:s.gridX,y:s.gridY,v:s.gridX+s.gridY*o};switch(r){case"Diagonal":case"DiagonalFree":g=i.diagonalSuccessors,p=i.diagonal;break;case"Euclidean":case"EuclideanFree":d=Math.sqrt,g=i.diagonalSuccessors,p=i.euclidean;break;default:d=Math.sqrt,p=i.manhattan,g=i.nothingToDo}null!=g||(g=i.diagonalSuccessorsFree);do{for(b=a,y=0,w=0;w<v;++w){const e=u[w].f;e<b&&(b=e,y=w)}if(x=u.splice(y,1)[0],x.v!==C.v)for(--v,T=i.successors({find:g,x:x.x,y:x.y,grid:e,rows:n,cols:o}),w=0,f=T.length;w<f;++w)m={x:T[w].x,y:T[w].y,f:0,g:0,v:T[w].x+T[w].y*o,p:x},m.v in l||(m.f=(m.g=x.g+p({start:m,end:x,f1:h,f2:d}))+p({start:m,end:C,f1:h,f2:d}),u[v++]=m,l[m.v]=1);else{w=v=0;do{c[w++]={x:x.x,y:x.y}}while(null!=(x=x.p));c.reverse()}}while(v>0);return c}}t.AStar=i},76789:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Audio=void 0;const r=i(41766),o=s(i(18178)),n=s(i(33209)),a=s(i(66844)),h=s(i(56851)),d=s(i(88602)),l=s(i(62980)),c=s(i(32704)),u=s(i(29376)),m=s(i(17822)),p=s(i(9748)),g=s(i(31040)),w=s(i(85286)),f=s(i(92044)),b=s(i(2254)),y=s(i(97574)),x=s(i(43987)),T=s(i(55802)),v=s(i(22763)),C=s(i(57976)),S=s(i(48523)),M=s(i(155)),k=s(i(24434)),A=s(i(72634)),E=s(i(39345)),I=s(i(9275)),Y=s(i(10651)),P=s(i(96955)),B=s(i(40978)),G=s(i(36707)),X=s(i(35061)),R=s(i(75367)),O=s(i(64844)),L=s(i(55563)),H=s(i(14389)),D=s(i(13481)),N=s(i(66349)),V=s(i(13722)),F=s(i(32923)),W=s(i(71689)),_=s(i(49180)),z=s(i(44147)),$=s(i(81998)),j=s(i(62657)),U=s(i(20888)),q=s(i(42792)),Z=s(i(86947)),J=s(i(86231)),K=s(i(45234)),Q=s(i(95644)),ee=s(i(25728)),te=s(i(75410)),ie=s(i(29799)),se=s(i(25670)),re=s(i(56141)),oe=s(i(25236)),ne=s(i(44727)),ae=s(i(95384)),he=s(i(89422)),de=s(i(24057)),le=s(i(1117)),ce=s(i(48665)),ue=s(i(73264)),me=s(i(53512)),pe=s(i(3886)),ge=s(i(3631)),we=s(i(83668)),fe=s(i(77542)),be=s(i(4259)),ye=s(i(32558)),xe=s(i(54909)),Te=s(i(47724)),ve=s(i(48356)),Ce=i(42097);class Se{constructor(){this.initialVoiceVolume=1,this.initialShootVolume=1,this.initialHitVolume=1,this.initialMessageVolume=1,this.voiceVolume=1,this.shootVolume=1,this.hitVolume=1,this.messageVolume=1,this.bullet1=new r.Howl({src:o.default}),this.bullet2=new r.Howl({src:n.default}),this.bulletHit0=new r.Howl({src:a.default}),this.bulletHit1=new r.Howl({src:h.default}),this.bulletHit2=new r.Howl({src:d.default}),this.bulletHit3=new r.Howl({src:l.default}),this.bulletHit4=new r.Howl({src:c.default}),this.bulletHit5=new r.Howl({src:u.default}),this.cannon1=new r.Howl({src:m.default}),this.cannon2=new r.Howl({src:p.default}),this.cannonHit=new r.Howl({src:g.default}),this.click=new r.Howl({src:w.default}),this.engaging=new r.Howl({src:f.default}),this.gun=new r.Howl({src:b.default}),this.heatseeker1=new r.Howl({src:y.default}),this.heatseeker2=new r.Howl({src:x.default}),this.rocketHit0=new r.Howl({src:T.default}),this.laser1=new r.Howl({src:v.default}),this.laser2=new r.Howl({src:C.default}),this.laserHit0=new r.Howl({src:S.default}),this.message0=new r.Howl({src:M.default}),this.message1=new r.Howl({src:k.default}),this.messageError0=new r.Howl({src:A.default}),this.roger1=new r.Howl({src:E.default}),this.roger2=new r.Howl({src:I.default}),this.yup=new r.Howl({src:Y.default}),this.vultureAttack0=new r.Howl({src:P.default}),this.vultureYes0=new r.Howl({src:B.default}),this.vultureYes1=new r.Howl({src:G.default}),this.vultureYes2=new r.Howl({src:X.default}),this.vultureYes3=new r.Howl({src:R.default}),this.tankAttack0=new r.Howl({src:O.default}),this.tankAttack1=new r.Howl({src:L.default}),this.tankAttack2=new r.Howl({src:H.default}),this.tankYes0=new r.Howl({src:D.default}),this.tankYes1=new r.Howl({src:N.default}),this.tankYes2=new r.Howl({src:V.default}),this.tankYes3=new r.Howl({src:F.default}),this.chopperYes0=new r.Howl({src:$.default}),this.chopperYes1=new r.Howl({src:j.default}),this.chopperYes2=new r.Howl({src:U.default}),this.chopperYes3=new r.Howl({src:q.default}),this.chopperYes4=new r.Howl({src:Z.default}),this.chopperYes5=new r.Howl({src:J.default}),this.chopperAttack0=new r.Howl({src:W.default}),this.chopperAttack1=new r.Howl({src:_.default}),this.chopperAttack2=new r.Howl({src:z.default}),this.wraithYes0=new r.Howl({src:ie.default}),this.wraithYes1=new r.Howl({src:se.default}),this.wraithYes2=new r.Howl({src:re.default}),this.wraithYes3=new r.Howl({src:oe.default}),this.wraithAttack0=new r.Howl({src:K.default}),this.wraithAttack1=new r.Howl({src:Q.default}),this.wraithAttack2=new r.Howl({src:ee.default}),this.wraithAttack3=new r.Howl({src:te.default}),this.scvYes0=new r.Howl({src:ne.default}),this.scvYes1=new r.Howl({src:ae.default}),this.scvYes2=new r.Howl({src:he.default}),this.scvYes3=new r.Howl({src:de.default}),this.scvYes4=new r.Howl({src:le.default}),this.scvYes5=new r.Howl({src:ce.default}),this.scvYes6=new r.Howl({src:ue.default}),this.scvError0=new r.Howl({src:me.default}),this.harvesterYes0=new r.Howl({src:pe.default}),this.harvesterYes1=new r.Howl({src:ge.default}),this.harvesterYes2=new r.Howl({src:we.default}),this.harvesterYes3=new r.Howl({src:fe.default}),this.harvesterYes4=new r.Howl({src:be.default}),this.harvesterYes5=new r.Howl({src:ye.default}),this.harvesterYes6=new r.Howl({src:xe.default}),this.harvesterYes7=new r.Howl({src:Te.default}),this.harvesterError0=new r.Howl({src:ve.default}),this.load()}parse(e){const t=localStorage.getItem(e);if(null!=t){const e=Number.parseFloat(t);if(Number.isFinite(e))return e}return Se.defaultVolume}load(){const{voice:e,shoot:t,hit:i,message:s}=Se.keys;this.initialVoiceVolume=this.voiceVolume=this.parse(e),this.initialShootVolume=this.shootVolume=this.parse(t),this.initialHitVolume=this.hitVolume=this.parse(i),this.initialMessageVolume=this.messageVolume=this.parse(s)}save(e,t){localStorage.setItem(e,String(t))}resetAll(){this.voiceVolume=this.initialVoiceVolume,this.shootVolume=this.initialShootVolume,this.hitVolume=this.initialHitVolume,this.messageVolume=this.initialMessageVolume}saveAll(){this.save(Se.keys.voice,this.voiceVolume),this.save(Se.keys.shoot,this.shootVolume),this.save(Se.keys.hit,this.hitVolume),this.save(Se.keys.message,this.messageVolume),this.initialVoiceVolume=this.voiceVolume,this.initialShootVolume=this.shootVolume,this.initialHitVolume=this.hitVolume,this.initialMessageVolume=this.messageVolume}getSounds(e){switch(e){case"acknowledge-moving":return[this.yup,this.roger1,this.roger2];case"acknowledge-attacking":return[this.engaging];case"bullet":return[this.bullet1,this.bullet2];case"bullet-hit":return[this.bulletHit0,this.bulletHit1,this.bulletHit2,this.bulletHit3,this.bulletHit4,this.bulletHit5];case"rocket":return[this.heatseeker1,this.heatseeker2];case"rocket-hit":return[this.rocketHit0];case"laser":return[this.laser1,this.laser2];case"laser-hit":return[this.laserHit0];case"cannon-ball":return[this.cannon1,this.cannon2];case"cannon-hit":return[this.cannonHit];case"message-received":return[this.message0,this.message1];case"message-error":return[this.messageError0];case"scout-tank-attack":return[this.vultureAttack0];case"scout-tank-yes":return[this.vultureYes0,this.vultureYes1,this.vultureYes2,this.vultureYes3];case"heavy-tank-attack":return[this.tankAttack0,this.tankAttack1,this.tankAttack2];case"heavy-tank-yes":return[this.tankYes0,this.tankYes1,this.tankYes2,this.tankYes3];case"chopper-attack":return[this.chopperAttack0,this.chopperAttack1,this.chopperAttack2];case"chopper-yes":return[this.chopperYes0,this.chopperYes1,this.chopperYes2,this.chopperYes3,this.chopperYes4,this.chopperYes5];case"wraith-attack":return[this.wraithAttack0,this.wraithAttack1,this.wraithAttack2,this.wraithAttack3];case"wraith-yes":return[this.wraithYes0,this.wraithYes1,this.wraithYes2,this.wraithYes3];case"scv-yes":return[this.scvYes0,this.scvYes1,this.scvYes2,this.scvYes3,this.scvYes4,this.scvYes5,this.scvYes6];case"scv-error":return[this.scvError0];case"harvester-yes":return[this.harvesterYes0,this.harvesterYes1,this.harvesterYes2,this.harvesterYes3,this.harvesterYes4,this.harvesterYes5,this.harvesterYes6,this.harvesterYes7];case"harvester-error":return[this.harvesterError0]}return[]}play({name:e,volume:t,stop:i=[]}){const s=this.getSounds(e);if(s.length>0){i.map((e=>this.getSounds(e))).forEach((e=>{e.forEach((e=>e.stop()))}));const e=s[Math.floor(Math.random()*s.length)];e.volume(t),e.play()}}playYes(e){e===Ce.EItemName.SCV?this.play({name:"scv-yes",volume:this.voiceVolume,stop:["scv-yes","scv-error"]}):e===Ce.EItemName.Harvester?this.play({name:"harvester-yes",volume:this.voiceVolume,stop:["harvester-yes","harvester-error"]}):e===Ce.EItemName.ScoutTank?this.play({name:"scout-tank-yes",volume:this.voiceVolume,stop:["scout-tank-yes","scout-tank-attack"]}):e===Ce.EItemName.HeavyTank?this.play({name:"heavy-tank-yes",volume:this.voiceVolume,stop:["heavy-tank-yes","heavy-tank-attack"]}):e===Ce.EItemName.Chopper?this.play({name:"chopper-yes",volume:this.voiceVolume,stop:["chopper-yes","chopper-attack"]}):e===Ce.EItemName.Wraith?this.play({name:"wraith-yes",volume:this.voiceVolume,stop:["wraith-yes","wraith-attack"]}):this.play({name:"acknowledge-moving",volume:this.voiceVolume,stop:["acknowledge-moving","acknowledge-attacking"]})}playAttack(e){e===Ce.EItemName.ScoutTank?this.play({name:"scout-tank-attack",volume:this.voiceVolume,stop:["scout-tank-attack","scout-tank-yes"]}):e===Ce.EItemName.HeavyTank?this.play({name:"heavy-tank-attack",volume:this.voiceVolume,stop:["heavy-tank-attack","heavy-tank-yes"]}):e===Ce.EItemName.Chopper?this.play({name:"chopper-attack",volume:this.voiceVolume,stop:["chopper-attack","chopper-yes"]}):e===Ce.EItemName.Wraith?this.play({name:"wraith-attack",volume:this.voiceVolume,stop:["wraith-attack","wraith-yes"]}):this.play({name:"acknowledge-attacking",volume:this.voiceVolume,stop:["acknowledge-attacking","acknowledge-moving"]})}playRandomVoice(){const e=["acknowledge-attacking","acknowledge-moving","harvester-yes","harvester-error","scv-yes","scv-error","scout-tank-yes","scout-tank-attack","heavy-tank-yes","heavy-tank-attack","chopper-yes","chopper-attack","wraith-yes","wraith-attack"],t=e[Math.floor(Math.random()*e.length)];this.play({name:t,volume:this.voiceVolume,stop:e})}playRandomShoot(){const e=["bullet","cannon-ball","laser","rocket"],t=e[Math.floor(Math.random()*e.length)];this.play({name:t,volume:this.shootVolume,stop:e})}playRandomHit(){const e=["bullet-hit","cannon-hit","laser-hit","rocket-hit"],t=e[Math.floor(Math.random()*e.length)];this.play({name:t,volume:this.hitVolume,stop:e})}playRandomMessage(){const e=["message-received","message-error"],t=e[Math.floor(Math.random()*e.length)];this.play({name:t,volume:this.messageVolume,stop:e})}playMessage(){this.play({name:"message-received",volume:this.messageVolume,stop:["message-received","message-error"]})}playError(){this.play({name:"message-error",volume:this.messageVolume,stop:["message-error","message-received"]})}playShoot(e){this.play({name:e,volume:this.shootVolume})}playHit(e){this.play({name:e,volume:this.hitVolume})}playSCVError(){this.play({name:"scv-error",volume:this.voiceVolume,stop:["scv-yes","scv-error"]})}playHarvesterError(){this.play({name:"harvester-error",volume:this.voiceVolume,stop:["harvester-error","harvester-yes"]})}}Se.keys={voice:"voice",shoot:"shoot",hit:"hit",message:"message"},Se.defaultVolume=.5,t.Audio=Se},14137:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Hitbox=void 0;const s=i(58687);class r extends s.Sprite{static prepareGraphics({tileWidth:e,tileHeight:t,borderWidth:i,mapGridHeight:r,mapGridWidth:o}){const n=new s.Graphics;return n.beginFill(16777215),n.drawRect(0,0,e,t),n.endFill(),n.beginHole(),n.drawRect(i,i,e-2*i,t-2*i),n.endHole(),n}constructor({initGridX:e,initGridY:t}){super(r.cacheTexture),this.initGridX=e,this.initGridY=t}static prepareTextures({texture:e}){r.cacheTexture=e}static updateColor({currentMapGrid:e,hitboxes:t,cameraGridBounds:{leftGridX:i,rightGridX:s,topGridY:r,bottomGridY:o}}){t.children.forEach((t=>{const{initGridX:n,initGridY:a}=t;t.tint=1===e[a][n]?16711680:65280,t.renderable=n>=i&&n<=s&&a>=r&&a<=o}))}}t.Hitbox=r},11954:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MapSettings=void 0;class i{static findTileLayer({name:e,mapSettings:t}){const i=t.layers.find((t=>"tilelayer"===t.type&&t.name===e));if(null==i)throw new Error(`Unable to detect "${e}" tile layer`);return i}static findObjectGroupLayer({name:e,mapSettings:t}){const i=t.layers.find((t=>"objectgroup"===t.type&&t.name===e));if(null==i)throw new Error(`Unable to detect "${e}" object group layer`);return i}static mapObjectToPositions({mapSettings:e,layerName:t}){const s=[],r=i.findObjectGroupLayer({name:t,mapSettings:e});for(let e=0;e<r.objects.length;e++){const t=r.objects[e];s.push({x:t.x,y:t.y,width:t.width,height:t.height})}return s}static mapTilesToPositions({mapSettings:e,layerName:t,tileIds:s}){const r=[],o=i.findTileLayer({name:t,mapSettings:e}),n=e.width;for(let t=0;t<o.data.length;t+=n)o.data.slice(t,t+n).forEach(((i,o)=>{(Array.isArray(s)&&s.includes(i)||0!==i)&&r.push({x:o*e.tilewidth,y:t/n*e.tileheight,width:e.tilewidth,height:e.tileheight})}));return r}}t.MapSettings=i},44782:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Order=void 0;const s=i(58687),r=i(53555),o=i(42097),n=i(54536),a=i(41759),h=i(46667);class d extends s.Graphics{constructor({item:e}){super(),this.item=e}getLineColor(e){switch(e){case"move":case"follow":return 65280;case"attack":case"move-and-attack":return 16711680;case"patrol":return 16776960;case"guard":return 255;case"build":case"deploy":return 16711935;default:return 16777215}}getDestinationColor(e){switch(e){case"move":case"move-and-attack":case"follow":return 65280;case"attack":return 16711680;case"patrol":return 65535;case"guard":return 255;case"build":case"deploy":return 16711935;default:return 16777215}}getFromRadius(e){return"patrol"===e?3:0}getDestinationRadius(e){switch(e){case"attack":case"guard":case"follow":return 15;case"build":case"deploy":return 0;default:return 3}}drawOrder({selectedItem:e,tileMap:t}){const i=e.getCollisionPosition({center:!0});let s,r;switch(e.order.type){case"move":case"move-and-attack":case"build":case"deploy":s=i,r={x:e.order.toPoint.gridX*t.gridSize,y:e.order.toPoint.gridY*t.gridSize};break;case"attack":case"follow":case"guard":{const t=e.order.to;(null==t?void 0:t.isAlive())&&(s=i,r=t.getCollisionPosition({center:!0}));break}case"patrol":s={x:e.order.fromPoint.gridX*t.gridSize,y:e.order.fromPoint.gridY*t.gridSize},r={x:e.order.toPoint.gridX*t.gridSize,y:e.order.toPoint.gridY*t.gridSize}}if(null!=this.buildSprite&&(this.buildSprite.visible=!1),null==s||null==r)return void this.clear();const{type:o}=e.order,{dash:n,gap:a,lineWidth:h}=d.options;this.clear(),this.lineStyle({width:h,color:this.getLineColor(o)}),this.drawCircle(s.x,s.y,this.getFromRadius(o));const l=Math.hypot(r.x-s.x,r.y-s.y),c=(r.x-s.x)/l,u=(r.y-s.y)/l;this.moveTo(s.x,s.y).lineTo(s.x+n*c,s.y+n*u);let m=n+a;for(;m<l;)this.moveTo(s.x+m*c,s.y+m*u),m+=n,m>l?(m=l,this.lineTo(s.x+m*c,s.y+m*u)):(this.lineTo(s.x+m*c,s.y+m*u),m+=a);this.lineStyle({width:h,color:this.getDestinationColor(o)}),this.drawCircle(r.x,r.y,this.getDestinationRadius(o)),this.endFill(),this.alpha=.5,this.drawOrderSprite({selectedItem:e,tileMap:t,to:r})}drawOrderSprite({selectedItem:e,tileMap:t,to:i}){let d,l={x:0,y:0};"build"===e.order.type?e.order.name===o.EItemName.GroundTurret?(d=e.team===r.Team.blue?n.GroundTurret.blueTextures.downRightTextures[0]:n.GroundTurret.greenTextures.downRightTextures[0],l=n.GroundTurret.collisionOptions.offset):e.order.name===o.EItemName.Starport&&(d=e.team===r.Team.blue?a.Starport.blueTextures.healthyTextures[0]:a.Starport.greenTextures.healthyTextures[0],l=a.Starport.collisionOptions.offset):"deploy"===e.order.type&&(d=e.team===r.Team.blue?h.OilDerrick.blueTextures.healthyTextures[0]:h.OilDerrick.greenTextures.healthyTextures[0],l=h.OilDerrick.collisionOptions.offset),null!=d&&(null==this.buildSprite&&(this.buildSprite=new s.Sprite,this.addChild(this.buildSprite)),this.buildSprite.texture=d,this.buildSprite.position.set(Math.floor(i.x/t.gridSize)*t.gridSize-l.x,Math.floor(i.y/t.gridSize)*t.gridSize-l.y),this.buildSprite.visible=!0)}}d.options={dash:16,gap:8,lineWidth:1},t.Order=d},9127:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Firework=void 0;const s=i(58687);class r extends s.Sprite{constructor({texture:e}){super(e),this.markedForDeletion=!1,this.velocity={vx:0,vy:0}}handleUpdate(){this.x-=this.velocity.vx,this.y-=this.velocity.vy,this.alpha*=.99,this.alpha<.1&&(this.markedForDeletion=!0)}}class o extends r{static prepareTextures({textures:e}){o.textures=e}constructor(){super({texture:o.textures.texture}),this.width=this.height=10*Math.random()+10,this.velocity.vx=10*Math.random()-5,this.velocity.vy=2*Math.random()+1,this.tint=16777215*Math.random()<<0}handleUpdate(){this.velocity.vy-=o.options.gravity,super.handleUpdate()}static prepareGraphics(){const e=new s.Graphics;return e.beginFill(16777215),e.drawCircle(0,0,o.options.renderRadius),e.endFill(),e.cacheAsBitmap=!0,e}}o.options={gravity:.08,renderRadius:100},t.Firework=o},65078:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.handleTiggers=t.createTrigger=t.ConditionalTrigger=t.IntervalTrigger=t.TimedTrigger=t.Trigger=t.ETriggerType=void 0,function(e){e.timed="timed",e.interval="interval",e.conditional="conditional"}(i=t.ETriggerType||(t.ETriggerType={}));class s{constructor({type:e,action:t,insertTrigger:i,interval:s,remove:r}){this.elapsedTime=0,this.type=e,this.action=t,this.insertTrigger=i,this.interval=null!=s?s:0,this.remove=null!=r&&r}isElapsed(e){return this.elapsedTime>=this.interval?(this.elapsedTime=0,!0):(this.elapsedTime+=e,!1)}}t.Trigger=s;class r extends s{constructor({time:e,action:t,insertTrigger:s,remove:r}){super({type:i.timed,interval:e,action:t,insertTrigger:s,remove:null==r||r}),this.time=e}}t.TimedTrigger=r;class o extends s{constructor({interval:e,action:t,insertTrigger:s,remove:r}){super({type:i.interval,interval:e,action:t,insertTrigger:s,remove:r})}}t.IntervalTrigger=o;class n extends s{constructor({interval:e,condition:t,action:s,insertTrigger:r,remove:o}){super({type:i.conditional,interval:e,action:s,insertTrigger:r,remove:null==o||o}),this.condition=t}}function a(e){switch(e.type){case i.timed:return new r(e);case i.interval:return new o(e);case i.conditional:return new n(e)}}t.ConditionalTrigger=n,t.createTrigger=a,t.handleTiggers=function({deltaMS:e,triggers:t}){for(let s=0;s<t.length;s++){const r=t[s];let o=!1;switch(r.type){case i.timed:r.isElapsed(e)&&(r.action(),o=!0);break;case i.conditional:r.isElapsed(e)&&r.condition()&&(r.action(),o=!0);break;case i.interval:r.isElapsed(e)&&(r.action(),o=!0)}if(o&&r.remove&&(t.splice(s,1),s--),o&&null!=r.insertTrigger){const e=a(r.insertTrigger);t.push(e)}}}},7091:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=t.EVectorDirection=void 0,function(e){e[e.up=0]="up",e[e.upRight=1]="upRight",e[e.right=2]="right",e[e.downRight=3]="downRight",e[e.down=4]="down",e[e.downLeft=5]="downLeft",e[e.left=6]="left",e[e.upLeft=7]="upLeft"}(i=t.EVectorDirection||(t.EVectorDirection={})),t.Vector=class{constructor(e){this.directions=Object.keys(i).map(Number).filter(Number.isInteger).length,this.setDirection(e)}setDirection({direction:e}){this.direction=e}}},53555:(e,t)=>{function i({direction:e,directions:t}){return e<0&&(e+=t),e>=t&&(e-=t),e}var s;Object.defineProperty(t,"__esModule",{value:!0}),t.compareArrays=t.generateUid=t.checkCollision=t.angleDiff=t.findAngleGrid=t.findAngle=t.wrapDirection=t.Team=void 0,(s=t.Team||(t.Team={})).blue="blue",s.green="green",t.wrapDirection=i,t.findAngle=function({from:e,to:t,directions:s}){const r=e.y-t.y,o=e.x-t.x;return i({direction:s/2-Math.atan2(o,r)*s/(2*Math.PI),directions:s})},t.findAngleGrid=function({from:e,to:t,directions:s}){const r=e.gridY-t.gridY,o=e.gridX-t.gridX;return i({direction:s/2-Math.atan2(o,r)*s/(2*Math.PI),directions:s})},t.angleDiff=function({angle1:e,angle2:t,directions:i}){e>=i/2&&(e-=i),t>=i/2&&(t-=i);let s=t-e;return s<-i/2&&(s+=i),s>i/2&&(s-=i),s},t.checkCollision=function(e,t,i="a"){const s=Math.max(t.left,e.left),r=Math.min(t.right,e.right);if(r<=s)return 0;const o=Math.max(t.top,e.top),n=Math.min(t.bottom,e.bottom);return n>o?(r-s)*(n-o)/("a"===i?(e.right-e.left)*(e.bottom-e.top):(t.right-t.left)*(t.bottom-t.top)):0};let r=1e3;t.generateUid=function(){return++r},t.compareArrays=function(e,t){if(e.length!==t.length)return!1;e=[...e].sort(),t=[...t].sort();for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}},36645:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logCash=t.logNoSightHide=t.logNoFog=t.logAI=t.logSideBar=t.logItemBounds=t.logGrid=t.logHitboxes=t.logDoubleTapEvent=t.logPointerEvent=t.logLayout=t.logApp=void 0;const r=s(i(11227));t.logApp=(0,r.default)("rts-app"),t.logLayout=(0,r.default)("rts-layout"),t.logPointerEvent=(0,r.default)("rts-pointer-event"),t.logDoubleTapEvent=(0,r.default)("rts-double-tap-event"),t.logHitboxes=(0,r.default)("rts-hitboxes"),t.logGrid=(0,r.default)("rts-grid"),t.logItemBounds=(0,r.default)("rts-item-bounds"),t.logSideBar=(0,r.default)("rts-side-bar"),t.logAI=(0,r.default)("rts-ai"),t.logNoFog=(0,r.default)("rts-no-fog"),t.logNoSightHide=(0,r.default)("rts-no-sight-hide"),t.logCash=(0,r.default)("rts-cash")},24942:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AttackableVehicle=void 0;const s=i(16445),r=i(33959),o=i(53555),n=i(42097),a=i(11976);class h extends a.Vehicle{constructor(e){super(e),this.commands=[s.ECommandName.moveFollow,s.ECommandName.attackGuard,s.ECommandName.patrol],this.reloadTimeLeft=0,this.drawReloadBarOptions={alpha:0,width:0,height:0,fillColor:0,offset:{x:0,y:0}},this.attackRadius=0,this.canAttack=!1,this.canAttackLand=!1,this.canAttackAir=!1,this.setup(e)}setup(e){super.setup(e),this.reloadBar=new r.ReloadBar(this.drawReloadBarOptions),this.addChild(this.reloadBar)}isValidTarget(e){return e.team!==this.team&&(this.canAttackLand&&(e.type===n.EItemType.buildings||e.type===n.EItemType.vehicles)||this.canAttackAir&&e.type===n.EItemType.airVehicles)}findTargetInSight(e=0){const t=this.getGridXY({center:!0}),i={},s=this.game.tileMap.activeItems.children;for(let r=s.length-1;r>=0;r--){const o=s[r];if(this.isValidTarget(o)){const s=o.getGridXY({center:!0}),r=Math.pow(s.gridX-t.gridX,2)+Math.pow(s.gridY-t.gridY,2);r<Math.pow(this.sightRadius+e,2)&&(Array.isArray(i[r])||(i[r]=[]),i[r].push(o))}}return Object.keys(i).map(Number).sort(((e,t)=>e-t)).map((e=>i[e])).flat()[0]}processOrders(){if("patrol"!==this.order.type&&super.processOrders())return!0;const{tileMap:e,turnSpeedAdjustmentFactor:t}=this.game,i=this.getGridXY({center:!0});switch(this.order.type){case"stand":{const e=this.findTargetInSight();return null!=e&&(this.order={type:"attack",to:e}),!0}case"hunt":{const e=this.findTargetInSight(100);return null!=e&&(this.order={type:"attack",to:e,nextOrder:this.order}),!0}case"attack":{if(null==this.order.to)return!0;if(this.order.to.isDead()||!this.isValidTarget(this.order.to))return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const s=this.order.to.getGridXY({center:!0}),r=Math.pow(s.gridX-i.gridX,2)+Math.pow(s.gridY-i.gridY,2);if(r<Math.pow(this.attackRadius,2)){const r=(0,o.findAngleGrid)({from:s,to:i,directions:this.vector.directions}),n=(0,o.angleDiff)({angle1:this.vector.direction,angle2:r,directions:this.vector.directions}),a=this.turnSpeed*t;if(Math.abs(n)>a)this.vector.setDirection({direction:(0,o.wrapDirection)({direction:this.vector.direction+a*Math.abs(n)/n,directions:this.vector.directions})}),this.moveTurning=!0;else if(this.vector.setDirection({direction:r}),this.moveTurning=!1,this.reloadTimeLeft<=0){const t=this.game.getReloadTime(this.projectile);if("number"==typeof t){this.reloadTimeLeft=t;const s=-this.vector.direction/this.vector.directions*2*Math.PI,o=i.gridX-this.collisionRadius*Math.sin(s)/e.gridSize,n=i.gridY-this.collisionRadius*Math.cos(s)/e.gridSize,a=this.game.createProjectile({name:this.projectile,initX:o*e.gridSize,initY:n*e.gridSize,direction:r,target:this.order.to});null!=a&&e.addItem(a)}}}else{const e=Math.pow(r,.5);this._moveTo({type:this.order.to.type,...s},e)||(this.order={type:"stand"})}return!0}case"patrol":{const t=this.findTargetInSight();if(null!=t)return this.order={type:"attack",to:t,nextOrder:this.order},!0;const s=Math.pow(this.order.toPoint.gridX-i.gridX,2)+Math.pow(this.order.toPoint.gridY-i.gridY,2);if(s<Math.pow(this.sightRadius/e.gridSize,2)){const e=this.order.toPoint;this.order.toPoint=this.order.fromPoint,this.order.fromPoint=e}else this._moveTo(this.order.toPoint,s);return!0}case"guard":{if(this.order.to.isDead())return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const e=this.order.to.getGridXY({center:!0}),t=Math.pow(e.gridX-i.gridX,2)+Math.pow(e.gridY-i.gridY,2);if(t<Math.pow(this.followRadius,2)){const e=this.findTargetInSight();if(null!=e)return this.order={type:"attack",to:e,nextOrder:this.order},!0;"attack"===this.order.to.order.type&&(this.order={type:"attack",to:this.order.to.order.to,nextOrder:this.order})}else{const e=this.findTargetInSight();if(null!=e)this.order={type:"attack",to:e,nextOrder:this.order};else{const e=this.order.to.getGridXY({center:!0});this._moveTo({type:this.order.to.type,...e},t)}}return!0}case"move-and-attack":{const t=this.findTargetInSight();if(null!=t)return this.order={type:"attack",to:t,nextOrder:this.order},!0;const s=Math.pow(this.order.toPoint.gridX-i.gridX,2)+Math.pow(this.order.toPoint.gridY-i.gridY,2);if(s<Math.pow(this.collisionRadius/e.gridSize,2))return this.order={type:"stand"},!0;const r=Math.pow(s,.5);return this._moveTo(this.order.toPoint,r)||(this.order={type:"stand"}),!0}}return!1}handleUpdate(e){this.reloadTimeLeft>0&&(this.reloadTimeLeft-=this.game.reloadAdjustmentFactor),this.updateReload(),super.handleUpdate(e)}drawReloadBar(){this.reloadBar.draw(this.drawReloadBarOptions);const{offset:e}=this.drawReloadBarOptions;this.reloadBar.position.set(e.x,e.y)}updateReload(){const e=this.game.getReloadTime(this.projectile);"number"==typeof e&&this.reloadBar.updateReload((e-this.reloadTimeLeft)/e)}}t.AttackableVehicle=h},9498:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Harvester=void 0;const s=i(46667),r=i(16445),o=i(53555),n=i(42097),a=i(7091),h=i(11976);class d extends h.Vehicle{static textures(e){return e===o.Team.blue?d.blueTextures:d.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){d.blueTextures=e,d.greenTextures=t}constructor(e){var t;super({...e,textures:d.textures(e.team)}),this.itemName=n.EItemName.Harvester,this.commands=[r.ECommandName.moveFollow,r.ECommandName.patrol,r.ECommandName.deploy],this.collisionOptions={width:20,height:20,offset:{x:1,y:0}},this.drawSelectionOptions={width:0,height:0,radius:10,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:-1,y:-2}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:20,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:1,y:-7}},this.collisionRadius=10,this.sightRadius=4,this.speed=10,this.hitPoints=50,this.turnSpeed=2,this.turnFactor=20,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===o.Team.blue?255:4243264,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}processOrders(){if(super.processOrders())return!0;if("deploy"===this.order.type){const{tileMap:e,turnSpeedAdjustmentFactor:t}=this.game;e.rebuildBuildableGrid(this),e.mergeBuildableGridIntoDeployable();const{currentMapDeployableGrid:i}=e,{buildableGrid:r}=s.OilDerrick,{toPoint:h}=this.order;for(let e=r.length-1;e>=0;e--)for(let t=r[e].length-1;t>=0;t--)if(1===i[Math.floor(h.gridY)+e][Math.floor(h.gridX)+t])return this.team===this.game.team&&this.game.audio.playHarvesterError(),this.order={type:"stand"},!0;const d=this.getGridXY({center:!0,floor:!0});if(d.gridX===Math.floor(h.gridX)&&d.gridY===Math.floor(h.gridY)){const i=(0,o.angleDiff)({angle1:this.vector.direction,angle2:a.EVectorDirection.left,directions:this.vector.directions}),r=this.turnSpeed*t;Math.abs(i)>r?(this.vector.setDirection({direction:(0,o.wrapDirection)({direction:this.vector.direction+r*Math.abs(i)/i,directions:this.vector.directions})}),this.moveTurning=!0):(this.vector.setDirection({direction:a.EVectorDirection.left}),this.moveTurning=!1),this.moveTurning||(this.removeAndDestroy(),e.addItem(new s.OilDerrick({game:this.game,initX:Math.floor(h.gridX)*e.gridSize,initY:Math.floor(h.gridY)*e.gridSize,team:this.team,deploy:!0})))}else{const e=Math.pow(Math.floor(h.gridX)-d.gridX,2)+Math.pow(Math.floor(h.gridY)-d.gridY,2),t=Math.pow(e,.5);this._moveTo({type:n.EItemType.terrain,...this.order.toPoint},t)||(this.team===this.game.team&&this.game.audio.playHarvesterError(),this.order={type:"stand"})}return!0}return!1}}d.cost=160,t.Harvester=d},22273:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeavyTank=void 0;const s=i(53555),r=i(42097),o=i(24942);class n extends o.AttackableVehicle{static textures(e){return e===s.Team.blue?n.blueTextures:n.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){n.blueTextures=e,n.greenTextures=t}constructor(e){var t;super({...e,textures:n.textures(e.team)}),this.itemName=r.EItemName.HeavyTank,this.collisionOptions={width:26,height:26,offset:{x:3,y:3}},this.drawSelectionOptions={width:0,height:0,radius:13,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:1,y:1}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:26,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:3,y:-7}},this.drawReloadBarOptions={alpha:1,width:26,height:2,fillColor:12690711,offset:{x:3,y:-2}},this.collisionRadius=13,this.sightRadius=10,this.attackRadius=9,this.speed=15,this.hitPoints=50,this.turnSpeed=4,this.turnFactor=10,this.projectile=r.EItemName.CannonBall,this.canAttack=!0,this.canAttackLand=!0,this.canAttackAir=!1,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===s.Team.blue?255:4243264,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.drawReloadBar(),this.updateReload(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}}n.cost=120,t.HeavyTank=n},22591:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SCV=void 0;const s=i(16445),r=i(70519),o=i(53555),n=i(42097),a=i(11976),h=i(36645);class d extends a.Vehicle{static textures(e){return e===o.Team.blue?d.blueTextures:d.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){d.blueTextures=e,d.greenTextures=t}constructor(e){var t;super({...e,textures:d.textures(e.team)}),this.itemName=n.EItemName.SCV,this.commands=[s.ECommandName.moveFollow,s.ECommandName.patrol,s.ECommandName.buildTurret,s.ECommandName.buildStarport],this.collisionOptions={width:20,height:20,offset:{x:5,y:5}},this.drawSelectionOptions={width:0,height:0,radius:12,strokeWidth:2,strokeColor:16776960,strokeSecondColor:16777215,offset:{x:1,y:1}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:20,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:5,y:-4}},this.collisionRadius=10,this.sightRadius=6,this.speed=15,this.hitPoints=100,this.turnSpeed=4,this.turnFactor=10,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===o.Team.blue?255:4243264,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}processOrders(){if(super.processOrders())return!0;if("build"===this.order.type){const e=this.game.getItemCost(this.order.name);if("number"!=typeof e)return console.warn(`Unable to calc item (name=${this.order.name}) cost`),this.order={type:"stand"},!0;const{tileMap:t,cash:i,team:s}=this.game;if(i[this.team]<e&&this.team===s)return this.game.showMessage({character:r.EMessageCharacter.system,message:`Warning! Insufficient Funds. Need ${e} credits.`,selfRemove:!0}),this.order={type:"stand"},!0;t.rebuildBuildableGrid();const{currentMapBuildableGrid:o,mapGridWidth:a,mapGridHeight:d}=t,l=this.game.getBuildableGrid(this.order.name);if(null==l)return console.warn(`Unable to detect buildable grid for name=${this.order.name}`),this.order={type:"stand"},!0;const{toPoint:c}=this.order;for(let e=l.length-1;e>=0;e--)for(let t=l[e].length-1;t>=0;t--)if(1===o[Math.floor(c.gridY)+e][Math.floor(c.gridX)+t])return this.team===this.game.team&&this.game.audio.playSCVError(),this.order={type:"stand"},!0;const u=this.getGridXY({center:!0,floor:!0}),m={gridX:Math.floor(c.gridX)-1,gridY:Math.floor(c.gridY)-1},p=[[1,...l[0],1],...l.map((e=>[1,...e,1])),[1,...l[l.length-1],1]];let g=!1;for(let e=0;e<p.length;e++)for(let t=0;t<p[e].length;t++){const i=m.gridX+t,s=m.gridY+e;if(!(i<0||i>=a||s<0||s>=d)&&i===u.gridX&&s===u.gridY){g=!0;break}}if(g){const s=this.game.createItem({name:this.order.name,team:this.team,initGridX:Math.floor(c.gridX),initGridY:Math.floor(c.gridY),teleport:!0});null!=s&&(i[this.team]-=e,(0,h.logCash)(`(${this.game.team}) scv build (-${e}) b=${this.game.cash.blue} g=${this.game.cash.green}`),t.addItem(s),t.rebuildPassableRequired=!0),this.order={type:"stand"}}else{const e=this.getGridXY(),t=Math.pow(c.gridX-e.gridX,2)+Math.pow(c.gridY-e.gridY,2),i=Math.pow(t,.5);this._moveTo({type:n.EItemType.terrain,...this.order.toPoint},i)||(this.team===this.game.team&&this.game.audio.playSCVError(),this.order={type:"stand"})}return!0}return!1}}d.cost=40,t.SCV=d},33244:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScoutTank=void 0;const s=i(53555),r=i(42097),o=i(24942);class n extends o.AttackableVehicle{static textures(e){return e===s.Team.blue?n.blueTextures:n.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){n.blueTextures=e,n.greenTextures=t}constructor(e){var t;super({...e,textures:n.textures(e.team)}),this.itemName=r.EItemName.ScoutTank,this.collisionOptions={width:22,height:22,offset:{x:0,y:0}},this.drawSelectionOptions={width:0,height:0,radius:11,strokeWidth:2,strokeColor:0,strokeSecondColor:16777215,offset:{x:-2,y:-2}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:22,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:0,y:-9}},this.drawReloadBarOptions={alpha:1,width:22,height:2,fillColor:12690711,offset:{x:0,y:-4}},this.collisionRadius=11,this.sightRadius=8,this.attackRadius=4,this.speed=20,this.hitPoints=50,this.turnSpeed=4,this.turnFactor=10,this.projectile=r.EItemName.Bullet,this.canAttack=!0,this.canAttackLand=!0,this.canAttackAir=!1,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===s.Team.blue?255:4243264,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.drawReloadBar(),this.updateReload(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}}n.cost=50,t.ScoutTank=n},84631:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const s=i(53555),r=i(42097),o=i(11976);class n extends o.Vehicle{static textures(e){return e===s.Team.blue?n.blueTextures:n.greenTextures}static prepareTextures({blueTextures:e,greenTextures:t}){n.blueTextures=e,n.greenTextures=t}constructor(e){var t;super({...e,textures:n.textures(e.team)}),this.itemName=r.EItemName.Transport,this.collisionOptions={width:30,height:30,offset:{x:0,y:0}},this.drawSelectionOptions={width:0,height:0,radius:15,strokeWidth:2,strokeColor:16776960,strokeSecondColor:16777215,offset:{x:-2,y:-2}},this.drawLifeBarOptions={borderColor:16777215,borderThickness:1,borderAlpha:.5,width:30,height:5,fillColor:1409085,emptyColor:16711680,offset:{x:0,y:-7}},this.collisionRadius=15,this.sightRadius=8,this.speed=15,this.hitPoints=100,this.turnSpeed=2,this.turnFactor=20,Array.isArray(e.commands)&&(this.commands=e.commands),this.life=null!==(t=e.life)&&void 0!==t?t:this.hitPoints,this.drawSelectionOptions.strokeColor=e.team===s.Team.blue?255:4243264,this.drawSelection(),this.drawCollision(),this.setPositionByXY({x:e.initX,y:e.initY,center:e.initCenter}),this.drawLifeBar(),this.updateLife(),this.updateAnimation(),!0===e.teleport&&this.drawTeleport()}}n.cost=40,t.Transport=n},11976:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vehicle=void 0;const s=i(58687),r=i(7091),o=i(53555),n=i(42097),a=i(13476),h=i(94973),d=i(16445),l=i(17837);var c;!function(e){e.soft="soft",e.hard="hard",e.attraction="attraction"}(c||(c={}));class u extends l.TeleportableSelectableLifeableRoundItem{constructor(e){super(e),this.commands=[d.ECommandName.moveFollow,d.ECommandName.patrol],this.type=n.EItemType.vehicles,this.spritesContainer=new s.Container,this.vector=new r.Vector({direction:r.EVectorDirection.down}),this.speed=0,this.moveTurning=!1,this.turnSpeed=0,this.turnFactor=0,this.hardCollision=!1,this.collisionCount=0,this.colliding=!1,this.followRadius=3,this.elapsedSwitchFrames=0,this.switchFrames=30,null!=e.direction&&this.vector.setDirection({direction:e.direction}),this.setup(e)}setup(e){this.addChild(this.selectedGraphics),this.addChild(this.spritesContainer),this.addChild(this.collisionGraphics);const{textures:{upTextures:t,upRightTextures:i,rightTextures:r,downRightTextures:o,downTextures:n,downLeftTextures:a,leftTextures:d,upLeftTextures:l},teleport:c}=e;!0===c&&(this.teleportGraphics=new s.Graphics,this.addChild(this.teleportGraphics));const u=new s.AnimatedSprite(t);this.spritesContainer.addChild(u),this.upAnimation=u;const m=new s.AnimatedSprite(i);this.spritesContainer.addChild(m),this.upRightAnimation=m;const p=new s.AnimatedSprite(r);this.spritesContainer.addChild(p),this.rightAnimation=p;const g=new s.AnimatedSprite(o);this.spritesContainer.addChild(g),this.downRightAnimation=g;const w=new s.AnimatedSprite(n);this.spritesContainer.addChild(w),this.downAnimation=w;const f=new s.AnimatedSprite(a);this.spritesContainer.addChild(f),this.downLeftAnimation=f;const b=new s.AnimatedSprite(d);this.spritesContainer.addChild(b),this.leftAnimation=b;const y=new s.AnimatedSprite(l);this.spritesContainer.addChild(y),this.upLeftAnimation=y,this.lifeBar=new h.LifeBar(this.drawLifeBarOptions),this.addChild(this.lifeBar)}hideAllAnimations(){this.spritesContainer.children.forEach((e=>{e.visible=!1}))}updateAnimation(e=!1){this.switchAnimation(this.vector.direction,e)}switchAnimation(e,t){let i;const s=.5;i=e>=r.EVectorDirection.upLeft+s&&e<=r.EVectorDirection.upLeft+1||e>=r.EVectorDirection.up&&e<=r.EVectorDirection.upRight-s?this.upAnimation:e>=r.EVectorDirection.upRight+s&&e<=r.EVectorDirection.downRight-s?this.rightAnimation:e>=r.EVectorDirection.downRight+s&&e<=r.EVectorDirection.downLeft-s?this.downAnimation:e>=r.EVectorDirection.downLeft+s&&e<=r.EVectorDirection.upLeft-s?this.leftAnimation:e>r.EVectorDirection.up&&e<r.EVectorDirection.right?this.upRightAnimation:e>r.EVectorDirection.right&&e<r.EVectorDirection.down?this.downRightAnimation:e>=r.EVectorDirection.down&&e<r.EVectorDirection.left?this.downLeftAnimation:this.upLeftAnimation,i!==this.currentAnimation&&t&&(this.currentAnimation=i,this.hideAllAnimations(),this.currentAnimation.gotoAndPlay(0),this.currentAnimation.visible=!0)}processOrders(){const{tileMap:e}=this.game,t=this.getGridXY({center:!0});switch(this.order.type){case"move":{this.collisionCount=0;const i=Math.pow(this.order.toPoint.gridX-t.gridX,2)+Math.pow(this.order.toPoint.gridY-t.gridY,2);if(i<Math.pow(this.collisionRadius/e.gridSize,2))return this.order={type:"stand"},!0;if(this.colliding&&i<Math.pow(3*this.collisionRadius/e.gridSize,2))return this.order={type:"stand"},!0;{if(this.colliding&&i<Math.pow(5*this.collisionRadius/e.gridSize,2)&&(0===this.collisionCount?this.collisionCount=1:this.collisionCount++,this.collisionCount>30))return this.order={type:"stand"},!0;const t=Math.pow(i,.5);if(!this._moveTo(this.order.toPoint,t))return this.order={type:"stand"},!0}return!0}case"follow":{if(this.order.to.isDead())return null!=this.order.nextOrder?this.order=this.order.nextOrder:this.order={type:"stand"},!0;const e=this.order.to.getGridXY({center:!0}),i=Math.pow(e.gridX-t.gridX,2)+Math.pow(e.gridY-t.gridY,2);if(i<Math.pow(this.followRadius,2));else{const e=this.order.to.getGridXY({center:!0});this._moveTo({type:this.order.to.type,...e},i)}return!0}case"patrol":{const i=Math.pow(this.order.toPoint.gridX-t.gridX,2)+Math.pow(this.order.toPoint.gridY-t.gridY,2);if(i<Math.pow(this.sightRadius/e.gridSize,2)){const e=this.order.toPoint;this.order.toPoint=this.order.fromPoint,this.order.fromPoint=e}else this._moveTo(this.order.toPoint,i);return!0}}return!1}handleUpdate(e){super.handleUpdate(e),this.processOrders(),this.elapsedSwitchFrames>=this.switchFrames?(this.updateAnimation(!0),this.elapsedSwitchFrames=0):this.updateAnimation(this.moveTurning||0===this.elapsedSwitchFrames),this.elapsedSwitchFrames+=1,this.zIndex=this.y+this.height}checkCollisionObjects(e,t){const{tileMap:i,speedAdjustmentFactor:s,speedAdjustmentWhileTurningFactor:r}=this.game,o=this.getGridXY({center:!0}),n=this.speed*s*(this.moveTurning?r:1),a=Math.min(n,t),h=-this.vector.direction/this.vector.directions*2*Math.PI,d=o.gridX-a*Math.sin(h),l=o.gridY-a*Math.cos(h),u=[],m=Math.max(0,Math.floor(d)-3),p=Math.min(i.mapGridWidth-1,Math.floor(d)+3),g=Math.max(0,Math.floor(l)-3),w=Math.min(i.mapGridHeight-1,Math.floor(l)+3);for(let t=m;t<=p;t++)for(let s=g;s<=w;s++)if(1===e[s][t]){const e=t+.5,r=s+.5,o=Math.pow(e-d,2)+Math.pow(r-l,2);o<Math.pow(this.collisionRadius/i.gridSize,2)?u.push({collisionType:c.hard,with:{type:"wall",x:e,y:r}}):o<Math.pow(1.1*this.collisionRadius/i.gridSize,2)&&u.push({collisionType:c.soft,with:{type:"wall",x:e,y:r}})}const{groundMoveableItems:f}=i;for(let e=f.length-1;e>=0;e--){const t=f[e],s=t.getGridXY({center:!0});if(t!==this&&Math.abs(s.gridX-o.gridX)<3&&Math.abs(s.gridY-o.gridY)<3){const e=Math.pow(s.gridX-d,2)+Math.pow(s.gridY-l,2);e<Math.pow((this.collisionRadius+t.collisionRadius)/i.gridSize,2)?u.push({collisionType:c.hard,with:{type:t.type,x:s.gridX,y:s.gridY}}):e<Math.pow((1.1*this.collisionRadius+t.collisionRadius)/i.gridSize,2)&&u.push({collisionType:c.soft,with:{type:t.type,x:s.gridX,y:s.gridY}})}}return u}_moveTo(e,t){const{tileMap:i,turnSpeedAdjustmentFactor:s,speedAdjustmentFactor:r,speedAdjustmentWhileTurningFactor:h}=this.game,d=this.getGridXY({center:!0}),l=Math.floor(e.gridX),u=Math.floor(e.gridY),m={gridX:Math.floor(d.gridX),gridY:Math.floor(d.gridY)},p={gridX:l,gridY:u},g=i.currentCopyMapPassableGrid;let w;e.type!==n.EItemType.buildings&&e.type!==n.EItemType.terrain||(g[u][l]=0);let f=[];if(m.gridY<0||m.gridY>=i.mapGridHeight||m.gridX<0||m.gridX>=i.mapGridWidth||m.gridX===p.gridX&&m.gridY===p.gridY)f=[{x:d.gridX,y:d.gridY},{x:e.gridX,y:e.gridY}],w=(0,o.findAngleGrid)({from:e,to:d,directions:this.vector.directions});else{if(f=a.AStar.calc({grid:g,start:m,end:p,f:"Euclidean"}),!(f.length>1))return!1;w=(0,o.findAngle)({from:{x:f[1].x+.5,y:f[1].y+.5},to:{x:d.gridX,y:d.gridY},directions:this.vector.directions})}const b=this.checkCollisionObjects(g,t);if(this.hardCollision=!1,b.length>0){this.colliding=!0;const e={x:0,y:0};b.push({collisionType:c.attraction,with:{x:f[1].x+.5,y:f[1].y+.5}});for(let t=b.length-1;t>=0;t--){const i=b[t],s=-(0,o.findAngle)({from:i.with,to:{x:d.gridX,y:d.gridY},directions:this.vector.directions})/this.vector.directions*2*Math.PI;let r;switch(i.collisionType){case c.hard:r=1.5+Math.random(),this.hardCollision=!0;break;case c.soft:r=.5+Math.random();break;case c.attraction:r=-.5}e.x+=r*Math.sin(s),e.y+=r*Math.cos(s)}w=(0,o.findAngle)({from:e,to:{x:0,y:0},directions:this.vector.directions})}else this.colliding=!1;const y=(0,o.angleDiff)({angle1:this.vector.direction,angle2:w,directions:this.vector.directions}),x=this.turnSpeed*s;Math.abs(y)>x*this.turnFactor?(this.vector.setDirection({direction:(0,o.wrapDirection)({direction:this.vector.direction+x*Math.abs(y)/y,directions:this.vector.directions})}),this.moveTurning=!0):(this.vector.setDirection({direction:w}),this.moveTurning=!1);const T=this.speed*r*(this.moveTurning?h:1);let v=Math.min(T,t);this.hardCollision&&(v=0);const C=-Math.round(this.vector.direction)/this.vector.directions*2*Math.PI,S=-v*Math.sin(C),M=-v*Math.cos(C),k=d.gridX+S,A=d.gridY+M;return this.setPositionByGridXY({gridX:k,gridY:A,center:!0}),!0}}t.Vehicle=u},66844:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-0.mp3"},56851:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-1.mp3"},88602:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-2.mp3"},62980:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-3.mp3"},32704:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-4.mp3"},29376:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet-hit-5.mp3"},18178:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet1.mp3"},33209:(e,t,i)=>{e.exports=i.p+"./assets/audio/bullet2.mp3"},31040:(e,t,i)=>{e.exports=i.p+"./assets/audio/cannon-hit.mp3"},17822:(e,t,i)=>{e.exports=i.p+"./assets/audio/cannon1.mp3"},9748:(e,t,i)=>{e.exports=i.p+"./assets/audio/cannon2.mp3"},71689:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-attack-0.mp3"},49180:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-attack-1.mp3"},44147:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-attack-2.mp3"},81998:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-0.mp3"},62657:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-1.mp3"},20888:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-2.mp3"},42792:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-3.mp3"},86947:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-4.mp3"},86231:(e,t,i)=>{e.exports=i.p+"./assets/audio/chopper-yes-5.mp3"},85286:(e,t,i)=>{e.exports=i.p+"./assets/audio/click.mp3"},92044:(e,t,i)=>{e.exports=i.p+"./assets/audio/engaging.mp3"},2254:(e,t,i)=>{e.exports=i.p+"./assets/audio/gun.mp3"},48356:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-error-0.mp3"},3886:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-0.mp3"},3631:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-1.mp3"},83668:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-2.mp3"},77542:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-3.mp3"},4259:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-4.mp3"},32558:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-5.mp3"},54909:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-6.mp3"},47724:(e,t,i)=>{e.exports=i.p+"./assets/audio/harvester-yes-7.mp3"},97574:(e,t,i)=>{e.exports=i.p+"./assets/audio/heatseeker1.mp3"},43987:(e,t,i)=>{e.exports=i.p+"./assets/audio/heatseeker2.mp3"},48523:(e,t,i)=>{e.exports=i.p+"./assets/audio/laser-hit-0.mp3"},22763:(e,t,i)=>{e.exports=i.p+"./assets/audio/laser1.mp3"},57976:(e,t,i)=>{e.exports=i.p+"./assets/audio/laser2.mp3"},155:(e,t,i)=>{e.exports=i.p+"./assets/audio/message-0.mp3"},24434:(e,t,i)=>{e.exports=i.p+"./assets/audio/message-1.mp3"},72634:(e,t,i)=>{e.exports=i.p+"./assets/audio/message-error-0.mp3"},55802:(e,t,i)=>{e.exports=i.p+"./assets/audio/rocket-hit-0.mp3"},39345:(e,t,i)=>{e.exports=i.p+"./assets/audio/roger1.mp3"},9275:(e,t,i)=>{e.exports=i.p+"./assets/audio/roger2.mp3"},53512:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-error-0.mp3"},44727:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-0.mp3"},95384:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-1.mp3"},89422:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-2.mp3"},24057:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-3.mp3"},1117:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-4.mp3"},48665:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-5.mp3"},73264:(e,t,i)=>{e.exports=i.p+"./assets/audio/scv-yes-6.mp3"},64844:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-attack-0.mp3"},55563:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-attack-1.mp3"},14389:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-attack-2.mp3"},13481:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-yes-0.mp3"},66349:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-yes-1.mp3"},13722:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-yes-2.mp3"},32923:(e,t,i)=>{e.exports=i.p+"./assets/audio/tank-yes-3.mp3"},96955:(e,t,i)=>{e.exports=i.p+"./assets/audio/vulture-attack-0.mp3"},40978:(e,t,i)=>{e.exports=i.p+"./assets/audio/vulture-yes-0.mp3"},36707:(e,t,i)=>{e.exports=i.p+"./assets/audio/vulture-yes-1.mp3"},35061:(e,t,i)=>{e.exports=i.p+"./assets/audio/vulture-yes-2.mp3"},75367:(e,t,i)=>{e.exports=i.p+"./assets/audio/vulture-yes-3.mp3"},45234:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-attack-0.mp3"},95644:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-attack-1.mp3"},25728:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-attack-2.mp3"},75410:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-attack-3.mp3"},29799:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-yes-0.mp3"},25670:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-yes-1.mp3"},56141:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-yes-2.mp3"},25236:(e,t,i)=>{e.exports=i.p+"./assets/audio/wraith-yes-3.mp3"},10651:(e,t,i)=>{e.exports=i.p+"./assets/audio/yup.mp3"}},i={};function s(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=t,e=[],s.O=(t,i,r,o)=>{if(!i){var n=1/0;for(l=0;l<e.length;l++){for(var[i,r,o]=e[l],a=!0,h=0;h<i.length;h++)(!1&o||n>=o)&&Object.keys(s.O).every((e=>s.O[e](i[h])))?i.splice(h--,1):(a=!1,o<n&&(n=o));if(a){e.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[i,r,o]},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var r,o,[n,a,h]=i,d=0;if(n.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(h)var l=h(s)}for(t&&t(i);d<n.length;d++)o=n[d],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(l)},i=self.webpackChunksimple_html5_rts_game=self.webpackChunksimple_html5_rts_game||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=s.O(void 0,[736],(()=>s(76752)));r=s.O(r)})();